"use strict";(self["webpackChunkvue_material_dashboard_2"]=self["webpackChunkvue_material_dashboard_2"]||[]).push([[237],{2237:function(e,t,a){a.r(t),a.d(t,{default:function(){return ie}});a(3725),a(1339);var l=a(641),i=a(9322),o=a(2644),n=a(9841),u=a(4335),s=a(2798);const d=e=>((0,l.Qi)("data-v-44a9f295"),e=e(),(0,l.jt)(),e),v={class:"hist-page"},r=d(()=>(0,l.Lk)("h2",{class:"hist-title"},"히스토리",-1)),c={key:0,class:"hist-no-auth"},_=d(()=>(0,l.Lk)("p",null,"접근 권한이 없습니다. (시스템 관리자 / 기관 관리자 전용)",-1)),p=[_],m={key:1},k={class:"hist-toolbar"},h={class:"hist-filters-row"},g=d(()=>(0,l.Lk)("option",{value:"all"},"전체",-1)),b=d(()=>(0,l.Lk)("option",{value:"revision_date"},"수정일시",-1)),L=d(()=>(0,l.Lk)("option",{value:"modifier_name"},"수정자",-1)),f=[g,b,L],y=["onKeyup"],C={class:"hist-filters-row"},B=d(()=>(0,l.Lk)("option",{value:"latest"},"최신순",-1)),A=d(()=>(0,l.Lk)("option",{value:"oldest"},"오래된순",-1)),E=[B,A],K=(0,l.Fv)('<option value="" data-v-44a9f295>전체</option><option value="BD1" data-v-44a9f295>조사지</option><option value="BD2" data-v-44a9f295>상담</option><option value="BD3" data-v-44a9f295>지원계획</option><option value="BD4" data-v-44a9f295>지원결과</option><option value="BD5" data-v-44a9f295>이벤트 계획</option><option value="BD6" data-v-44a9f295>이벤트 결과</option><option value="BD7" data-v-44a9f295>후원 계획</option><option value="BD8" data-v-44a9f295>후원 결과</option>',9),D=[K],X=d(()=>(0,l.Lk)("option",{value:""},"기관 전체",-1)),R=["value"],w=d(()=>(0,l.Lk)("option",{value:""},"담당자 전체",-1)),I=["value"],Q={class:"hist-table-wrap"},V={class:"hist-table"},j=d(()=>(0,l.Lk)("th",null,"기록코드",-1)),U=d(()=>(0,l.Lk)("th",null,"수정일시",-1)),$=d(()=>(0,l.Lk)("th",null,"유형",-1)),F={key:0},W=d(()=>(0,l.Lk)("th",null,"수정자",-1)),S=d(()=>(0,l.Lk)("th",null,"수정자 권한",-1)),z=d(()=>(0,l.Lk)("th",null,"변경 항목",-1)),J=d(()=>(0,l.Lk)("th",null,"변경 전",-1)),O=d(()=>(0,l.Lk)("th",null,"변경 후",-1)),H={key:0},M=["colspan"],N={key:0},T={class:"hist-before"},q={class:"hist-after"},x={key:1},G=["colspan"],P={key:0,class:"hist-pagination"},Y=["disabled"],Z={class:"hist-page-info"},ee=["disabled"];var te={__name:"HistoryList",setup(e){const t=(0,s.n)(),a=(0,l.EW)(()=>"AA4"===t.role),d=(0,l.EW)(()=>"AA3"===t.role),_=(0,n.KR)("all"),g=(0,n.KR)(""),b=(0,n.KR)("latest"),L=(0,n.KR)(""),B=(0,n.KR)(""),A=(0,n.KR)(""),K=(0,n.KR)([]),te=(0,n.KR)(1),ae=(0,n.KR)(20),le=(0,n.KR)(0),ie=(0,n.KR)(!1),oe=(0,n.KR)([]),ne=(0,n.KR)([]),ue=(0,l.EW)(()=>0===le.value?1:Math.ceil(le.value/ae.value)),se={BD1:"조사지",BD2:"상담",BD3:"지원계획",BD4:"지원결과",BD5:"이벤트 계획",BD6:"이벤트 결과",BD7:"후원 계획",BD8:"후원 결과"},de=e=>se[e]||"-",ve={AA1:"일반 사용자",AA2:"기관 담당자",AA3:"기관 관리자",AA4:"시스템 관리자"},re={BB1:"긴급",BB2:"중점",BB3:"준비"},ce=e=>ve[e]||"-",_e=e=>{if(!e)return"";const t=e.change_item||"",a=t.split(/[.[[]/)[0],l={status:"상태",answers:"조사지 답변",name:"이름",role:"권한 구분",is_active:"가입 상태",org_code:"소속 기관",main_title:"제목",main_content:"내용",main_counsel_date:"일자",plan_from:"예상 지원 시작일",plan_to:"예상 지원 종료일",goal_p:"계획 목표",publicContent_p:"이용자 내용",privateContent_p:"기관 내용",actual_from:"실제 지원 시작일",actual_to:"실제 지원 종료일",goal:"계획했던 목표",publicContent:"일반용 내용",privateContent:"기관용 내용",priority:"우선순위",detail_title:"추가 제목",detail1_title:"추가-1 제목",detail2_title:"추가-2 제목",detail3_title:"추가-3 제목",detail4_title:"추가-4 제목",detail5_title:"추가-5 제목",detail6_title:"추가-6 제목",detail7_title:"추가-7 제목",detail8_title:"추가-8 제목",detail9_title:"추가-9 제목",detail10_title:"추가-10 제목",detail_content:"추가 내용",detail1_content:"추가-1 내용",detail2_content:"추가-2 내용",detail3_content:"추가-3 내용",detail4_content:"추가-4 내용",detail5_content:"추가-5 내용",detail6_content:"추가-6 내용",detail7_content:"추가-7 내용",detail8_content:"추가-8 내용",detail9_content:"추가-9 내용",detail10_content:"추가-10 내용",detail_date:"추가 일자",detail1_date:"추가-1 일자",detail2_date:"추가-2 일자",detail3_date:"추가-3 일자",detail4_date:"추가-4 일자",detail5_date:"추가-5 일자",detail6_date:"추가-6 일자",detail7_date:"추가-7 일자",detail8_date:"추가-8 일자",detail9_date:"추가-9 일자",detail10_date:"추가-10 일자",item_private:"추가 관리자 내용",item1_private:"추가-1 관리자 내용",item2_private:"추가-2 관리자 내용",item3_private:"추가-3 관리자 내용",item4_private:"추가-4 관리자 내용",item5_private:"추가-5 관리자 내용",item6_private:"추가-6 관리자 내용",item7_private:"추가-7 관리자 내용",item8_private:"추가-8 관리자 내용",item9_private:"추가-9 관리자 내용",item10_private:"추가-10 관리자 내용",item_public:"추가 이용자 내용",item1_public:"추가-1 이용자 내용",item2_public:"추가-2 이용자 내용",item3_public:"추가-3 이용자 내용",item4_public:"추가-4 이용자 내용",item5_public:"추가-5 이용자 내용",item6_public:"추가-6 이용자 내용",item7_public:"추가-7 이용자 내용",item8_public:"추가-8 이용자 내용",item9_public:"추가-9 이용자 내용",item10_public:"추가-10 이용자 내용",item_goal:"추가 목표",item1_goal:"추가-1 목표",item2_goal:"추가-2 목표",item3_goal:"추가-3 목표",item4_goal:"추가-4 목표",item5_goal:"추가-5 목표",item6_goal:"추가-6 목표",item7_goal:"추가-7 목표",item8_goal:"추가-8 목표",item9_goal:"추가-9 목표",item10_goal:"추가-10 목표"};return l[a]?l[a]:t},pe=e=>{if(null==e||""===e)return"";const t=String(e).trim();if(t.startsWith("{")&&t.endsWith("}"))try{const e=JSON.parse(t);if("object"!==typeof e||Array.isArray(e)||null===e)return re[t]||t;const a=Object.entries(e).map(([e,t])=>{if(Array.isArray(t)){const a=t.map(e=>"string"===typeof e&&re[e]?re[e]:e);return`${e}: ${a.join(", ")}`}return"string"===typeof t&&re[t]?`${e}: ${re[t]}`:`${e}: ${t}`});return a.join(", ")}catch(a){return re[t]||t}return re[t]||t},me=e=>e?String(e).replace("T"," ").substring(0,19):"",ke=()=>{te.value=1,ge()},he=e=>{e<1||e>ue.value||(te.value=e,ge())},ge=async()=>{if(a.value||d.value){ie.value=!0;try{const e={page:te.value,size:ae.value,searchField:_.value,keyword:g.value,orderBy:b.value,typeCode:L.value,loginId:t.userId,role:t.role};a.value&&B.value&&(e.orgCode=B.value),d.value&&A.value&&(e.managerCode=A.value);const l=await u.A.get("/api/histories",{params:e});K.value=l.data?.data?.list??[],le.value=l.data?.data?.totalCount??0}catch(e){console.error(e),alert("이력 목록 조회 중 오류가 발생했습니다.")}finally{ie.value=!1}}},be=async()=>{if(a.value)try{const e=await u.A.get("/api/organization/simple");oe.value=e.data?.data??[]}catch(e){console.error(e)}},Le=async()=>{if(d.value)try{const e=await u.A.get("/api/managers/simple",{params:{loginId:t.userId}}),a=e.data?.data??[];ne.value=a.map(e=>({user_code:e.user_code??e.manager_code,name:e.name??e.manager_name}))}catch(e){console.error(e)}};return(0,l.sV)(async()=>{a.value&&await be(),d.value&&await Le(),ge()}),(e,t)=>((0,l.uX)(),(0,l.CE)("div",v,[r,a.value||d.value?((0,l.uX)(),(0,l.CE)("div",m,[(0,l.Lk)("div",k,[(0,l.Lk)("div",h,[(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>_.value=e),class:"hist-select",onChange:ke},f,544),[[i.u1,_.value]]),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>g.value=e),class:"hist-input",placeholder:"검색어 입력",onKeyup:(0,i.jR)(ge,["enter"])},null,40,y),[[i.Jo,g.value,void 0,{trim:!0}]]),(0,l.Lk)("button",{class:"hist-btn hist-btn-primary",onClick:ge}," 검색 ")]),(0,l.Lk)("div",C,[(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>b.value=e),class:"hist-select",onChange:ke},E,544),[[i.u1,b.value]]),(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>L.value=e),class:"hist-select",onChange:ke},D,544),[[i.u1,L.value]]),a.value?(0,l.bo)(((0,l.uX)(),(0,l.CE)("select",{key:0,"onUpdate:modelValue":t[4]||(t[4]=e=>B.value=e),class:"hist-select",onChange:ke},[X,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(oe.value,e=>((0,l.uX)(),(0,l.CE)("option",{key:e.org_code,value:e.org_code},(0,o.v_)(e.org_name),9,R))),128))],544)),[[i.u1,B.value]]):d.value?(0,l.bo)(((0,l.uX)(),(0,l.CE)("select",{key:1,"onUpdate:modelValue":t[5]||(t[5]=e=>A.value=e),class:"hist-select",onChange:ke},[w,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(ne.value,e=>((0,l.uX)(),(0,l.CE)("option",{key:e.user_code,value:e.user_code},(0,o.v_)(e.name),9,I))),128))],544)),[[i.u1,A.value]]):(0,l.Q3)("",!0)])]),(0,l.Lk)("div",Q,[(0,l.Lk)("table",V,[(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[j,U,$,a.value?((0,l.uX)(),(0,l.CE)("th",F,"기관")):(0,l.Q3)("",!0),W,S,z,J,O])]),(0,l.Lk)("tbody",null,[ie.value||0!==K.value.length?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("tr",H,[(0,l.Lk)("td",{colspan:a.value?9:8,class:"hist-empty"}," 조회된 이력이 없습니다. ",8,M)])),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(K.value,e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.record_code},[(0,l.Lk)("td",null,(0,o.v_)(e.record_code),1),(0,l.Lk)("td",null,(0,o.v_)(me(e.revision_date)),1),(0,l.Lk)("td",null,(0,o.v_)(de(e.type_code)),1),a.value?((0,l.uX)(),(0,l.CE)("td",N,(0,o.v_)(e.org_name||"-"),1)):(0,l.Q3)("",!0),(0,l.Lk)("td",null,(0,o.v_)(e.modifier_name),1),(0,l.Lk)("td",null,(0,o.v_)(ce(e.modifier_role)),1),(0,l.Lk)("td",null,(0,o.v_)(_e(e)),1),(0,l.Lk)("td",T,(0,o.v_)(pe(e.before_change)),1),(0,l.Lk)("td",q,(0,o.v_)(pe(e.after_change)),1)]))),128)),ie.value?((0,l.uX)(),(0,l.CE)("tr",x,[(0,l.Lk)("td",{colspan:a.value?9:8,class:"hist-loading"}," 로딩 중... ",8,G)])):(0,l.Q3)("",!0)])])]),ue.value>1?((0,l.uX)(),(0,l.CE)("div",P,[(0,l.Lk)("button",{class:"hist-btn",disabled:1===te.value||ie.value,onClick:t[6]||(t[6]=e=>he(te.value-1))}," 이전 ",8,Y),(0,l.Lk)("span",Z,(0,o.v_)(te.value)+" / "+(0,o.v_)(ue.value),1),(0,l.Lk)("button",{class:"hist-btn",disabled:te.value===ue.value||ie.value,onClick:t[7]||(t[7]=e=>he(te.value+1))}," 다음 ",8,ee)])):(0,l.Q3)("",!0)])):((0,l.uX)(),(0,l.CE)("div",c,p))]))}},ae=a(6262);const le=(0,ae.A)(te,[["__scopeId","data-v-44a9f295"]]);var ie=le}}]);
//# sourceMappingURL=237.c74a1457.js.map