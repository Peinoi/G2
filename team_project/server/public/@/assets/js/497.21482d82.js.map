{"version":3,"file":"@/assets/js/497.21482d82.js","mappings":"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","sources":["webpack://vue-material-dashboard-2/./src/views/EventResultInfo.vue","webpack://vue-material-dashboard-2/./src/views/EventResultInfo.vue?3253"],"sourcesContent":["<template>\r\n  <section class=\"p-6 max-w-5xl mx-auto space-y-6\">\r\n    <!-- 상단 액션라인 -->\r\n    <div class=\"form-action\">\r\n      <MaterialButton color=\"dark\" size=\"sm\" variant=\"outlined\" @click=\"goBack\">\r\n        ← 목록으로\r\n      </MaterialButton>\r\n    </div>\r\n\r\n    <!-- 결과보고서 상세 카드 -->\r\n    <div v-if=\"result\" class=\"detail-card\">\r\n      <header class=\"flex justify-between items-center detail-header\">\r\n        <h2 class=\"text-2xl font-semibold\">결과보고서 상세</h2>\r\n        <span class=\"status-pill\" :class=\"statusClass(result.result_status)\">\r\n          {{ result.result_status_name }}\r\n        </span>\r\n      </header>\r\n\r\n      <!-- 기본 정보 -->\r\n      <div class=\"meta-card improved-meta\">\r\n        <div class=\"info-grid\">\r\n          <div class=\"info-label\">제목</div>\r\n          <div class=\"info-value\">{{ result.result_subject }}</div>\r\n\r\n          <div class=\"info-label\">작성일</div>\r\n          <div class=\"info-value\">\r\n            {{ formatDate(result.report_register_date) }}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 내용 -->\r\n      <div class=\"content-block\">\r\n        <div class=\"content-title\">내용</div>\r\n        <div class=\"content-box whitespace-pre-line\">\r\n          {{ result.result_content }}\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 참석자 목록 -->\r\n      <div class=\"detail-card\" v-if=\"attendanceList && attendanceList.length\">\r\n        <h3 class=\"text-xl font-semibold mb-4\">참석자 목록</h3>\r\n        <table class=\"attendance-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>신청코드</th>\r\n              <th>자녀명</th>\r\n              <th>보호자명</th>\r\n              <th>참석여부</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"row in pagedAttendance\" :key=\"row.apply_code\">\r\n              <td>{{ row.apply_code }}</td>\r\n              <td>{{ row.child_name }}</td>\r\n              <td>{{ row.applicant_name }}</td>\r\n              <td>\r\n                <span v-if=\"row.apply_status_name === '승인'\">참석</span>\r\n                <span v-else>불참석</span>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n\r\n        <!-- 페이지네이션 -->\r\n        <div class=\"pagination\" v-if=\"totalPages > 1\">\r\n          <button class=\"page-btn\" :disabled=\"page === 1\" @click=\"page--\">\r\n            이전\r\n          </button>\r\n          <span class=\"page-info\"> {{ page }} / {{ totalPages }} </span>\r\n          <button\r\n            class=\"page-btn\"\r\n            :disabled=\"page === totalPages\"\r\n            @click=\"page++\"\r\n          >\r\n            다음\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 첨부파일 -->\r\n      <div class=\"content-block\">\r\n        <div class=\"content-title\">첨부파일</div>\r\n        <div v-if=\"result.attachments?.length\">\r\n          <ul class=\"file-list\">\r\n            <li v-for=\"file in result.attachments\" :key=\"file.server_filename\">\r\n              <span class=\"file-name\" @click=\"previewFile(file)\">\r\n                {{ file.original_filename }}\r\n              </span>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n        <div v-else class=\"text-xs text-gray-400\">첨부된 파일이 없습니다.</div>\r\n\r\n        <!-- 이미지 미리보기 -->\r\n        <div v-if=\"previewImage\" class=\"preview-modal\" @click=\"closePreview\">\r\n          <img :src=\"previewImage\" class=\"preview-img\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 관리자 전용 승인/반려 -->\r\n    <div class=\"pt-4 border-t mt-2 space-y-3\" v-if=\"isAdmin\">\r\n      <div class=\"approve-actions\">\r\n        <MaterialButton\r\n          color=\"dark\"\r\n          size=\"sm\"\r\n          class=\"px-4\"\r\n          @click=\"handleApprove\"\r\n        >\r\n          승인\r\n        </MaterialButton>\r\n        <MaterialButton\r\n          color=\"dark\"\r\n          size=\"sm\"\r\n          class=\"px-4\"\r\n          @click=\"handleReject\"\r\n        >\r\n          반려\r\n        </MaterialButton>\r\n      </div>\r\n    </div>\r\n  </section>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, computed } from \"vue\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nimport axios from \"axios\";\r\nimport MaterialButton from \"@/components/MaterialButton.vue\";\r\n\r\nconst route = useRoute();\r\nconst router = useRouter();\r\n\r\nconst result = ref(null);\r\nconst resultCode = Number(route.params.resultCode || 0);\r\n\r\n// 로그인 권한\r\nconst getLoginRole = () => {\r\n  const userStr = localStorage.getItem(\"user\");\r\n  if (!userStr) return null;\r\n  try {\r\n    return JSON.parse(userStr).role || null;\r\n  } catch {\r\n    return null;\r\n  }\r\n};\r\nconst loginRole = ref(getLoginRole());\r\n\r\n// 미리보기 이미지\r\nconst previewImage = ref(\"\");\r\nconst previewFile = (file) => {\r\n  const ext = file.original_filename.split(\".\").pop().toLowerCase();\r\n  if ([\"jpg\", \"jpeg\", \"png\", \"gif\", \"webp\"].includes(ext))\r\n    previewImage.value = file.file_path;\r\n  else if (ext === \"pdf\") window.open(file.file_path, \"_blank\");\r\n  else window.location.href = file.file_path;\r\n};\r\nconst closePreview = () => (previewImage.value = \"\");\r\n\r\n// 상태 Pill 클래스\r\nconst statusClass = (status) => {\r\n  switch (status) {\r\n    case \"BA1\":\r\n      return \"status-pill--before\";\r\n    case \"BA2\":\r\n      return \"status-pill--done\";\r\n    case \"BA3\":\r\n      return \"status-pill--rejected\";\r\n    default:\r\n      return \"\";\r\n  }\r\n};\r\n\r\n// 승인/반려\r\nconst handleApprove = async () => {\r\n  try {\r\n    const res = await axios.post(`/api/event/result/${resultCode}/approve`);\r\n    if (res.data.success) {\r\n      alert(\"승인되었습니다.\");\r\n      await fetchResult();\r\n    } else alert(res.data.message || \"승인 실패\");\r\n  } catch (err) {\r\n    console.error(err);\r\n    alert(\"서버 오류: \" + (err.message || \"\"));\r\n  }\r\n};\r\nconst handleReject = async () => {\r\n  const reason = prompt(\"반려 사유를 입력해주세요:\");\r\n  if (!reason) return;\r\n  try {\r\n    const res = await axios.post(`/api/event/result/${resultCode}/reject`, {\r\n      reason,\r\n    });\r\n    if (res.data.success) {\r\n      alert(\"반려 처리되었습니다.\");\r\n      await fetchResult();\r\n    } else alert(res.data.message || \"반려 실패\");\r\n  } catch (err) {\r\n    console.error(err);\r\n    alert(\"서버 오류: \" + (err.message || \"\"));\r\n  }\r\n};\r\n\r\n// 데이터 호출\r\nconst fetchResult = async () => {\r\n  try {\r\n    const res = await axios.get(`/api/event/result/${resultCode}`);\r\n    if (res.data?.status === \"success\") result.value = res.data.data;\r\n    else alert(\"결과보고서 조회 실패\");\r\n  } catch (err) {\r\n    console.error(\"fetchResult error:\", err);\r\n    alert(\"서버 오류 발생\");\r\n  }\r\n};\r\n\r\n// 참석자\r\nconst attendanceList = ref([]);\r\nconst page = ref(1);\r\nconst pageSize = 10;\r\nconst pagedAttendance = computed(() => {\r\n  const start = (page.value - 1) * pageSize;\r\n  return attendanceList.value.slice(start, start + pageSize);\r\n});\r\nconst totalPages = computed(() =>\r\n  Math.ceil(attendanceList.value.length / pageSize)\r\n);\r\nconst fetchAttendance = async () => {\r\n  if (!result.value?.event_code) return;\r\n  try {\r\n    const res = await axios.get(\r\n      `/api/event/myAttendanceList/${result.value.event_code}`\r\n    );\r\n    attendanceList.value = res.data.data || [];\r\n    page.value = 1;\r\n  } catch (err) {\r\n    console.error(\"fetchAttendance error:\", err);\r\n    alert(\"서버 오류 발생\");\r\n  }\r\n};\r\n\r\nconst formatDate = (d) => (d ? new Date(d).toISOString().slice(0, 10) : \"\");\r\nconst isAdmin = computed(\r\n  () => loginRole.value === \"AA3\" && result.value?.result_status !== \"BA2\"\r\n);\r\nconst goBack = () => router.back();\r\n\r\nonMounted(async () => {\r\n  await fetchResult();\r\n  await fetchAttendance();\r\n});\r\n</script>\r\n\r\n<style scoped>\r\nsection {\r\n  color: #111827;\r\n  max-width: 1600px;\r\n  margin: 0 auto;\r\n  padding: 1.5rem 1rem;\r\n}\r\n\r\n.form-action {\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  gap: 0.75rem;\r\n  margin-bottom: 1rem;\r\n  padding-bottom: 0.5rem;\r\n}\r\n\r\n.detail-card {\r\n  background: #fff;\r\n  border-radius: 1rem;\r\n  border: 1px solid #e5e7eb;\r\n  padding: 2rem;\r\n  box-shadow: 0 10px 25px rgba(15, 23, 42, 0.05);\r\n}\r\n.detail-header {\r\n  padding-bottom: 0.75rem;\r\n  margin-bottom: 1.25rem;\r\n  border-bottom: 1px solid #e5e7eb;\r\n}\r\n\r\n.meta-card {\r\n  background: #fff;\r\n  border-radius: 1rem;\r\n  border: 1px solid #e5e7eb;\r\n  padding: 1.75rem;\r\n  box-shadow: 0 8px 20px rgba(15, 23, 42, 0.05);\r\n  margin-bottom: 1.5rem;\r\n}\r\n.improved-meta .info-grid {\r\n  display: grid;\r\n  grid-template-columns: 160px 1fr;\r\n  border: 1px solid #e5e7eb;\r\n  border-radius: 0.8rem;\r\n  overflow: hidden;\r\n}\r\n.info-label {\r\n  background: #f9fafb;\r\n  padding: 0.85rem 1rem;\r\n  font-size: 0.9rem;\r\n  font-weight: 600;\r\n  color: #4b5563;\r\n  border-bottom: 1px solid #e5e7eb;\r\n  border-right: 1px solid #e5e7eb;\r\n}\r\n.info-value {\r\n  padding: 0.85rem 1rem;\r\n  font-size: 0.9rem;\r\n  color: #111827;\r\n  border-bottom: 1px solid #e5e7eb;\r\n}\r\n.info-label:nth-last-child(2),\r\n.info-value:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.content-block {\r\n  margin-top: 1.5rem;\r\n  margin-bottom: 1.5rem;\r\n}\r\n.content-title {\r\n  font-size: 0.95rem;\r\n  font-weight: 600;\r\n  margin-bottom: 0.4rem;\r\n  color: #6b7280;\r\n}\r\n.content-box {\r\n  background: #f9fafb;\r\n  border: 1px solid #e5e7eb;\r\n  border-radius: 0.7rem;\r\n  padding: 1rem;\r\n  min-height: 120px;\r\n  max-height: 350px;\r\n  overflow-y: auto;\r\n  line-height: 1.45;\r\n}\r\n\r\n.status-pill {\r\n  display: inline-flex;\r\n  align-items: center;\r\n  gap: 0.25rem;\r\n  padding: 0.25rem 0.7rem;\r\n  border-radius: 999px;\r\n  font-size: 0.75rem;\r\n  border: 1px solid transparent;\r\n}\r\n.status-pill--before {\r\n  background: #f3f4f6;\r\n  color: #4b5563;\r\n  border-color: #e5e7eb;\r\n}\r\n.status-pill--done {\r\n  background: #111827;\r\n  color: #f9fafb;\r\n  border-color: #111827;\r\n}\r\n.status-pill--rejected {\r\n  background: #fef2f2;\r\n  color: #b91c1c;\r\n  border-color: #fecaca;\r\n}\r\n\r\n.attendance-table {\r\n  width: 100%;\r\n  border-collapse: collapse;\r\n  margin-top: 0.75rem;\r\n  font-size: 0.875rem;\r\n}\r\n.attendance-table th,\r\n.attendance-table td {\r\n  border: 1px solid #e5e7eb;\r\n  padding: 0.6rem 0.75rem;\r\n  text-align: left;\r\n}\r\n.attendance-table th {\r\n  background: #f9fafb;\r\n  color: #374151;\r\n  font-weight: 600;\r\n}\r\n.attendance-table tbody tr:nth-child(even) {\r\n  background: #f9fafb;\r\n}\r\n.attendance-table tbody tr:hover {\r\n  background: #f3f4f6;\r\n}\r\n\r\n.pagination {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  gap: 0.75rem;\r\n  margin-top: 1rem;\r\n}\r\n.page-btn {\r\n  padding: 0.35rem 0.8rem;\r\n  border: 1px solid #d1d5db;\r\n  background: #fff;\r\n  border-radius: 0.5rem;\r\n  font-size: 0.85rem;\r\n  font-weight: 500;\r\n  cursor: pointer;\r\n  transition: all 0.2s;\r\n}\r\n.page-btn:hover:not(:disabled) {\r\n  background: #f3f4f6;\r\n}\r\n.page-btn:disabled {\r\n  opacity: 0.4;\r\n  cursor: not-allowed;\r\n}\r\n.page-info {\r\n  font-size: 0.875rem;\r\n  color: #374151;\r\n  font-weight: 500;\r\n}\r\n\r\n.file-list {\r\n  margin-top: 0.5rem;\r\n  color: #374151;\r\n  font-size: 0.875rem;\r\n  list-style: none;\r\n  padding: 0;\r\n}\r\n.file-list li + li {\r\n  margin-top: 0.25rem;\r\n}\r\n.file-list a,\r\n.file-name {\r\n  color: #2563eb;\r\n  text-decoration: underline;\r\n  cursor: pointer;\r\n}\r\n.file-list a:hover,\r\n.file-name:hover {\r\n  color: #1d4ed8;\r\n}\r\n\r\n.approve-actions {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  gap: 1rem;\r\n  margin-top: 0.4rem;\r\n  width: 100%;\r\n}\r\n\r\n.preview-modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: rgba(0, 0, 0, 0.6);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n}\r\n.preview-img {\r\n  max-width: 90%;\r\n  max-height: 90%;\r\n}\r\n</style>\r\n","import script from \"./EventResultInfo.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./EventResultInfo.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./EventResultInfo.vue?vue&type=style&index=0&id=59d0765b&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-59d0765b\"]])\n\nexport default __exports__"],"names":["pageSize","route","useRoute","router","useRouter","result","ref","resultCode","Number","params","getLoginRole","userStr","localStorage","getItem","JSON","parse","role","loginRole","previewImage","previewFile","file","ext","original_filename","split","pop","toLowerCase","includes","value","file_path","window","open","location","href","closePreview","statusClass","status","handleApprove","async","res","axios","post","data","success","alert","fetchResult","message","err","console","error","handleReject","reason","prompt","get","attendanceList","page","pagedAttendance","computed","start","slice","totalPages","Math","ceil","length","fetchAttendance","event_code","formatDate","d","Date","toISOString","isAdmin","result_status","goBack","back","onMounted","__exports__"],"sourceRoot":""}