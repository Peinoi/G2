"use strict";(self["webpackChunkvue_material_dashboard_2"]=self["webpackChunkvue_material_dashboard_2"]||[]).push([[826],{6571:function(e,t,a){a.d(t,{A:function(){return d}});var s=a(641),l=a(2644);const i=["id","rows","name","value","placeholder","isRequired","disabled"];function u(e,t,a,u,o,r){return(0,s.uX)(),(0,s.CE)("div",{class:(0,l.C4)(["input-group",`input-group-${a.variant} ${r.getStatus(a.error,a.success)}`])},[(0,s.Lk)("textarea",{id:a.id,class:"form-control",rows:a.rows,name:a.name,value:a.value,placeholder:a.placeholder,isRequired:a.isRequired,disabled:a.disabled},null,8,i)],2)}var o=a(5685),r={name:"MaterialTextarea",props:{variant:{type:String,default:"outline"},id:{type:String,required:!0},name:{type:String,default:""},value:{type:String,default:""},placeholder:{type:String,default:"Your text here..."},isRequired:Boolean,disabled:{type:Boolean,default:!1},rows:{type:Number,default:5},success:{type:Boolean,default:!1},error:{type:Boolean,default:!1}},mounted(){(0,o.A)()},methods:{getStatus:(e,t)=>{let a;return a=t?"is-valid":e?"is-invalid":null,a}}},n=a(6262);const c=(0,n.A)(r,[["render",u]]);var d=c},9826:function(e,t,a){a.r(t),a.d(t,{default:function(){return ie}});a(8743);var s=a(641),l=a(9322),i=a(2644),u=a(9841),o=a(4335),r=a(5220),n=a(6698),c=a(2351),d=a(6571);const v=e=>((0,s.Qi)("data-v-035c00ce"),e=e(),(0,s.jt)(),e),p={class:"p-6 max-w-5xl mx-auto"},m={class:"mb-3 flex items-center justify-between header-row"},y=v(()=>(0,s.Lk)("h2",{class:"text-2xl font-semibold"},"조사지 작성",-1)),_={class:"space-x-2"},k={class:"writer-card"},b=v(()=>(0,s.Lk)("h3",{class:"writer-title"},"지원자 정보",-1)),f=v(()=>(0,s.Lk)("p",{class:"writer-desc"},"지원을 신청하는 지원자를 선택해주세요.",-1)),E={class:"space-y-3"},L={class:"writer-row"},h={class:"writer-left"},C=v(()=>(0,s.Lk)("span",null," 지원자 본인 입니다.",-1)),g={class:"writer-right"},x=["disabled"],X={class:"writer-row"},w={class:"writer-left"},A=v(()=>(0,s.Lk)("span",null," 대리인 입니다.",-1)),q={class:"writer-right"},S=["disabled"],F=v(()=>(0,s.Lk)("option",{value:""},"지원자를 선택하세요",-1)),K=["value"],I={key:0,class:"text-gray-500 mt-4"},R={key:1,class:"space-y-6 mt-4"},T={class:"section-header"},V={class:"section-title"},U={key:0,class:"section-desc"},$={class:"sub-header"},O={class:"font-medium text-sm text-gray-800 question-title"},B={key:0,class:"text-xs text-gray-500 mt-0.5"},D={class:"space-y-4 mt-2"},N={class:"flex items-center justify-between mb-2"},G={class:"question-title"},Q={key:0,class:"text-red-500 text-xs ml-1"},W={key:0},j={key:1},z=["for"],H={key:2,class:"space-y-1"},J=v(()=>(0,s.Lk)("div",{class:"helper-text"},"보기 중 하나를 선택하세요",-1)),Y=["name","value","onUpdate:modelValue"],M={key:3,class:"space-y-1"},P=v(()=>(0,s.Lk)("div",{class:"helper-text"},"해당되는 항목을 모두 선택하세요",-1)),Z=["value","checked","onChange"],ee={key:4,class:"text-xs text-gray-400 italic"},te={class:"form-actions"};var ae={__name:"SurveyWrite",setup(e){const t=(0,r.rd)(),a=(0,u.KR)(null),v=(0,u.KR)({}),ae=(0,u.KR)("SELF"),se=(0,u.KR)(""),le=(0,u.KR)([]),ie=(0,u.KR)("");function ue(e,t){const a=v.value[e];return!!Array.isArray(a)&&a.includes(t)}function oe(e,t,a){const s=Array.isArray(v.value[e])?[...v.value[e]]:[];if(a)s.includes(t)||s.push(t);else{const e=s.indexOf(t);-1!==e&&s.splice(e,1)}v.value[e]=s}async function re(){try{if("SELF"===ae.value&&(!ie.value||""===ie.value.trim()))return void alert("장애 유형을 입력해주세요.");for(const t of a.value.sections)for(const e of t.subsections)for(const t of e.items)if("Y"===t.is_required){const e=v.value[t.item_code];if(("TEXT"===t.question_type||"TEXTAREA"===t.question_type)&&(!e||""===e.trim()))return void alert(`필수 질문을 입력해주세요:\n"${t.question_text}"`);if("RADIO"===t.question_type&&(!e||""===e))return void alert(`필수 질문을 선택해주세요:\n"${t.question_text}"`);if("CHECKBOX"===t.question_type&&(!Array.isArray(e)||0===e.length))return void alert(`필수 체크박스 항목을 선택해주세요:\n"${t.question_text}"`)}if("DELEGATE"===ae.value&&!se.value)return void alert("대상자를 선택해주세요.");const e=localStorage.getItem("user");let s=null;if(e){const t=JSON.parse(e);s=t.user_code??t.userCode??t.id??null}if(!s)return void alert("로그인 정보를 찾을 수 없습니다. (user_code 없음)");"SELF"===ae.value&&ie.value&&await o.A.put("/api/survey/disability-type",{user_code:Number(s),disability_type:ie.value});const l={template_ver_code:a.value.template_ver_code,answers:v.value,written_by:Number(s),writer_type:ae.value,target_person_code:"DELEGATE"===ae.value?se.value:null},i=await o.A.post("/api/survey/submit",l);!1!==i.data?.success?(alert("응답이 저장되었습니다!"),t.push("/survey-list")):alert("저장 실패: "+(i.data?.message||"알 수 없는 오류"))}catch(e){alert("저장 실패: "+(e.response?.data?.message||e.message))}}function ne(){t.push("/survey-list")}return(0,s.sV)(async()=>{try{const{data:e}=await o.A.get("/api/survey/latest"),t=e?.result??e;a.value=t;const s={};for(const a of t?.sections??[])for(const e of a.subsections??[])for(const t of e.items??[]){const e=String(t.question_type).toUpperCase();s[t.item_code]="CHECKBOX"===e?[]:""}v.value=s;const l=localStorage.getItem("user");if(l){const e=JSON.parse(l),t=e.user_code??null;if(t){const{data:e}=await o.A.get("/api/survey/children",{params:{userId:t}});le.value=e.result??[];const{data:a}=await o.A.get("/api/survey/disability-type",{params:{user_code:t}});ie.value=a.result?.disability_type??""}}}catch(e){alert("조사지 불러오기 실패: "+(e.response?.data?.message||e.message))}}),(e,t)=>((0,s.uX)(),(0,s.CE)("section",p,[(0,s.Lk)("header",m,[y,(0,s.Lk)("div",_,[(0,s.bF)(n.A,{color:"dark",size:"sm",variant:"outlined",onClick:ne},{default:(0,s.k6)(()=>[(0,s.eW)(" ← 목록 ")]),_:1})])]),(0,s.Lk)("div",k,[b,f,(0,s.Lk)("div",E,[(0,s.Lk)("label",L,[(0,s.Lk)("span",h,[(0,s.bo)((0,s.Lk)("input",{type:"radio",value:"SELF","onUpdate:modelValue":t[0]||(t[0]=e=>ae.value=e),class:"writer-radio"},null,512),[[l.XL,ae.value]]),C]),(0,s.Lk)("span",g,[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>ie.value=e),class:"delegate-select",disabled:"SELF"!==ae.value,placeholder:"장애 유형을 입력하세요"},null,8,x),[[l.Jo,ie.value]])])]),(0,s.Lk)("label",X,[(0,s.Lk)("span",w,[(0,s.bo)((0,s.Lk)("input",{type:"radio",value:"DELEGATE","onUpdate:modelValue":t[2]||(t[2]=e=>ae.value=e),class:"writer-radio"},null,512),[[l.XL,ae.value]]),A]),(0,s.Lk)("span",q,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>se.value=e),class:"delegate-select",disabled:"DELEGATE"!==ae.value},[F,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(le.value,e=>((0,s.uX)(),(0,s.CE)("option",{key:e.code,value:e.code},(0,i.v_)(e.name),9,K))),128))],8,S),[[l.u1,se.value]])])])])]),a.value?((0,s.uX)(),(0,s.CE)("div",R,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value.sections,e=>((0,s.uX)(),(0,s.CE)("div",{key:e.section_code,class:"section-card"},[(0,s.Lk)("div",T,[(0,s.Lk)("h3",V,(0,i.v_)(e.section_title),1),e.section_desc?((0,s.uX)(),(0,s.CE)("p",U,(0,i.v_)(e.section_desc),1)):(0,s.Q3)("",!0)]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.subsections,e=>((0,s.uX)(),(0,s.CE)("div",{key:e.subsection_code,class:"subsection-card"},[(0,s.Lk)("div",$,[(0,s.Lk)("div",O,(0,i.v_)(e.subsection_title),1),e.subsection_desc?((0,s.uX)(),(0,s.CE)("p",B,(0,i.v_)(e.subsection_desc),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",D,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.items,e=>((0,s.uX)(),(0,s.CE)("div",{key:e.item_code,class:"question-card"},[(0,s.Lk)("div",N,[(0,s.Lk)("div",G,[(0,s.eW)((0,i.v_)(e.question_text)+" ",1),"Y"===e.is_required?((0,s.uX)(),(0,s.CE)("span",Q,"*")):(0,s.Q3)("",!0)])]),"TEXT"===e.question_type?((0,s.uX)(),(0,s.CE)("div",W,[(0,s.bF)(c.A,{modelValue:v.value[e.item_code],"onUpdate:modelValue":t=>v.value[e.item_code]=t,id:`item-${e.item_code}`,label:"답변",variant:"static",size:"default"},null,8,["modelValue","onUpdate:modelValue","id"])])):"TEXTAREA"===e.question_type?((0,s.uX)(),(0,s.CE)("div",j,[(0,s.Lk)("label",{class:"block text-xs font-medium text-gray-500 mb-1",for:`item-${e.item_code}`}," 내용 ",8,z),(0,s.bF)(d.A,{id:`item-${e.item_code}`,variant:"outline",rows:5,placeholder:"내용을 입력하세요",value:v.value[e.item_code],onInput:t=>v.value[e.item_code]=t.target.value},null,8,["id","value","onInput"])])):"RADIO"===e.question_type?((0,s.uX)(),(0,s.CE)("div",H,[J,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.option_values,t=>((0,s.uX)(),(0,s.CE)("label",{key:t.value,class:"choice-basic"},[(0,s.bo)((0,s.Lk)("input",{type:"radio",name:`item_${e.item_code}`,value:t.value,"onUpdate:modelValue":t=>v.value[e.item_code]=t,class:"basic-radio"},null,8,Y),[[l.XL,v.value[e.item_code]]]),(0,s.Lk)("span",null,(0,i.v_)(t.label),1)]))),128))])):"CHECKBOX"===e.question_type?((0,s.uX)(),(0,s.CE)("div",M,[P,((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.option_values,t=>((0,s.uX)(),(0,s.CE)("label",{key:t.value,class:"choice-basic"},[(0,s.Lk)("input",{type:"checkbox",value:t.value,checked:ue(e.item_code,t.value),class:"basic-checkbox",onChange:a=>oe(e.item_code,t.value,a.target.checked)},null,40,Z),(0,s.Lk)("span",null,(0,i.v_)(t.label),1)]))),128))])):((0,s.uX)(),(0,s.CE)("div",ee," 지원되지 않는 질문 타입입니다. "))]))),128))])]))),128))]))),128)),(0,s.Lk)("div",te,[(0,s.bF)(n.A,{color:"dark",size:"sm",class:"px-5",onClick:re},{default:(0,s.k6)(()=>[(0,s.eW)(" 제출하기 ")]),_:1})])])):((0,s.uX)(),(0,s.CE)("div",I,"불러오는 중..."))]))}},se=a(6262);const le=(0,se.A)(ae,[["__scopeId","data-v-035c00ce"]]);var ie=le}}]);
//# sourceMappingURL=826.33acb6fc.js.map