{"version":3,"file":"@/assets/js/848.8e4733a9.js","mappings":"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","sources":["webpack://vue-material-dashboard-2/./src/views/CounselNew.vue","webpack://vue-material-dashboard-2/./src/views/CounselNew.vue?ca7f","webpack://vue-material-dashboard-2/./src/components/MaterialTextarea.vue","webpack://vue-material-dashboard-2/./src/components/MaterialTextarea.vue?6270"],"sourcesContent":["<template>\r\n  <section class=\"p-6\">\r\n    <div class=\"page-shell space-y-6\">\r\n      <!-- ÏÉÅÎã® ÌÉÄÏù¥ÌãÄ -->\r\n      <header class=\"page-header\">\r\n        <h2 class=\"page-title text-2xl md:text-3xl font-bold tracking-tight\">\r\n          ÏÉÅÎã¥ÏÑú ÏûëÏÑ±\r\n        </h2>\r\n\r\n        <div class=\"header-actions\">\r\n          <MaterialButton color=\"dark\" size=\"sm\" @click=\"handleLoad\">\r\n            Î∂àÎü¨Ïò§Í∏∞\r\n          </MaterialButton>\r\n          <MaterialButton color=\"dark\" size=\"sm\" @click=\"handleTempSave\">\r\n            ÏûÑÏãú Ï†ÄÏû•\r\n          </MaterialButton>\r\n        </div>\r\n      </header>\r\n\r\n      <!-- Í∏∞Î≥∏Ï†ïÎ≥¥ Ïπ¥Îìú -->\r\n      <div class=\"meta-card\">\r\n        <div class=\"meta-grid\">\r\n          <!-- 1. ÏßÄÏõêÏûê -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">ÏßÄÏõêÏûê</span>\r\n            <span class=\"meta-value\">{{ submitInfo.childName || \"Î≥∏Ïù∏\" }}</span>\r\n          </div>\r\n\r\n          <!-- 2. Î≥¥Ìò∏Ïûê -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">Î≥¥Ìò∏Ïûê</span>\r\n            <span class=\"meta-value\">{{ submitInfo.guardianName || \"-\" }}</span>\r\n          </div>\r\n\r\n          <!-- 3. Îã¥ÎãπÏûê -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">Îã¥ÎãπÏûê</span>\r\n            <span class=\"meta-value\">{{ submitInfo.assigneeName || \"-\" }}</span>\r\n          </div>\r\n\r\n          <!-- 4. Ïû•Ïï†Ïú†Ìòï -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">Ïû•Ïï†Ïú†Ìòï</span>\r\n            <span class=\"meta-value\">{{\r\n              submitInfo.disabilityType || \"-\"\r\n            }}</span>\r\n          </div>\r\n\r\n          <!-- 5. Ï°∞ÏÇ¨ÏßÄ Ï†úÏ∂úÏùº (ÎùºÎ≤® + Î≤ÑÌäº ÏïàÏóî ÎÇ†ÏßúÎßå) -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">Ï°∞ÏÇ¨ÏßÄ Ï†úÏ∂úÏùº</span>\r\n            <span class=\"meta-value\">\r\n              <MaterialButton\r\n                color=\"dark\"\r\n                size=\"sm\"\r\n                @click=\"openSubmissionDetail\"\r\n              >\r\n                {{ formattedSubmitAt }}\r\n              </MaterialButton>\r\n            </span>\r\n          </div>\r\n\r\n          <!-- 6. ÏÉÅÎã¥Ïùº (date input) -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">ÏÉÅÎã¥Ïùº</span>\r\n            <span class=\"meta-value\">\r\n              <input\r\n                type=\"date\"\r\n                v-model=\"mainForm.counselDate\"\r\n                class=\"input\"\r\n                :min=\"formattedSubmitAt\"\r\n              />\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Î©îÏù∏ ÏÉÅÎã¥ Ïπ¥Îìú (Ï†úÎ™© / ÎÇ¥Ïö© / Ï≤®Î∂Ä) -->\r\n      <div class=\"card-block space-y-4\">\r\n        <!-- ÏÉÅÎã¥ Ï†úÎ™© -->\r\n        <div>\r\n          <label class=\"block text-sm mb-1 font-medium\">ÏÉÅÎã¥ Ï†úÎ™©</label>\r\n          <MaterialInput\r\n            id=\"main-title\"\r\n            variant=\"static\"\r\n            size=\"default\"\r\n            v-model=\"mainForm.title\"\r\n            placeholder=\"ÏÉÅÎã¥ Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî\"\r\n          />\r\n        </div>\r\n\r\n        <!-- ÏÉÅÎã¥ ÎÇ¥Ïö© -->\r\n        <div>\r\n          <label class=\"block text-sm mb-1 font-medium\">ÏÉÅÎã¥ ÎÇ¥Ïö©</label>\r\n          <MaterialTextarea\r\n            id=\"main-content\"\r\n            variant=\"outline\"\r\n            :rows=\"5\"\r\n            placeholder=\"ÏÉÅÎã¥ ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî...\"\r\n            :value=\"mainForm.content\"\r\n            @input=\"(e) => (mainForm.content = e.target.value)\"\r\n          />\r\n        </div>\r\n\r\n        <!-- Ï≤®Î∂Ä ÌååÏùº ÏòÅÏó≠ -->\r\n        <div>\r\n          <label class=\"block text-sm mb-1 font-medium\">Ï≤®Î∂Ä ÌååÏùº</label>\r\n          <input\r\n            ref=\"fileInputRef\"\r\n            type=\"file\"\r\n            multiple\r\n            @change=\"onMainFilesChange\"\r\n            class=\"file-input\"\r\n          />\r\n          <p class=\"mt-1 text-xs text-gray-500\">\r\n            * Ïó¨Îü¨ Í∞ú ÌååÏùºÏùÑ Ìïú Î≤àÏóê ÏÑ†ÌÉùÌïòÍ±∞ÎÇò, ÎÇòÎà†ÏÑú Ïó¨Îü¨ Î≤à ÏÑ†ÌÉùÌï† Ïàò\r\n            ÏûàÏäµÎãàÎã§.\r\n          </p>\r\n\r\n          <!-- Í∏∞Ï°¥ Ï≤®Î∂ÄÌååÏùº Î™©Î°ù -->\r\n          <ul\r\n            v-if=\"existingFiles.length\"\r\n            class=\"mt-2 text-xs text-gray-700 space-y-1\"\r\n          >\r\n            <li\r\n              v-for=\"file in existingFiles\"\r\n              :key=\"file.attachCode\"\r\n              class=\"file-row\"\r\n            >\r\n              <a\r\n                :href=\"file.url\"\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n                class=\"file-link\"\r\n              >\r\n                {{ file.originalFilename }}\r\n              </a>\r\n              <button\r\n                type=\"button\"\r\n                class=\"chip-button\"\r\n                @click=\"removeExistingFile(file.attachCode)\"\r\n              >\r\n                ÏÇ≠Ï†ú\r\n              </button>\r\n            </li>\r\n          </ul>\r\n\r\n          <!-- ÏÉàÎ°ú ÏÑ†ÌÉùÌïú ÌååÏùº Î™©Î°ù -->\r\n          <ul\r\n            v-if=\"mainFiles.length\"\r\n            class=\"mt-2 text-xs text-gray-700 space-y-1\"\r\n          >\r\n            <li\r\n              v-for=\"(file, idx) in mainFiles\"\r\n              :key=\"file.name + '_' + file.lastModified + '_' + idx\"\r\n              class=\"file-row\"\r\n            >\r\n              <span class=\"file-link\">\r\n                {{ file.name }} ({{ (file.size / 1024).toFixed(1) }} KB)\r\n              </span>\r\n              <button\r\n                type=\"button\"\r\n                class=\"chip-button\"\r\n                @click=\"removeMainFile(idx)\"\r\n              >\r\n                ÏÇ≠Ï†ú\r\n              </button>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ù Ïπ¥ÎìúÎì§ -->\r\n      <div\r\n        v-for=\"record in records\"\r\n        :key=\"record.id\"\r\n        class=\"record-card space-y-4\"\r\n      >\r\n        <div class=\"record-header\">\r\n          <h4 class=\"font-medium text-sm\">Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ù</h4>\r\n\r\n          <MaterialButton\r\n            color=\"dark\"\r\n            size=\"sm\"\r\n            variant=\"outlined\"\r\n            @click=\"removeRecord(record.id)\"\r\n          >\r\n            Ï†úÍ±∞\r\n          </MaterialButton>\r\n        </div>\r\n\r\n        <div>\r\n          <label class=\"block text-sm mb-1 font-medium\">ÏÉÅÎã¥Ïùº: </label>\r\n          <input\r\n            type=\"date\"\r\n            v-model=\"record.counselDate\"\r\n            class=\"input\"\r\n            :min=\"formattedSubmitAt\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label class=\"block text-sm mb-1 font-medium\">ÏÉÅÎã¥ Ï†úÎ™©</label>\r\n          <MaterialInput\r\n            :id=\"`record-title-${record.id}`\"\r\n            variant=\"static\"\r\n            size=\"default\"\r\n            v-model=\"record.title\"\r\n            placeholder=\"ÏÉÅÎã¥ Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label class=\"block text-sm mb-1 font-medium\">ÏÉÅÎã¥ ÎÇ¥Ïö©</label>\r\n          <MaterialTextarea\r\n            :id=\"`record-content-${record.id}`\"\r\n            variant=\"outline\"\r\n            :rows=\"3\"\r\n            placeholder=\"ÏÉÅÎã¥ ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî...\"\r\n            :value=\"record.content\"\r\n            @input=\"(e) => (record.content = e.target.value)\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <!-- ÌïòÎã® Ïï°ÏÖò Ï§Ñ -->\r\n      <div class=\"action-bar\">\r\n        <div class=\"left-actions\">\r\n          <MaterialButton color=\"dark\" size=\"sm\" @click=\"goBack\">\r\n            ÏûëÏÑ± Ï∑®ÏÜå\r\n          </MaterialButton>\r\n\r\n          <MaterialButton color=\"dark\" size=\"sm\" @click=\"addRecord\">\r\n            + ÏÉÅÎã¥ Í∏∞Î°ù Ï∂îÍ∞Ä\r\n          </MaterialButton>\r\n        </div>\r\n\r\n        <div class=\"right-actions\">\r\n          <select v-model=\"priority\" class=\"input priority-select\">\r\n            <option value=\"BB1\">Í∏¥Í∏â</option>\r\n            <option value=\"BB2\">Ï§ëÏ†ê</option>\r\n            <option value=\"BB3\">Í≥ÑÌöç</option>\r\n          </select>\r\n\r\n          <MaterialButton color=\"dark\" size=\"sm\" @click=\"submitAll\">\r\n            ÏûëÏÑ± ÏôÑÎ£å\r\n          </MaterialButton>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </section>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted } from \"vue\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nimport { useAuthStore } from \"@/store/authLogin\";\r\nimport axios from \"axios\";\r\n\r\nimport MaterialButton from \"@/components/MaterialButton.vue\";\r\nimport MaterialTextarea from \"@/components/MaterialTextarea.vue\";\r\nimport MaterialInput from \"@/components/MaterialInput.vue\";\r\n\r\nconst auth = useAuthStore();\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst submitCode = Number(route.params.submitCode);\r\n\r\n// Í∏∞Î≥∏ Ï†ïÎ≥¥\r\nconst submitInfo = ref({\r\n  name: \"\",\r\n  ssnFront: \"\",\r\n  submitAt: \"\",\r\n});\r\n\r\nconst formattedSubmitAt = computed(() => {\r\n  const v = submitInfo.value.submitAt;\r\n  return v ? v.slice(0, 10) : \"\";\r\n});\r\n\r\n// Î©îÏù∏ Ìèº\r\nconst mainForm = ref({\r\n  counselDate: \"\",\r\n  title: \"\",\r\n  content: \"\",\r\n});\r\n\r\n// Î©îÏù∏ ÏÉÅÎã¥ Ï≤®Î∂Ä ÌååÏùºÎì§\r\nconst mainFiles = ref([]); // File[]\r\nconst fileInputRef = ref(null); // <input type=\"file\">\r\n\r\n// Í∏∞Ï°¥ Ï≤®Î∂ÄÌååÏùº (ÏûÑÏãúÏ†ÄÏû•/ÏûëÏÑ±ÏóêÏÑú Ïù¥ÎØ∏ Ïò¨ÎùºÍ∞Ñ Í≤ÉÎì§)\r\nconst existingFiles = ref([]);\r\n\r\n// ÏÇ≠Ï†úÌï† Í∏∞Ï°¥ Ï≤®Î∂ÄÌååÏùº ÏΩîÎìúÎì§\r\nconst removedAttachmentCodes = ref([]);\r\n\r\n// Ï∂îÍ∞Ä Í∏∞Î°ùÎì§\r\nconst records = ref([]);\r\nconst priority = ref(\"BB3\");\r\n\r\nconst loading = ref(false);\r\nconst error = ref(\"\");\r\n\r\n// Í∏∞Î≥∏Ï†ïÎ≥¥ Î°úÎî©\r\nasync function loadData() {\r\n  loading.value = true;\r\n  error.value = \"\";\r\n\r\n  try {\r\n    const { data } = await axios.get(`/api/counsel/${submitCode}`);\r\n\r\n    if (!data?.success || !data.result) {\r\n      throw new Error(data?.message || \"ÏÉÅÎã¥ Í∏∞Î≥∏ Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.\");\r\n    }\r\n\r\n    const res = data.result;\r\n\r\n    if (res.submit_info) {\r\n      submitInfo.value = res.submit_info;\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n    error.value = e.message || \"ÏÉÅÎã¥ Í∏∞Î≥∏ Ï†ïÎ≥¥ Ï°∞Ìöå Ï§ë Ïò§Î•ò\";\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  auth.reload(); // ÏÉàÎ°úÍ≥†Ïπ® ÌõÑÏóêÎèÑ userCode Î≥µÍµ¨\r\n  loadData();\r\n});\r\n\r\n// ÌååÏùº Î≥ÄÍ≤Ω Ìï∏Îì§Îü¨\r\nfunction onMainFilesChange(e) {\r\n  const files = Array.from(e.target.files || []);\r\n\r\n  const newOnes = files.filter(\r\n    (f) =>\r\n      !mainFiles.value.some(\r\n        (ex) =>\r\n          ex.name === f.name &&\r\n          ex.size === f.size &&\r\n          ex.lastModified === f.lastModified\r\n      )\r\n  );\r\n\r\n  mainFiles.value = [...mainFiles.value, ...newOnes];\r\n\r\n  if (e.target) {\r\n    e.target.value = \"\";\r\n  }\r\n}\r\n\r\n// ÌååÏùº Í∞úÎ≥Ñ ÏÇ≠Ï†ú\r\nfunction removeMainFile(index) {\r\n  mainFiles.value.splice(index, 1);\r\n}\r\n\r\n// Í∏∞Ï°¥ Ï≤®Î∂Ä ÏÇ≠Ï†ú\r\nfunction removeExistingFile(attachCode) {\r\n  if (!removedAttachmentCodes.value.includes(attachCode)) {\r\n    removedAttachmentCodes.value.push(attachCode);\r\n  }\r\n  existingFiles.value = existingFiles.value.filter(\r\n    (f) => f.attachCode !== attachCode\r\n  );\r\n}\r\n\r\n// ÏûÑÏãú Ï†ÄÏû•\r\nasync function handleTempSave() {\r\n  try {\r\n    const formJson = {\r\n      submitCode,\r\n      priority: priority.value,\r\n      mainForm: mainForm.value,\r\n      records: records.value,\r\n      removeAttachmentCodes: removedAttachmentCodes.value,\r\n    };\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"formJson\", JSON.stringify(formJson));\r\n\r\n    mainFiles.value.forEach((file) => {\r\n      formData.append(\"mainFiles\", file);\r\n    });\r\n\r\n    const res = await axios.post(\"/api/counsel/temp\", formData, {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n    });\r\n\r\n    if (res.data?.success) {\r\n      alert(\"ÏûÑÏãú Ï†ÄÏû•Ïù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.\");\r\n    } else {\r\n      alert(res.data.message || \"ÏûÑÏãú Ï†ÄÏû• Ïã§Ìå®\");\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n    alert(\"ÏÑúÎ≤Ñ Ïò§Î•ò: \" + (e.response?.data?.message || e.message));\r\n  }\r\n}\r\n\r\nasync function handleLoad() {\r\n  try {\r\n    const { data } = await axios.get(`/api/counsel/${submitCode}`);\r\n\r\n    if (!data?.success || !data.result) {\r\n      alert(data?.message || \"Î∂àÎü¨Ïò¨ ÏÉÅÎã¥ ÎÇ¥Ïö©Ïù¥ ÏóÜÏäµÎãàÎã§.\");\r\n      return;\r\n    }\r\n\r\n    const res = data.result;\r\n\r\n    if (res.submit_info) {\r\n      submitInfo.value = res.submit_info;\r\n    }\r\n\r\n    mainForm.value = {\r\n      counselDate: res.main?.counsel_date || \"\",\r\n      title: res.main?.title || \"\",\r\n      content: res.main?.content || \"\",\r\n    };\r\n\r\n    priority.value = res.priority || \"BB3\";\r\n\r\n    records.value =\r\n      (res.details || []).map((d, idx) => ({\r\n        id: d.detail_code || Date.now() + idx,\r\n        counselDate: d.counsel_date || \"\",\r\n        title: d.title || \"\",\r\n        content: d.content || \"\",\r\n      })) || [];\r\n\r\n    existingFiles.value =\r\n      (res.attachments || []).map((a) => ({\r\n        attachCode: a.attachCode,\r\n        originalFilename: a.originalFilename,\r\n        url: a.url,\r\n      })) || [];\r\n\r\n    mainFiles.value = [];\r\n    removedAttachmentCodes.value = [];\r\n\r\n    alert(\"ÏûÑÏãú Ï†ÄÏû•Îêú ÎÇ¥Ïö©ÏùÑ Î∂àÎü¨ÏôîÏäµÎãàÎã§.\");\r\n  } catch (e) {\r\n    console.error(e);\r\n    alert(\r\n      \"ÏÉÅÎã¥ ÎÇ¥Ïö© Î∂àÎü¨Ïò§Í∏∞ Ï§ë Ïò§Î•ò: \" + (e.response?.data?.message || e.message)\r\n    );\r\n  }\r\n}\r\n\r\nfunction openSubmissionDetail() {\r\n  window.open(`/survey/submission/${submitCode}`, \"_blank\");\r\n}\r\n\r\nfunction goBack() {\r\n  router.push({ name: \"counselList\" });\r\n}\r\n\r\nfunction addRecord() {\r\n  records.value.push({\r\n    id: Date.now(),\r\n    counselDate: \"\",\r\n    title: \"\",\r\n    content: \"\",\r\n  });\r\n}\r\n\r\nfunction removeRecord(id) {\r\n  records.value = records.value.filter((r) => r.id !== id);\r\n}\r\n\r\n// Ïú†Ìö®ÏÑ±\r\nfunction validate() {\r\n  if (!mainForm.value.counselDate) return \"ÏÉÅÎã¥ÏùºÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.\";\r\n\r\n  // üîπ Ï°∞ÏÇ¨ÏßÄ Ï†úÏ∂úÏùºÎ≥¥Îã§ Ïïû ÎÇ†Ïßú Î∞©ÏßÄ (Î©îÏù∏ ÏÉÅÎã¥Ïùº)\r\n  if (\r\n    formattedSubmitAt.value &&\r\n    mainForm.value.counselDate < formattedSubmitAt.value\r\n  ) {\r\n    return \"ÏÉÅÎã¥ÏùºÏùÄ Ï°∞ÏÇ¨ÏßÄ Ï†úÏ∂úÏùºÎ≥¥Îã§ Ïù¥Ï†ÑÏùº Ïàò ÏóÜÏäµÎãàÎã§.\";\r\n  }\r\n\r\n  if (!mainForm.value.title.trim()) return \"ÏÉÅÎã¥ Ï†úÎ™©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.\";\r\n  if (!mainForm.value.content.trim()) return \"ÏÉÅÎã¥ ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.\";\r\n\r\n  for (const r of records.value) {\r\n    if (!r.counselDate) return \"Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ùÏùò ÏÉÅÎã¥ÏùºÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.\";\r\n\r\n    // üîπ Ï°∞ÏÇ¨ÏßÄ Ï†úÏ∂úÏùºÎ≥¥Îã§ Ïïû ÎÇ†Ïßú Î∞©ÏßÄ (Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ù)\r\n    if (formattedSubmitAt.value && r.counselDate < formattedSubmitAt.value) {\r\n      return \"Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ùÏùò ÏÉÅÎã¥ÏùºÏùÄ Ï°∞ÏÇ¨ÏßÄ Ï†úÏ∂úÏùºÎ≥¥Îã§ Ïù¥Ï†ÑÏùº Ïàò ÏóÜÏäµÎãàÎã§.\";\r\n    }\r\n\r\n    if (!r.title.trim()) return \"Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ùÏùò Ï†úÎ™©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.\";\r\n    if (!r.content.trim()) return \"Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ùÏùò ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.\";\r\n  }\r\n  return null;\r\n}\r\n\r\n// ÏûëÏÑ± ÏôÑÎ£å\r\nasync function submitAll() {\r\n  const err = validate();\r\n  if (err) {\r\n    alert(err);\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const formJson = {\r\n      submitCode,\r\n      priority: priority.value,\r\n      mainForm: mainForm.value,\r\n      records: records.value,\r\n      removeAttachmentCodes: removedAttachmentCodes.value,\r\n      modifier: auth.userCode,\r\n      requesterCode: auth.userCode,\r\n    };\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"formJson\", JSON.stringify(formJson));\r\n\r\n    mainFiles.value.forEach((file) => {\r\n      formData.append(\"mainFiles\", file);\r\n    });\r\n\r\n    const res = await axios.post(\"/api/counsel/new\", formData, {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n    });\r\n\r\n    if (res.data?.success) {\r\n      alert(\"ÏÉÅÎã¥ Ï†ÄÏû• ÏôÑÎ£å!\");\r\n      router.push({ name: \"counselList\" });\r\n    } else {\r\n      alert(res.data.message || \"Ï†ÄÏû• Ïã§Ìå®\");\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n    alert(\"ÏÑúÎ≤Ñ Ïò§Î•ò: \" + (e.response?.data?.message || e.message));\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\nsection {\r\n  color: #111827;\r\n}\r\n\r\n/* ÌéòÏù¥ÏßÄ Ìè≠ ÌÜµÏùº */\r\n.page-shell {\r\n  max-width: 960px;\r\n  margin: 0 auto;\r\n}\r\n\r\n/* Ìó§Îçî */\r\n.page-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 1rem;\r\n}\r\n\r\n.page-title {\r\n  letter-spacing: -0.02em;\r\n}\r\n\r\n.header-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n/* Í∏∞Î≥∏Ï†ïÎ≥¥ Ïπ¥Îìú */\r\n.meta-card {\r\n  border-radius: 0.75rem;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #f9fafb;\r\n  padding: 0.9rem 1rem;\r\n  font-size: 0.85rem;\r\n}\r\n\r\n.meta-bottom {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1.5rem;\r\n  margin-top: 0.25rem;\r\n}\r\n\r\n/* Î©îÏù∏ ÏÉÅÎã¥ Ïπ¥Îìú */\r\n.card-block {\r\n  border-radius: 0.9rem;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #ffffff;\r\n  box-shadow: 0 8px 18px rgba(15, 23, 42, 0.04);\r\n  padding: 1.25rem 1.1rem;\r\n}\r\n\r\n/* Í≥µÌÜµ Ïù∏Ìíã Ïä§ÌÉÄÏùº (date, select) */\r\n.input {\r\n  border-radius: 0.375rem;\r\n  border: 1px solid #d1d5db;\r\n  padding: 0.35rem 0.6rem;\r\n  font-size: 0.875rem;\r\n  outline: none;\r\n  min-width: 8rem;\r\n}\r\n\r\n.input:focus {\r\n  border-color: #111827;\r\n}\r\n\r\n/* ÌååÏùº Ïù∏Ìíã */\r\n.file-input {\r\n  display: block;\r\n  width: 100%;\r\n  font-size: 0.8rem;\r\n}\r\n\r\n.file-link {\r\n  flex: 1;\r\n  min-width: 0;\r\n  font-size: 0.8rem;\r\n  color: #1d4ed8;\r\n  text-decoration: underline;\r\n  text-underline-offset: 2px;\r\n}\r\n\r\n/* ÏûëÏùÄ Î≤ÑÌäº ÎäêÎÇå */\r\n.chip-button {\r\n  padding: 0.15rem 0.45rem;\r\n  border-radius: 999px;\r\n  border: 1px solid #d1d5db;\r\n  background-color: #f9fafb;\r\n  font-size: 0.7rem;\r\n  color: #4b5563;\r\n  cursor: pointer;\r\n}\r\n\r\n.chip-button:hover {\r\n  background-color: #e5e7eb;\r\n}\r\n\r\n/* ÌïòÎã® Ïï°ÏÖò Î∞î */\r\n.action-bar {\r\n  margin-top: 10px;\r\n  padding-top: 0.5rem;\r\n  border-top: 1px solid #e5e7eb;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  gap: 1rem;\r\n}\r\n\r\n.left-actions,\r\n.right-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.priority-select {\r\n  min-width: 5.5rem;\r\n}\r\n\r\n/* Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ù Ïπ¥Îìú */\r\n.record-card {\r\n  margin-top: 10px;\r\n  border-radius: 0.8rem;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #ffffff;\r\n  padding: 1.1rem 1rem;\r\n  box-shadow: 0 6px 14px rgba(15, 23, 42, 0.04);\r\n}\r\n\r\n.record-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n/* Í≥µÌÜµ Ìè∞Ìä∏ */\r\ntable th,\r\ntable td {\r\n  font-family:\r\n    \"Noto Sans KR\",\r\n    system-ui,\r\n    -apple-system,\r\n    BlinkMacSystemFont,\r\n    \"Segoe UI\",\r\n    sans-serif;\r\n}\r\n/* ÌååÏùº Ìñâ: ÌÖçÏä§Ìä∏ Î∞îÎ°ú ÏòÜÏóê ÏÇ≠Ï†ú Î≤ÑÌäº */\r\n.file-row {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n  justify-content: flex-start;\r\n}\r\n\r\n/* ÌååÏùº ÌÖçÏä§Ìä∏(ÎßÅÌÅ¨) Ïä§ÌÉÄÏùº: ÌöåÏÉâ, Î∞ëÏ§Ñ Ï†úÍ±∞ */\r\n.file-link {\r\n  flex: 0 1 auto;\r\n  min-width: 0;\r\n  font-size: 0.8rem;\r\n  color: #374151; /* Î¨¥Ï±ÑÏÉâ ÌöåÏÉâ Í≥ÑÏó¥ */\r\n  text-decoration: none; /* Í∏∞Î≥∏ Î∞ëÏ§Ñ Ï†úÍ±∞ */\r\n  word-break: break-all;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n}\r\n\r\n/* Ìò∏Î≤Ñ ÏãúÎßå ÏÇ¥ÏßùÎßå ÌëúÏãúÌï¥Ï£ºÍ≥† Ïã∂ÏúºÎ©¥ */\r\n.file-link:hover {\r\n  text-decoration: underline;\r\n}\r\n\r\n.meta-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\r\n  gap: 0.75rem 1rem;\r\n}\r\n\r\n.meta-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.meta-item .meta-label {\r\n  font-size: 0.78rem;\r\n  color: #6b7280;\r\n  margin-bottom: 0.15rem;\r\n}\r\n\r\n.meta-item .meta-value {\r\n  font-size: 0.9rem;\r\n  color: #111827;\r\n  font-weight: 500;\r\n}\r\n</style>\r\n","import script from \"./CounselNew.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./CounselNew.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./CounselNew.vue?vue&type=style&index=0&id=44b660c4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-44b660c4\"]])\n\nexport default __exports__","<template>\r\n  <div\r\n    class=\"input-group\"\r\n    :class=\"`input-group-${variant} ${getStatus(error, success)}`\"\r\n  >\r\n    <textarea\r\n      :id=\"id\"\r\n      class=\"form-control\"\r\n      :rows=\"rows\"\r\n      :name=\"name\"\r\n      :value=\"value\"\r\n      :placeholder=\"placeholder\"\r\n      :isRequired=\"isRequired\"\r\n      :disabled=\"disabled\"\r\n    ></textarea>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport setMaterialInput from \"@/assets/js/material-input.js\";\r\n\r\nexport default {\r\n  name: \"MaterialTextarea\",\r\n  props: {\r\n    variant: {\r\n      type: String,\r\n      default: \"outline\",\r\n    },\r\n    id: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n    name: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    value: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    placeholder: {\r\n      type: String,\r\n      default: \"Your text here...\",\r\n    },\r\n    isRequired: Boolean,\r\n    disabled: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    rows: {\r\n      type: Number,\r\n      default: 5,\r\n    },\r\n    success: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    error: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n  mounted() {\r\n    setMaterialInput();\r\n  },\r\n  methods: {\r\n    getStatus: (error, success) => {\r\n      let isValidValue;\r\n\r\n      if (success) {\r\n        isValidValue = \"is-valid\";\r\n      } else if (error) {\r\n        isValidValue = \"is-invalid\";\r\n      } else {\r\n        isValidValue = null;\r\n      }\r\n\r\n      return isValidValue;\r\n    },\r\n  },\r\n};\r\n</script>\r\n","import { render } from \"./MaterialTextarea.vue?vue&type=template&id=204b2d53\"\nimport script from \"./MaterialTextarea.vue?vue&type=script&lang=js\"\nexport * from \"./MaterialTextarea.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["auth","useAuthStore","route","useRoute","router","useRouter","submitCode","Number","params","submitInfo","ref","name","ssnFront","submitAt","formattedSubmitAt","computed","v","value","slice","mainForm","counselDate","title","content","mainFiles","fileInputRef","existingFiles","removedAttachmentCodes","records","priority","loading","error","async","loadData","data","axios","get","success","result","Error","message","res","submit_info","e","console","onMainFilesChange","files","Array","from","target","newOnes","filter","f","some","ex","size","lastModified","removeMainFile","index","splice","removeExistingFile","attachCode","includes","push","handleTempSave","formJson","removeAttachmentCodes","formData","FormData","append","JSON","stringify","forEach","file","post","headers","alert","response","handleLoad","main","counsel_date","details","map","d","idx","id","detail_code","Date","now","attachments","a","originalFilename","url","openSubmissionDetail","window","open","goBack","addRecord","removeRecord","r","validate","trim","submitAll","err","modifier","userCode","requesterCode","onMounted","reload","__exports__","_createElementBlock","class","_normalizeClass","$props","variant","$options","getStatus","_createElementVNode","rows","placeholder","isRequired","disabled","props","type","String","default","required","Boolean","mounted","setMaterialInput","methods","isValidValue","render"],"sourceRoot":""}