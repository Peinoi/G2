{"version":3,"file":"@/assets/js/605.c71e2858.js","mappings":"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","sources":["webpack://vue-material-dashboard-2/./src/components/MaterialTextarea.vue","webpack://vue-material-dashboard-2/./src/components/MaterialTextarea.vue?6270","webpack://vue-material-dashboard-2/./src/views/PlanWrite.vue","webpack://vue-material-dashboard-2/./src/views/PlanWrite.vue?2bad"],"sourcesContent":["<template>\r\n  <div\r\n    class=\"input-group\"\r\n    :class=\"`input-group-${variant} ${getStatus(error, success)}`\"\r\n  >\r\n    <textarea\r\n      :id=\"id\"\r\n      class=\"form-control\"\r\n      :rows=\"rows\"\r\n      :name=\"name\"\r\n      :value=\"value\"\r\n      :placeholder=\"placeholder\"\r\n      :isRequired=\"isRequired\"\r\n      :disabled=\"disabled\"\r\n    ></textarea>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport setMaterialInput from \"@/assets/js/material-input.js\";\r\n\r\nexport default {\r\n  name: \"MaterialTextarea\",\r\n  props: {\r\n    variant: {\r\n      type: String,\r\n      default: \"outline\",\r\n    },\r\n    id: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n    name: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    value: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    placeholder: {\r\n      type: String,\r\n      default: \"Your text here...\",\r\n    },\r\n    isRequired: Boolean,\r\n    disabled: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    rows: {\r\n      type: Number,\r\n      default: 5,\r\n    },\r\n    success: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    error: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n  mounted() {\r\n    setMaterialInput();\r\n  },\r\n  methods: {\r\n    getStatus: (error, success) => {\r\n      let isValidValue;\r\n\r\n      if (success) {\r\n        isValidValue = \"is-valid\";\r\n      } else if (error) {\r\n        isValidValue = \"is-invalid\";\r\n      } else {\r\n        isValidValue = null;\r\n      }\r\n\r\n      return isValidValue;\r\n    },\r\n  },\r\n};\r\n</script>\r\n","import { render } from \"./MaterialTextarea.vue?vue&type=template&id=204b2d53\"\nimport script from \"./MaterialTextarea.vue?vue&type=script&lang=js\"\nexport * from \"./MaterialTextarea.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n  <section class=\"p-6\">\r\n    <div class=\"page-shell space-y-6\">\r\n      <!-- 상단 타이틀 -->\r\n      <header class=\"page-header\">\r\n        <h2 class=\"page-title text-2xl md:text-3xl font-bold tracking-tight\">\r\n          지원계획 작성\r\n        </h2>\r\n\r\n        <div class=\"header-actions\">\r\n          <MaterialButton color=\"dark\" size=\"sm\" @click=\"handleLoad\">\r\n            불러오기\r\n          </MaterialButton>\r\n          <MaterialButton color=\"dark\" size=\"sm\" @click=\"handleTempSave\">\r\n            임시 저장\r\n          </MaterialButton>\r\n        </div>\r\n      </header>\r\n\r\n      <!-- 로딩 / 에러 -->\r\n      <p v-if=\"loading\" class=\"text-sm text-gray-500\">\r\n        기본 정보를 불러오는 중입니다...\r\n      </p>\r\n      <p v-if=\"error\" class=\"text-sm text-red-500\">{{ error }}</p>\r\n\r\n      <!-- 기본정보 카드 -->\r\n      <div class=\"meta-card\">\r\n        <div class=\"meta-grid\">\r\n          <!-- 1. 지원자 -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">지원자</span>\r\n            <span class=\"meta-value\">\r\n              {{ submitInfo.childName || \"본인\" }}\r\n            </span>\r\n          </div>\r\n\r\n          <!-- 2. 보호자 -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">보호자</span>\r\n            <span class=\"meta-value\">\r\n              {{ submitInfo.guardianName || \"-\" }}\r\n            </span>\r\n          </div>\r\n\r\n          <!-- 3. 담당자 -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">담당자</span>\r\n            <span class=\"meta-value\">\r\n              {{ submitInfo.assigneeName || \"-\" }}\r\n            </span>\r\n          </div>\r\n\r\n          <!-- ⭐ 4. 장애유형 -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">장애유형</span>\r\n            <span class=\"meta-value\">\r\n              {{ submitInfo.disabilityType || \"-\" }}\r\n            </span>\r\n          </div>\r\n\r\n          <!-- 우선순위 -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">우선순위</span>\r\n            <span class=\"meta-value\">\r\n              {{ priorityLabel(submitInfo.level) }}\r\n            </span>\r\n          </div>\r\n\r\n          <!-- 5. 상담지 제출일 -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">상담지 제출일</span>\r\n            <span class=\"meta-value\">\r\n              <MaterialButton color=\"dark\" size=\"sm\" @click=\"openCounselDetail\">\r\n                {{ formattedCounselSubmitAt }}\r\n              </MaterialButton>\r\n            </span>\r\n          </div>\r\n\r\n          <!-- 6. 예상 진행기간 -->\r\n          <div class=\"meta-item\">\r\n            <span class=\"meta-label\">예상 진행기간</span>\r\n            <span class=\"meta-value period-value\">\r\n              <input\r\n                type=\"month\"\r\n                v-model=\"mainForm.expectedStart\"\r\n                class=\"input input-month\"\r\n              />\r\n              <span class=\"mx-1\">~</span>\r\n              <input\r\n                type=\"month\"\r\n                v-model=\"mainForm.expectedEnd\"\r\n                class=\"input input-month\"\r\n              />\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 메인 지원계획 카드 -->\r\n      <div class=\"card-block space-y-4\">\r\n        <!-- 계획 목표 -->\r\n        <div class=\"form-group\">\r\n          <label class=\"block text-sm mb-1 font-medium\">계획 목표</label>\r\n          <MaterialInput\r\n            id=\"plan-goal\"\r\n            variant=\"static\"\r\n            size=\"default\"\r\n            v-model=\"mainForm.goal\"\r\n            placeholder=\"지원계획의 목표를 입력하세요\"\r\n          />\r\n        </div>\r\n\r\n        <!-- 계획 내용 (일반용) -->\r\n        <div class=\"form-group\">\r\n          <label class=\"block text-sm mb-1 font-medium\">\r\n            계획 내용 (일반용)\r\n          </label>\r\n          <MaterialTextarea\r\n            id=\"plan-content-public\"\r\n            variant=\"outline\"\r\n            :rows=\"4\"\r\n            placeholder=\"대상자/일반용 계획 내용을 입력하세요...\"\r\n            :value=\"mainForm.publicContent\"\r\n            @input=\"(e) => (mainForm.publicContent = e.target.value)\"\r\n          />\r\n        </div>\r\n\r\n        <!-- 계획 내용 (관계자/관리자용) -->\r\n        <div class=\"form-group\">\r\n          <label class=\"block text-sm mb-1 font-medium\">\r\n            계획 내용 (관리자용)\r\n          </label>\r\n          <MaterialTextarea\r\n            id=\"plan-content-private\"\r\n            variant=\"outline\"\r\n            :rows=\"4\"\r\n            placeholder=\"관계자/관리자용 내부 계획 내용을 입력하세요...\"\r\n            :value=\"mainForm.privateContent\"\r\n            @input=\"(e) => (mainForm.privateContent = e.target.value)\"\r\n          />\r\n        </div>\r\n\r\n        <!-- 첨부 파일 -->\r\n        <div class=\"form-group\">\r\n          <label class=\"block text-sm mb-1 font-medium\">첨부 파일</label>\r\n          <input\r\n            ref=\"fileInputRef\"\r\n            type=\"file\"\r\n            multiple\r\n            @change=\"onMainFilesChange\"\r\n            class=\"file-input\"\r\n          />\r\n          <p class=\"mt-1 text-xs text-gray-500\">\r\n            * 여러 개 파일을 한 번에 선택하거나, 나눠서 여러 번 선택할 수\r\n            있습니다.\r\n          </p>\r\n\r\n          <ul\r\n            v-if=\"existingFiles.length\"\r\n            class=\"mt-2 text-xs text-gray-700 space-y-1\"\r\n          >\r\n            <li\r\n              v-for=\"(file, idx) in existingFiles\"\r\n              :key=\"file.attachCode\"\r\n              class=\"file-row\"\r\n            >\r\n              <a\r\n                :href=\"file.url\"\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n                class=\"file-link\"\r\n              >\r\n                {{ file.originalFilename }}\r\n              </a>\r\n              <button\r\n                type=\"button\"\r\n                class=\"chip-button\"\r\n                @click=\"removeExistingFile(idx, file.attachCode)\"\r\n              >\r\n                삭제\r\n              </button>\r\n            </li>\r\n          </ul>\r\n\r\n          <!-- 새로 선택한 파일 목록 -->\r\n          <ul\r\n            v-if=\"mainFiles.length\"\r\n            class=\"mt-2 text-xs text-gray-700 space-y-1\"\r\n          >\r\n            <li\r\n              v-for=\"(file, idx) in mainFiles\"\r\n              :key=\"file.name + '_' + file.lastModified + '_' + idx\"\r\n              class=\"file-row\"\r\n            >\r\n              <span class=\"file-link\">\r\n                {{ file.name }} ({{ (file.size / 1024).toFixed(1) }} KB)\r\n              </span>\r\n              <button\r\n                type=\"button\"\r\n                class=\"chip-button\"\r\n                @click=\"removeMainFile(idx)\"\r\n              >\r\n                삭제\r\n              </button>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 추가 계획 카드들 -->\r\n      <div\r\n        v-for=\"item in planItems\"\r\n        :key=\"item.id\"\r\n        class=\"record-card space-y-4\"\r\n      >\r\n        <div class=\"record-header\">\r\n          <h4 class=\"font-medium text-sm\">추가 계획</h4>\r\n\r\n          <MaterialButton\r\n            color=\"dark\"\r\n            size=\"sm\"\r\n            variant=\"outlined\"\r\n            @click=\"removePlanItem(item.id)\"\r\n          >\r\n            제거\r\n          </MaterialButton>\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label class=\"block text-sm mb-1 font-medium\">계획 목표</label>\r\n          <MaterialInput\r\n            :id=\"`plan-item-goal-${item.id}`\"\r\n            variant=\"static\"\r\n            size=\"default\"\r\n            v-model=\"item.goal\"\r\n            placeholder=\"추가 계획의 목표를 입력하세요\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label class=\"block text-sm mb-1 font-medium\">\r\n            계획 내용 (일반용)\r\n          </label>\r\n          <MaterialTextarea\r\n            :id=\"`plan-item-public-${item.id}`\"\r\n            variant=\"outline\"\r\n            :rows=\"3\"\r\n            placeholder=\"대상자/일반용 내용을 입력하세요...\"\r\n            :value=\"item.publicContent\"\r\n            @input=\"(e) => (item.publicContent = e.target.value)\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"form-group\">\r\n          <label class=\"block text-sm mb-1 font-medium\">\r\n            계획 내용 (관리자용)\r\n          </label>\r\n          <MaterialTextarea\r\n            :id=\"`plan-item-private-${item.id}`\"\r\n            variant=\"outline\"\r\n            :rows=\"3\"\r\n            placeholder=\"관계자/관리자용 내용을 입력하세요...\"\r\n            :value=\"item.privateContent\"\r\n            @input=\"(e) => (item.privateContent = e.target.value)\"\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 하단 버튼 라인 -->\r\n      <div class=\"action-bar\">\r\n        <div class=\"left-actions\">\r\n          <MaterialButton color=\"dark\" size=\"sm\" @click=\"goBack\">\r\n            작성 취소\r\n          </MaterialButton>\r\n\r\n          <MaterialButton color=\"dark\" size=\"sm\" @click=\"addPlanItem\">\r\n            + 계획 추가\r\n          </MaterialButton>\r\n        </div>\r\n\r\n        <div class=\"right-actions\">\r\n          <MaterialButton\r\n            color=\"dark\"\r\n            size=\"sm\"\r\n            class=\"ml-auto shrink-0\"\r\n            @click=\"submitAll\"\r\n          >\r\n            제출하기\r\n          </MaterialButton>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </section>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted } from \"vue\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nimport axios from \"axios\";\r\n\r\nimport MaterialButton from \"@/components/MaterialButton.vue\";\r\nimport MaterialTextarea from \"@/components/MaterialTextarea.vue\";\r\nimport MaterialInput from \"@/components/MaterialInput.vue\";\r\n\r\nconst route = useRoute();\r\nconst router = useRouter();\r\n\r\nconst submitCode = Number(route.params.submitcode || 0);\r\n\r\n// 기본 정보\r\nconst submitInfo = ref({\r\n  childName: \"\",\r\n  name: \"\", // 보호자\r\n  guardianName: \"\",\r\n  assigneeName: \"\",\r\n  disabilityType: \"\",\r\n  counselSubmitAt: \"\",\r\n  level: \"\",\r\n});\r\n\r\nconst formattedCounselSubmitAt = computed(() => {\r\n  const v = submitInfo.value.counselSubmitAt;\r\n  return v ? v.slice(0, 10) : \"-\";\r\n});\r\n\r\n// 메인 계획 폼\r\nconst mainForm = ref({\r\n  planDate: \"\", // 계획 작성일 (오늘 날짜)\r\n  expectedStart: \"\", // 실제 진행기간 시작 (YYYY-MM)\r\n  expectedEnd: \"\", // 실제 진행기간 종료 (YYYY-MM)\r\n  goal: \"\",\r\n  publicContent: \"\",\r\n  privateContent: \"\",\r\n});\r\n\r\n// 첨부 파일들\r\nconst mainFiles = ref([]); // File[]\r\nconst fileInputRef = ref(null);\r\n\r\n// 임시저장된 파일\r\nconst existingFiles = ref([]);\r\n// 삭제할 첨부\r\nconst removedAttachCodes = ref([]);\r\n\r\n// 추가 계획 목록\r\nconst planItems = ref([]); // { id, goal, publicContent, privateContent }[]\r\n\r\nconst loading = ref(false);\r\nconst error = ref(\"\");\r\n\r\n// 오늘 날짜 YYYY-MM-DD\r\nfunction getTodayStr() {\r\n  const d = new Date();\r\n  return d.toISOString().slice(0, 10);\r\n}\r\n\r\n// 기본정보 로딩 (지원자/보호자/담당자/장애유형/상담지 제출일)\r\nasync function loadData() {\r\n  loading.value = true;\r\n  error.value = \"\";\r\n\r\n  try {\r\n    const { data } = await axios.get(`/api/plans/${submitCode}`);\r\n\r\n    if (!data?.success || !data.result) {\r\n      throw new Error(data?.message || \"기본 정보를 찾을 수 없습니다.\");\r\n    }\r\n\r\n    const res = data.result;\r\n\r\n    submitInfo.value = {\r\n      childName: res.childName || \"본인\",\r\n      name: res.name || \"\",\r\n      guardianName: res.guardianName || res.name || \"\",\r\n      assigneeName: res.assigneeName || \"-\",\r\n      disabilityType: res.disabilityType || \"-\",\r\n      counselSubmitAt: res.counselSubmitAt || \"\",\r\n      level: res.level || \"\",\r\n    };\r\n\r\n    // 계획 작성일은 오늘 날짜로 기본 세팅\r\n    if (!mainForm.value.planDate) {\r\n      mainForm.value.planDate = getTodayStr();\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n    error.value = e.message || \"기본 정보 조회 중 오류\";\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n}\r\n\r\nfunction priorityLabel(code) {\r\n  const c = (code || \"\").toString().toUpperCase();\r\n\r\n  switch (c) {\r\n    case \"BB1\":\r\n      return \"긴급\";\r\n    case \"BB2\":\r\n      return \"중점\";\r\n    case \"BB3\":\r\n      return \"계획\";\r\n    default:\r\n      return \"-\";\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  mainForm.value.planDate = getTodayStr();\r\n  loadData();\r\n});\r\n\r\n// 파일 변경 핸들러\r\nfunction onMainFilesChange(e) {\r\n  const files = Array.from(e.target.files || []);\r\n\r\n  const newOnes = files.filter(\r\n    (f) =>\r\n      !mainFiles.value.some(\r\n        (ex) =>\r\n          ex.name === f.name &&\r\n          ex.size === f.size &&\r\n          ex.lastModified === f.lastModified\r\n      )\r\n  );\r\n\r\n  mainFiles.value = [...mainFiles.value, ...newOnes];\r\n\r\n  // 같은 파일 다시 선택할 수 있도록 초기화\r\n  if (e.target) {\r\n    e.target.value = \"\";\r\n  }\r\n}\r\n\r\n// 파일 개별 삭제\r\nfunction removeMainFile(index) {\r\n  mainFiles.value.splice(index, 1);\r\n}\r\n\r\n// 임시저장으로 있던 파일 삭제\r\nfunction removeExistingFile(index, attachCode) {\r\n  if (attachCode && !removedAttachCodes.value.includes(attachCode)) {\r\n    removedAttachCodes.value.push(attachCode);\r\n  }\r\n  existingFiles.value.splice(index, 1);\r\n}\r\n\r\n// 임시 저장\r\nasync function handleTempSave() {\r\n  try {\r\n    const formJson = {\r\n      submitCode,\r\n      mainForm: mainForm.value,\r\n      planItems: planItems.value,\r\n      removedAttachCodes: removedAttachCodes.value,\r\n    };\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"formJson\", JSON.stringify(formJson));\r\n\r\n    mainFiles.value.forEach((file) => {\r\n      formData.append(\"planFiles\", file);\r\n    });\r\n\r\n    const res = await axios.post(\"/api/plans/temp\", formData, {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n    });\r\n\r\n    if (res.data?.success) {\r\n      alert(\"임시 저장이 완료되었습니다.\");\r\n    } else {\r\n      alert(res.data.message || \"임시 저장 실패\");\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n    alert(\"서버 오류: \" + (e.response?.data?.message || e.message));\r\n  }\r\n}\r\n\r\n// 임시 저장 불러오기\r\nasync function handleLoad() {\r\n  try {\r\n    const { data } = await axios.get(`/api/plans/form/${submitCode}`);\r\n\r\n    if (!data?.success || !data.result) {\r\n      alert(data?.message || \"불러올 지원계획 내용이 없습니다.\");\r\n      return;\r\n    }\r\n\r\n    const res = data.result;\r\n\r\n    // 메인 계획\r\n    mainForm.value = {\r\n      planDate: res.main?.planDate\r\n        ? String(res.main.planDate).slice(0, 10)\r\n        : getTodayStr(),\r\n      expectedStart: res.main?.expectedStart || \"\",\r\n      expectedEnd: res.main?.expectedEnd || \"\",\r\n      goal: res.main?.goal || \"\",\r\n      publicContent: res.main?.publicContent || \"\",\r\n      privateContent: res.main?.privateContent || \"\",\r\n    };\r\n\r\n    // 추가 계획\r\n    planItems.value =\r\n      (res.items || []).map((d, idx) => ({\r\n        id: d.planItemCode || Date.now() + idx,\r\n        goal: d.goal || \"\",\r\n        publicContent: d.publicContent || \"\",\r\n        privateContent: d.privateContent || \"\",\r\n      })) || [];\r\n\r\n    // 기존 첨부파일\r\n    existingFiles.value =\r\n      (res.attachments || []).map((a) => ({\r\n        attachCode: a.attachCode,\r\n        originalFilename: a.originalFilename,\r\n        url: a.url,\r\n      })) || [];\r\n\r\n    removedAttachCodes.value = [];\r\n\r\n    alert(\"임시 저장된 지원계획을 불러왔습니다.\");\r\n  } catch (e) {\r\n    console.error(e);\r\n    alert(\r\n      \"지원계획 불러오기 중 오류: \" + (e.response?.data?.message || e.message)\r\n    );\r\n  }\r\n}\r\n\r\n// 상담 상세로 연결\r\nfunction openCounselDetail() {\r\n  window.open(`/counsel/detail/${submitCode}`, \"_blank\");\r\n}\r\n\r\n// 목록으로 돌아가기\r\nfunction goBack() {\r\n  router.push({ name: \"planList\" });\r\n}\r\n\r\n// 추가 계획 한 블록 추가\r\nfunction addPlanItem() {\r\n  planItems.value.push({\r\n    id: Date.now(),\r\n    goal: \"\",\r\n    publicContent: \"\",\r\n    privateContent: \"\",\r\n  });\r\n}\r\n\r\n// 추가 계획 삭제\r\nfunction removePlanItem(id) {\r\n  planItems.value = planItems.value.filter((p) => p.id !== id);\r\n}\r\n\r\n// 유효성 체크\r\nfunction validate() {\r\n  if (!mainForm.value.expectedStart) {\r\n    return \"예상 진행기간 시작 월을 선택해주세요.\";\r\n  }\r\n  if (!mainForm.value.expectedEnd) {\r\n    return \"예상 진행기간 종료 월을 선택해주세요.\";\r\n  }\r\n  if (mainForm.value.expectedStart > mainForm.value.expectedEnd) {\r\n    return \"예상 진행기간의 시작 월이 종료 월보다 늦을 수 없습니다.\";\r\n  }\r\n  if (!mainForm.value.goal.trim()) return \"계획 목표를 입력해주세요.\";\r\n  if (!mainForm.value.publicContent.trim())\r\n    return \"계획 내용(일반용)을 입력해주세요.\";\r\n  if (!mainForm.value.privateContent.trim())\r\n    return \"계획 내용(관자용)을 입력해주세요.\";\r\n\r\n  for (const p of planItems.value) {\r\n    if (!p.goal.trim()) return \"추가 계획의 목표를 입력해주세요.\";\r\n    if (!p.publicContent.trim())\r\n      return \"추가 계획의 내용(일반용)을 입력해주세요.\";\r\n    if (!p.privateContent.trim())\r\n      return \"추가 계획의 내용(관자용)을 입력해주세요.\";\r\n  }\r\n\r\n  return null;\r\n}\r\n\r\n// 제출하기\r\nasync function submitAll() {\r\n  const err = validate();\r\n  if (err) {\r\n    alert(err);\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const formJson = {\r\n      submitCode,\r\n      mainForm: mainForm.value,\r\n      planItems: planItems.value,\r\n      removedAttachCodes: removedAttachCodes.value,\r\n    };\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"formJson\", JSON.stringify(formJson));\r\n\r\n    mainFiles.value.forEach((file) => {\r\n      formData.append(\"planFiles\", file);\r\n    });\r\n\r\n    const res = await axios.post(\"/api/plans/new\", formData, {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n    });\r\n\r\n    if (res.data?.success) {\r\n      alert(\"지원계획이 저장되었습니다.\");\r\n      router.push({ name: \"planList\" });\r\n    } else {\r\n      alert(res.data.message || \"저장 실패\");\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n    alert(\"서버 오류: \" + (e.response?.data?.message || e.message));\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\nsection {\r\n  color: #111827;\r\n}\r\n\r\n/* 페이지 폭 통일 */\r\n.page-shell {\r\n  max-width: 960px;\r\n  margin: 0 auto;\r\n}\r\n\r\n/* 헤더 */\r\n.page-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 1rem;\r\n}\r\n\r\n.page-title {\r\n  letter-spacing: -0.02em;\r\n}\r\n\r\n.header-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n/* 기본정보 카드 */\r\n.meta-card {\r\n  border-radius: 0.75rem;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #f9fafb;\r\n  padding: 0.9rem 1rem;\r\n  font-size: 0.85rem;\r\n}\r\n\r\n.meta-bottom {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  align-items: center;\r\n  gap: 1.1rem;\r\n  margin-top: 0.25rem;\r\n}\r\n\r\n/* 메인 카드 (지원계획 내용) */\r\n.card-block {\r\n  border-radius: 0.9rem;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #ffffff;\r\n  box-shadow: 0 8px 18px rgba(15, 23, 42, 0.04);\r\n  padding: 1.25rem 1.1rem;\r\n}\r\n\r\n/* 그룹 간 간격 (label + input/textarea 묶음) */\r\n.form-group + .form-group {\r\n  margin-top: 0.85rem;\r\n}\r\n\r\n/* 공통 인풋 스타일 (date, month, select 등) */\r\n.input {\r\n  border-radius: 0.375rem;\r\n  border: 1px solid #d1d5db;\r\n  padding: 0.35rem 0.6rem;\r\n  font-size: 0.875rem;\r\n  outline: none;\r\n  min-width: 8rem;\r\n  background-color: #ffffff;\r\n}\r\n\r\n.input:focus {\r\n  border-color: #111827;\r\n}\r\n\r\n/* 파일 인풋 */\r\n.file-input {\r\n  display: block;\r\n  width: 100%;\r\n  font-size: 0.8rem;\r\n}\r\n\r\n/* 파일 리스트 */\r\n.file-row {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.file-link {\r\n  flex: 0 1 auto;\r\n  min-width: 0;\r\n  font-size: 0.8rem;\r\n  color: #374151; /* 무채색 회색 */\r\n  text-decoration: none; /* 기본 밑줄 제거 */\r\n  text-underline-offset: 2px;\r\n  word-break: break-all;\r\n}\r\n\r\n/* 호버 시 티 나게 */\r\n.file-link:hover {\r\n  text-decoration: underline;\r\n  color: #111827; /* 조금 더 진한 회색 */\r\n}\r\n\r\n/* 작은 칩 버튼 */\r\n.chip-button {\r\n  padding: 0.15rem 0.45rem;\r\n  border-radius: 999px;\r\n  border: 1px solid #d1d5db;\r\n  background-color: #f9fafb;\r\n  font-size: 0.7rem;\r\n  color: #4b5563;\r\n  cursor: pointer;\r\n  white-space: nowrap;\r\n}\r\n\r\n.chip-button:hover {\r\n  background-color: #e5e7eb;\r\n}\r\n\r\n/* 하단 액션 바 */\r\n.action-bar {\r\n  margin-top: 10px;\r\n  padding-top: 0.5rem;\r\n  border-top: 1px solid #e5e7eb;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  gap: 1rem;\r\n}\r\n\r\n.left-actions,\r\n.right-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n/* 추가 계획 카드 */\r\n.record-card {\r\n  margin-top: 10px;\r\n  border-radius: 0.8rem;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #ffffff;\r\n  padding: 1.1rem 1rem;\r\n  box-shadow: 0 6px 14px rgba(15, 23, 42, 0.04);\r\n}\r\n\r\n.record-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n/* 공통 폰트 */\r\nsection,\r\nlabel,\r\ninput,\r\ntextarea {\r\n  font-family:\r\n    \"Noto Sans KR\",\r\n    system-ui,\r\n    -apple-system,\r\n    BlinkMacSystemFont,\r\n    \"Segoe UI\",\r\n    sans-serif;\r\n}\r\n\r\n/* ===== 기본정보 그리드 (상세/작성/수정 통일 스타일) ===== */\r\n.meta-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\r\n  gap: 0.75rem 1rem;\r\n}\r\n\r\n.meta-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.meta-item .meta-label {\r\n  font-size: 0.78rem;\r\n  color: #6b7280;\r\n  margin-bottom: 0.15rem;\r\n}\r\n\r\n.meta-item .meta-value {\r\n  font-size: 0.9rem;\r\n  color: #111827;\r\n  font-weight: 500;\r\n}\r\n\r\n/* 날짜 박스 */\r\n.date-box {\r\n  padding: 0.35rem 0.6rem;\r\n  border: 1px solid #d1d5db;\r\n  border-radius: 0.375rem;\r\n  background: #ffffff;\r\n  font-size: 0.875rem;\r\n}\r\n\r\n/* 기간 인풋 정렬 */\r\n.period-value {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.35rem;\r\n}\r\n.input-month {\r\n  width: 95px;\r\n  min-width: 80px;\r\n  max-width: 110px;\r\n  padding: 0.2rem 0.35rem;\r\n  font-size: 0.75rem;\r\n}\r\n</style>\r\n","import script from \"./PlanWrite.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./PlanWrite.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./PlanWrite.vue?vue&type=style&index=0&id=19e53104&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-19e53104\"]])\n\nexport default __exports__"],"names":["_createElementBlock","class","_normalizeClass","$props","variant","$options","getStatus","error","success","_createElementVNode","id","rows","name","value","placeholder","isRequired","disabled","props","type","String","default","required","Boolean","Number","mounted","setMaterialInput","methods","isValidValue","__exports__","render","route","useRoute","router","useRouter","submitCode","params","submitcode","submitInfo","ref","childName","guardianName","assigneeName","disabilityType","counselSubmitAt","level","formattedCounselSubmitAt","computed","v","slice","mainForm","planDate","expectedStart","expectedEnd","goal","publicContent","privateContent","mainFiles","fileInputRef","existingFiles","removedAttachCodes","planItems","loading","getTodayStr","d","Date","toISOString","async","loadData","data","axios","get","result","Error","message","res","e","console","priorityLabel","code","c","toString","toUpperCase","onMainFilesChange","files","Array","from","target","newOnes","filter","f","some","ex","size","lastModified","removeMainFile","index","splice","removeExistingFile","attachCode","includes","push","handleTempSave","formJson","formData","FormData","append","JSON","stringify","forEach","file","post","headers","alert","response","handleLoad","main","items","map","idx","planItemCode","now","attachments","a","originalFilename","url","openCounselDetail","window","open","goBack","addPlanItem","removePlanItem","p","validate","trim","submitAll","err","onMounted"],"sourceRoot":""}