"use strict";(self["webpackChunkvue_material_dashboard_2"]=self["webpackChunkvue_material_dashboard_2"]||[]).push([[648],{4267:function(e,a,l){l.r(a),l.d(a,{default:function(){return ie}});l(3725),l(5019),l(2598);var t=l(641),s=l(2644),n=l(9841),u=l(5220),r=l(4335),i=l(6698);const c=e=>((0,t.Qi)("data-v-9401eeb0"),e=e(),(0,t.jt)(),e),v={class:"p-6 max-w-5xl mx-auto space-y-6"},d={class:"form-action"},o={class:"detail-card"},k={class:"flex justify-between items-center detail-header"},_=c(()=>(0,t.Lk)("h2",{class:"text-2xl font-semibold"},"메인 이벤트 정보",-1)),m={class:"event-main-image"},L=["src"],p={key:1,class:"no-image"},b={class:"meta-card improved-meta"},f={class:"info-grid"},h=c(()=>(0,t.Lk)("div",{class:"info-label"},"이벤트명",-1)),g={class:"info-value"},y=c(()=>(0,t.Lk)("div",{class:"info-label"},"기관명",-1)),C={class:"info-value"},E=c(()=>(0,t.Lk)("div",{class:"info-label"},"장소",-1)),w={class:"info-value"},A=c(()=>(0,t.Lk)("div",{class:"info-label"},"최대 참여자",-1)),X={class:"info-value"},x=c(()=>(0,t.Lk)("div",{class:"info-label"},"모집 기간",-1)),j={class:"info-value"},I=c(()=>(0,t.Lk)("div",{class:"info-label"},"진행 기간",-1)),K={class:"info-value"},Q={class:"content-block"},F=c(()=>(0,t.Lk)("div",{class:"content-title"},"내용",-1)),S={class:"content-box whitespace-pre-line"},W={class:"block-card"},R={class:"field-block"},B=c(()=>(0,t.Lk)("div",{class:"field-label"},"첨부파일",-1)),$={key:0},z={class:"file-list"},D=["onClick"],N={key:1,class:"text-xs text-gray-400"},O=["src"],J={key:0,class:"detail-card"},q=c(()=>(0,t.Lk)("h2",{class:"text-xl font-semibold mb-4"},"세부 이벤트 정보",-1)),V={class:"sub-event-table"},Y=c(()=>(0,t.Lk)("thead",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("th",null,"세부이벤트코드"),(0,t.Lk)("th",null,"세부이벤트명"),(0,t.Lk)("th",null,"시행기간"),(0,t.Lk)("th",null,"모집인원")])],-1)),G={key:1,class:"detail-card"},H=c(()=>(0,t.Lk)("h2",{class:"text-lg font-semibold mb-4"},"매니저 정보",-1)),M={key:0,class:"meta-card mb-4"},P=c(()=>(0,t.Lk)("h5",null,"메인 매니저 정보",-1)),T={class:"manager-table"},U=c(()=>(0,t.Lk)("thead",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("th",null,"이름"),(0,t.Lk)("th",null,"부서"),(0,t.Lk)("th",null,"이메일"),(0,t.Lk)("th",null,"전화번호")])],-1)),Z={key:1,class:"meta-card"},ee=c(()=>(0,t.Lk)("h5",null,"서브 매니저 정보",-1)),ae={class:"manager-table"},le=c(()=>(0,t.Lk)("thead",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("th",null,"이름"),(0,t.Lk)("th",null,"부서"),(0,t.Lk)("th",null,"이메일"),(0,t.Lk)("th",null,"전화번호")])],-1)),te={key:2,class:"pt-4 border-t mt-2 space-y-3"},se={class:"approve-actions"};var ne={__name:"EventApplyInfo",setup(e){const a=(0,u.lq)(),l=(0,u.rd)(),c=()=>{const e=localStorage.getItem("user");if(!e)return null;try{const a=JSON.parse(e);return a.user_code||null}catch{return null}},ne=c(),ue=()=>{const e=localStorage.getItem("user");if(!e)return null;try{const a=JSON.parse(e);return a.role||null}catch{return null}},re=(0,n.KR)(ue()),ie=Number(a.params.eventCode||0),ce=(0,n.KR)({sub_events:[],attachments:[]}),ve=(0,n.KR)(""),de=(0,n.KR)(!1),oe=(0,n.KR)(""),ke=e=>{const a=e.original_filename.split(".").pop().toLowerCase();["jpg","jpeg","png","gif","webp"].includes(a)?oe.value=e.file_path:"pdf"!==a?window.location.href=e.file_path:window.open(e.file_path,"_blank")},_e=()=>oe.value="",me=(0,t.EW)(()=>"AA3"===re.value&&"BA2"!==ce.value.register_status),Le=e=>{switch(e){case"BA1":return"status-pill--before";case"BA2":return"status-pill--done";case"BA3":return"status-pill--rejected";default:return""}},pe=e=>e?new Date(e).toISOString().slice(0,10):"",be=(0,t.EW)(()=>ce.value.sub_managers?.find(e=>"DA1"===e.manager_type)||{}),fe=(0,t.EW)(()=>ce.value.sub_managers?.filter(e=>"DA2"===e.manager_type)||[]),he=async()=>{try{const e=await r.A.get(`/api/event/${ie}`,{params:{user_code:ne}});ce.value=e.data.data||{},de.value=!!ce.value.alreadyApplied;const a=ce.value.attachments.find(e=>/\.(jpg|jpeg|png|gif)$/i.test(e.original_filename));ve.value=a?a.file_path:"",await(0,t.dY)()}catch(e){console.error("fetchEvent error:",e)}},ge=async()=>{try{const e=await r.A.post(`/api/event/${ie}/approve`);e.data.success?(alert("승인되었습니다."),await he()):alert(e.data.message||"승인 실패")}catch(e){console.error(e),alert("서버 오류: "+(e.message||""))}},ye=async()=>{const e=prompt("반려 사유를 입력해주세요:");if(e)try{const a=await r.A.post(`/api/event/${ie}/reject`,{reason:e});a.data.success?(alert("반려 처리되었습니다."),await he()):alert(a.data.message||"반려 실패")}catch(a){console.error(a),alert("서버 오류: "+(a.message||""))}},Ce=()=>l.back();return(0,t.sV)(()=>he()),(e,a)=>((0,t.uX)(),(0,t.CE)("section",v,[(0,t.Lk)("div",d,[(0,t.bF)(i.A,{color:"dark",size:"sm",variant:"outlined",onClick:Ce},{default:(0,t.k6)(()=>[(0,t.eW)(" ← 목록으로 ")]),_:1})]),(0,t.Lk)("div",o,[(0,t.Lk)("header",k,[_,(0,t.Lk)("span",{class:(0,s.C4)(["status-pill",Le(ce.value.register_status)])},(0,s.v_)(ce.value.register_status_name),3)]),(0,t.Lk)("div",m,[ve.value?((0,t.uX)(),(0,t.CE)("img",{key:0,src:ve.value,alt:"대표 이미지"},null,8,L)):((0,t.uX)(),(0,t.CE)("div",p,"이미지 없음"))]),(0,t.Lk)("div",b,[(0,t.Lk)("div",f,[h,(0,t.Lk)("div",g,(0,s.v_)(ce.value.event_name),1),y,(0,t.Lk)("div",C,(0,s.v_)(ce.value.org_name),1),E,(0,t.Lk)("div",w,(0,s.v_)(ce.value.event_location),1),A,(0,t.Lk)("div",X,(0,s.v_)(ce.value.max_participants),1),x,(0,t.Lk)("div",j,(0,s.v_)(pe(ce.value.recruit_start_date))+" ~ "+(0,s.v_)(pe(ce.value.recruit_end_date)),1),I,(0,t.Lk)("div",K,(0,s.v_)(pe(ce.value.event_start_date))+" ~ "+(0,s.v_)(pe(ce.value.event_end_date)),1)])]),(0,t.Lk)("div",Q,[F,(0,t.Lk)("div",S,(0,s.v_)(ce.value.event_content),1)]),(0,t.Lk)("div",W,[(0,t.Lk)("div",R,[B,ce.value.attachments?.length?((0,t.uX)(),(0,t.CE)("div",$,[(0,t.Lk)("ul",z,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(ce.value.attachments,e=>((0,t.uX)(),(0,t.CE)("li",{key:e.server_filename},[(0,t.Lk)("span",{class:"file-name",onClick:a=>ke(e)},(0,s.v_)(e.original_filename),9,D)]))),128))])])):((0,t.uX)(),(0,t.CE)("div",N," 첨부된 파일이 없습니다. "))]),oe.value?((0,t.uX)(),(0,t.CE)("div",{key:0,class:"preview-modal",onClick:_e},[(0,t.Lk)("img",{src:oe.value,class:"preview-img"},null,8,O)])):(0,t.Q3)("",!0)])]),ce.value.sub_events.length?((0,t.uX)(),(0,t.CE)("div",J,[q,(0,t.Lk)("table",V,[Y,(0,t.Lk)("tbody",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(ce.value.sub_events,e=>((0,t.uX)(),(0,t.CE)("tr",{key:e.sub_event_code},[(0,t.Lk)("td",null,(0,s.v_)(e.sub_event_code),1),(0,t.Lk)("td",null,(0,s.v_)(e.sub_event_name),1),(0,t.Lk)("td",null,(0,s.v_)(e.sub_event_start_date)+" ~ "+(0,s.v_)(e.sub_event_end_date),1),(0,t.Lk)("td",null,(0,s.v_)(e.sub_recruit_count),1)]))),128))])])])):(0,t.Q3)("",!0),be.value.manager_name||fe.value.length?((0,t.uX)(),(0,t.CE)("div",G,[H,be.value.manager_name?((0,t.uX)(),(0,t.CE)("div",M,[P,(0,t.Lk)("table",T,[U,(0,t.Lk)("tbody",null,[(0,t.Lk)("tr",null,[(0,t.Lk)("td",null,(0,s.v_)(be.value.manager_name),1),(0,t.Lk)("td",null,(0,s.v_)(be.value.department),1),(0,t.Lk)("td",null,(0,s.v_)(be.value.email),1),(0,t.Lk)("td",null,(0,s.v_)(be.value.phone),1)])])])])):(0,t.Q3)("",!0),fe.value.length?((0,t.uX)(),(0,t.CE)("div",Z,[ee,(0,t.Lk)("table",ae,[le,(0,t.Lk)("tbody",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(fe.value,e=>((0,t.uX)(),(0,t.CE)("tr",{key:e.manager_num},[(0,t.Lk)("td",null,(0,s.v_)(e.manager_name),1),(0,t.Lk)("td",null,(0,s.v_)(e.department),1),(0,t.Lk)("td",null,(0,s.v_)(e.email),1),(0,t.Lk)("td",null,(0,s.v_)(e.phone),1)]))),128))])])])):(0,t.Q3)("",!0)])):(0,t.Q3)("",!0),me.value?((0,t.uX)(),(0,t.CE)("div",te,[(0,t.Lk)("div",se,[(0,t.bF)(i.A,{color:"dark",size:"sm",class:"px-4",onClick:ge},{default:(0,t.k6)(()=>[(0,t.eW)(" 승인 ")]),_:1}),(0,t.bF)(i.A,{color:"dark",size:"sm",class:"px-4",onClick:ye},{default:(0,t.k6)(()=>[(0,t.eW)(" 반려 ")]),_:1})])])):(0,t.Q3)("",!0)]))}},ue=l(6262);const re=(0,ue.A)(ne,[["__scopeId","data-v-9401eeb0"]]);var ie=re}}]);
//# sourceMappingURL=648.7444dc81.js.map