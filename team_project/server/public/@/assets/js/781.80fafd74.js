"use strict";(self["webpackChunkvue_material_dashboard_2"]=self["webpackChunkvue_material_dashboard_2"]||[]).push([[781],{4781:function(e,s,l){l.r(s),l.d(s,{default:function(){return ve}});l(8743),l(3725),l(1339);var t=l(641),a=l(2644),i=l(9322),d=l(9841),o=l(5220),n=l(4335),u=l(6698),c=l(2351),r=l(1157);const k=e=>((0,t.Qi)("data-v-f483e8ba"),e=e(),(0,t.jt)(),e),v={class:"p-6 max-w-5xl mx-auto"},m={class:"flex items-center justify-between header-row"},p=k(()=>(0,t.Lk)("h2",{class:"text-2xl font-semibold"},"새 버전 작성",-1)),b={class:"space-x-2"},f={key:0,class:"empty-state"},C=k(()=>(0,t.Lk)("div",{class:"text-gray-600 mb-4"},"아직 항목이 없습니다.",-1)),y={key:1,class:"space-y-6"},x={class:"section-header"},L={class:"section-title"},_={class:"space-x-2"},E={class:"grid md:grid-cols-2 gap-3 mb-4"},h={class:"space-y-4"},g={class:"sub-header"},A={class:"font-medium text-sm"},F={class:"space-x-2"},V={class:"grid md:grid-cols-2 gap-3 mb-3"},X={class:"space-y-3"},z={class:"question-header"},w={class:"font-medium text-sm text-gray-800"},W={class:"grid md:grid-cols-3 gap-3"},$=k(()=>(0,t.Lk)("label",{class:"block text-xs font-medium text-gray-500 mb-1"}," 질문 타입 ",-1)),q=["onUpdate:modelValue","onChange"],U=k(()=>(0,t.Lk)("option",{value:"TEXT"},"단답형",-1)),I=k(()=>(0,t.Lk)("option",{value:"TEXTAREA"},"서술형",-1)),K=k(()=>(0,t.Lk)("option",{value:"RADIO"},"단일 선택",-1)),T=k(()=>(0,t.Lk)("option",{value:"CHECKBOX"},"다중 선택",-1)),O=[U,I,K,T],Q={class:"md:col-span-2"},R={class:"mt-2"},j={key:0,class:"mt-4 border-t pt-3"},S={class:"flex items-center justify-between mb-2"},D={class:"text-xs font-medium text-gray-700"},B={class:"space-y-2"},H={class:"text-[11px] text-gray-500"},N={class:"flex justify-end"},Y={class:"form-actions"},G={key:2,class:"modal-overlay"},J={class:"modal-box"},M=k(()=>(0,t.Lk)("h3",{class:"text-xl font-semibold mb-4"},"작성 내용 확인",-1)),P={class:"preview-scroll space-y-4 pr-2"},Z={class:"font-semibold text-lg mb-1"},ee={class:"text-gray-600 mb-3"},se={class:"font-medium"},le={class:"text-gray-500 mb-2"},te={class:"font-medium mb-1"},ae={key:0,class:"text-red-600 text-sm"},ie={class:"text-gray-800 mb-2"},de={key:0,class:"mt-2"},oe=k(()=>(0,t.Lk)("div",{class:"text-xs text-gray-600 mb-1"},"옵션",-1)),ne={class:"list-disc pl-6 text-sm"},ue={class:"form-actions"};var ce={__name:"SurveyNew",setup(e){const s=(0,o.rd)(),l=(0,d.KR)([]);let k=1;const U=()=>k++,I=e=>["RADIO","CHECKBOX"].includes(String(e).toUpperCase());function K(){l.value.push({id:U(),title:"",desc:"",subsections:[]})}function T(e){l.value.splice(e,1)}function ce(e){l.value[e].subsections.push({id:U(),title:"",desc:"",items:[]})}function re(e,s){l.value[e].subsections.splice(s,1)}function ke(e,s){l.value[e].subsections[s].items.push({id:U(),type:"TEXT",text:"",required:!1,options:[]})}function ve(e,s,t){l.value[e].subsections[s].items.splice(t,1)}function me(e){I(e.type)?(Array.isArray(e.options)||(e.options=[]),0===e.options.length&&e.options.push({id:U(),label:""})):e.options=[]}function pe(e,s,t){const a=l.value[e].subsections[s].items[t];a.options.push({id:U(),label:""})}function be(e,s,t,a){const i=l.value[e].subsections[s].items[t];i.options.splice(a,1)}const fe=(0,t.EW)(()=>({template:{version_no:"2.0",status:"ACTIVE",created_by:1,created_at:(new Date).toISOString().slice(0,10)},sections:l.value.map((e,s)=>({order:s+1,title:e.title,desc:e.desc,subsections:e.subsections.map((e,s)=>({order:s+1,title:e.title,desc:e.desc,items:e.items.map((e,s)=>({order:s+1,question_type:e.type,question_text:e.text,is_required:e.required?"Y":"N",option_values:I(e.type)?e.options.map((e,s)=>{const l=e.label||"";return{label:l,value:l,order:s+1}}):null}))}))}))})),Ce=(0,d.KR)(!1);function ye(){Ce.value=!0}async function xe(){try{const{data:e}=await n.A.post("/api/survey/new",fe.value);e?.success?(alert("조사지 저장 완료!"),s.push("/survey-version")):alert("저장 실패")}catch(e){console.error("save error:",e),alert("서버 오류: "+(e.response?.data?.message||e.message))}}function Le(){s.push({name:"surveyVersion"})}return(e,s)=>((0,t.uX)(),(0,t.CE)("section",v,[(0,t.Lk)("header",m,[p,(0,t.Lk)("div",b,[(0,t.bF)(u.A,{color:"dark",size:"sm",variant:"outlined",onClick:Le},{default:(0,t.k6)(()=>[(0,t.eW)(" ← 목록 ")]),_:1})])]),0===l.value.length?((0,t.uX)(),(0,t.CE)("div",f,[C,(0,t.bF)(u.A,{color:"dark",size:"sm",onClick:K},{default:(0,t.k6)(()=>[(0,t.eW)(" + 항목 추가 ")]),_:1})])):((0,t.uX)(),(0,t.CE)("div",y,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(l.value,(e,s)=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:"section-card"},[(0,t.Lk)("div",x,[(0,t.Lk)("h3",L,"항목 #"+(0,a.v_)(s+1),1),(0,t.Lk)("div",_,[(0,t.bF)(u.A,{color:"dark",size:"sm",variant:"outlined",onClick:e=>ce(s)},{default:(0,t.k6)(()=>[(0,t.eW)(" 세부항목 추가 ")]),_:2},1032,["onClick"]),(0,t.bF)(u.A,{color:"dark",size:"sm",variant:"outlined",onClick:e=>T(s)},{default:(0,t.k6)(()=>[(0,t.eW)(" 삭제 ")]),_:2},1032,["onClick"])])]),(0,t.Lk)("div",E,[(0,t.Lk)("div",null,[(0,t.bF)(c.A,{modelValue:e.title,"onUpdate:modelValue":s=>e.title=s,id:`sec-title-${s}`,label:"항목 제목",variant:"static",size:"default"},null,8,["modelValue","onUpdate:modelValue","id"])]),(0,t.Lk)("div",null,[(0,t.bF)(c.A,{modelValue:e.desc,"onUpdate:modelValue":s=>e.desc=s,id:`sec-desc-${s}`,label:"항목 설명",variant:"static",size:"default"},null,8,["modelValue","onUpdate:modelValue","id"])])]),(0,t.Lk)("div",h,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.subsections,(e,l)=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:"subsection-card"},[(0,t.Lk)("div",g,[(0,t.Lk)("div",A," 세부항목 #"+(0,a.v_)(l+1),1),(0,t.Lk)("div",F,[(0,t.bF)(u.A,{color:"dark",size:"sm",variant:"outlined",onClick:e=>ke(s,l)},{default:(0,t.k6)(()=>[(0,t.eW)(" 질문 추가 ")]),_:2},1032,["onClick"]),(0,t.bF)(u.A,{color:"dark",size:"sm",variant:"outlined",onClick:e=>re(s,l)},{default:(0,t.k6)(()=>[(0,t.eW)(" 삭제 ")]),_:2},1032,["onClick"])])]),(0,t.Lk)("div",V,[(0,t.Lk)("div",null,[(0,t.bF)(c.A,{modelValue:e.title,"onUpdate:modelValue":s=>e.title=s,id:`sub-title-${s}-${l}`,label:"세부항목 제목",variant:"static",size:"default"},null,8,["modelValue","onUpdate:modelValue","id"])]),(0,t.Lk)("div",null,[(0,t.bF)(c.A,{modelValue:e.desc,"onUpdate:modelValue":s=>e.desc=s,id:`sub-desc-${s}-${l}`,label:"세부항목 설명",variant:"static",size:"default"},null,8,["modelValue","onUpdate:modelValue","id"])])]),(0,t.Lk)("div",X,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.items,(e,d)=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:"question-card"},[(0,t.Lk)("div",z,[(0,t.Lk)("div",w," 질문 #"+(0,a.v_)(d+1),1),(0,t.bF)(u.A,{color:"dark",size:"sm",variant:"outlined",onClick:e=>ve(s,l,d)},{default:(0,t.k6)(()=>[(0,t.eW)(" 삭제 ")]),_:2},1032,["onClick"])]),(0,t.Lk)("div",W,[(0,t.Lk)("div",null,[$,(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":s=>e.type=s,class:"w-full input-basic",onChange:s=>me(e)},O,40,q),[[i.u1,e.type]])]),(0,t.Lk)("div",Q,[(0,t.bF)(c.A,{modelValue:e.text,"onUpdate:modelValue":s=>e.text=s,id:`q-text-${s}-${l}-${d}`,label:"질문 내용",variant:"static",size:"default"},null,8,["modelValue","onUpdate:modelValue","id"])])]),(0,t.Lk)("div",R,[(0,t.bF)(r.A,{id:`required-${s}-${l}-${d}`,name:`required-${s}-${l}-${d}`,checked:e.required,labelClass:"text-xs text-gray-700",onClick:s=>e.required=!e.required},{default:(0,t.k6)(()=>[(0,t.eW)(" 필수 질문 ")]),_:2},1032,["id","name","checked","onClick"])]),I(e.type)?((0,t.uX)(),(0,t.CE)("div",j,[(0,t.Lk)("div",S,[(0,t.Lk)("div",D," 옵션 ("+(0,a.v_)(e.options.length)+") ",1),(0,t.bF)(u.A,{color:"dark",size:"sm",variant:"outlined",onClick:e=>pe(s,l,d)},{default:(0,t.k6)(()=>[(0,t.eW)(" + 옵션 추가 ")]),_:2},1032,["onClick"])]),(0,t.Lk)("div",B,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.options,(e,i)=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:"option-row"},[(0,t.Lk)("div",H," #"+(0,a.v_)(i+1),1),(0,t.Lk)("div",null,[(0,t.bF)(c.A,{modelValue:e.label,"onUpdate:modelValue":s=>e.label=s,id:`label-${e.id}`,label:"옵션 라벨",variant:"static",size:"default"},null,8,["modelValue","onUpdate:modelValue","id"])]),(0,t.Lk)("div",N,[(0,t.bF)(u.A,{color:"dark",size:"sm",variant:"outlined",onClick:e=>be(s,l,d,i)},{default:(0,t.k6)(()=>[(0,t.eW)(" 삭제 ")]),_:2},1032,["onClick"])])]))),128))])])):(0,t.Q3)("",!0)]))),128))])]))),128))])]))),128)),(0,t.Lk)("div",Y,[(0,t.bF)(u.A,{color:"dark",size:"sm",variant:"outlined",onClick:K},{default:(0,t.k6)(()=>[(0,t.eW)(" + 항목 추가 ")]),_:1}),(0,t.bF)(u.A,{color:"dark",size:"sm",class:"px-5",onClick:ye},{default:(0,t.k6)(()=>[(0,t.eW)(" 작성 완료 ")]),_:1})])])),Ce.value?((0,t.uX)(),(0,t.CE)("div",G,[(0,t.Lk)("div",J,[M,(0,t.Lk)("div",P,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(l.value,(e,s)=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:"preview-section"},[(0,t.Lk)("h4",Z," 항목 #"+(0,a.v_)(s+1)+" — "+(0,a.v_)(e.title||"제목 없음"),1),(0,t.Lk)("p",ee,(0,a.v_)(e.desc||"설명 없음"),1),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.subsections,(e,s)=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:"preview-subsection"},[(0,t.Lk)("h5",se," 세부항목 #"+(0,a.v_)(s+1)+" — "+(0,a.v_)(e.title||"제목 없음"),1),(0,t.Lk)("p",le,(0,a.v_)(e.desc||"설명 없음"),1),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.items,(e,s)=>((0,t.uX)(),(0,t.CE)("div",{key:e.id,class:"preview-question"},[(0,t.Lk)("div",te,[(0,t.eW)(" 질문 #"+(0,a.v_)(s+1)+" ",1),e.required?((0,t.uX)(),(0,t.CE)("span",ae," *필수 ")):(0,t.Q3)("",!0)]),(0,t.Lk)("div",ie,(0,a.v_)(e.text||"질문 내용 없음"),1),I(e.type)?((0,t.uX)(),(0,t.CE)("div",de,[oe,(0,t.Lk)("ul",ne,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.options,e=>((0,t.uX)(),(0,t.CE)("li",{key:e.id},(0,a.v_)(e.label||"라벨 없음"),1))),128))])])):(0,t.Q3)("",!0)]))),128))]))),128))]))),128))]),(0,t.Lk)("div",ue,[(0,t.bF)(u.A,{color:"dark",size:"sm",variant:"outlined",onClick:s[0]||(s[0]=e=>Ce.value=!1)},{default:(0,t.k6)(()=>[(0,t.eW)(" 수정하기 ")]),_:1}),(0,t.bF)(u.A,{color:"dark",size:"sm",class:"px-5",onClick:xe},{default:(0,t.k6)(()=>[(0,t.eW)(" 최종 제출하기 ")]),_:1})])])])):(0,t.Q3)("",!0)]))}},re=l(6262);const ke=(0,re.A)(ce,[["__scopeId","data-v-f483e8ba"]]);var ve=ke}}]);
//# sourceMappingURL=781.80fafd74.js.map