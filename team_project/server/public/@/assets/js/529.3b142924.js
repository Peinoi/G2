"use strict";(self["webpackChunkvue_material_dashboard_2"]=self["webpackChunkvue_material_dashboard_2"]||[]).push([[529],{6529:function(e,a,l){l.r(a),l.d(a,{default:function(){return O}});l(8743);var t=l(641),u=l(9322),r=l(2644),i=l(9841),n=l(4335),o=l(5220),s=l(2798);const p=e=>((0,t.Qi)("data-v-d95141e4"),e=e(),(0,t.jt)(),e),v={class:"priority-page"},d=p(()=>(0,t.Lk)("h2",{class:"priority-title"},"지원계획 승인 요청 목록",-1)),c={class:"priority-filters"},k=["onKeyup"],y=p(()=>(0,t.Lk)("option",{value:""},"전체",-1)),L=p(()=>(0,t.Lk)("option",{value:"BA1"},"요청",-1)),_=p(()=>(0,t.Lk)("option",{value:"BA2"},"승인",-1)),h=p(()=>(0,t.Lk)("option",{value:"BA3"},"반려",-1)),b=[y,L,_,h],g=p(()=>(0,t.Lk)("option",{value:"latest"},"최신순",-1)),f=p(()=>(0,t.Lk)("option",{value:"oldest"},"오래된순",-1)),B=p(()=>(0,t.Lk)("option",{value:"name"},"이름순",-1)),C=p(()=>(0,t.Lk)("option",{value:"priority"},"우선순위순",-1)),A=[g,f,B,C],m={class:"priority-card"},E={key:0,class:"priority-loading"},w={key:1,class:"priority-table"},K=p(()=>(0,t.Lk)("th",null,"승인코드",-1)),R=p(()=>(0,t.Lk)("th",null,"이름",-1)),X=p(()=>(0,t.Lk)("th",null,"장애유형",-1)),W=p(()=>(0,t.Lk)("th",null,"보호자",-1)),I=p(()=>(0,t.Lk)("th",null,"담당자",-1)),Q={key:0},V=p(()=>(0,t.Lk)("th",null,"계획 작성일",-1)),j=p(()=>(0,t.Lk)("th",null,"우선순위",-1)),S=p(()=>(0,t.Lk)("th",null,"상태",-1)),U=p(()=>(0,t.Lk)("th",null,"처리일",-1)),q=["onClick"],P={key:0},z={key:0},D=["colspan"],F={key:2,class:"priority-pagination"},J=["disabled"],M={class:"priority-page-info"},x=["disabled"];var G={__name:"SupportPlanApproval",setup(e){const a=(0,o.rd)(),l=(0,s.n)(),p=(0,t.EW)(()=>l.role||l.user&&l.user.roleCode||""),y=(0,t.EW)(()=>l.userId||l.loginId||l.id||l.user&&l.user.userId||""),L=(0,t.EW)(()=>"AA3"===p.value),_=(0,t.EW)(()=>"AA4"===p.value),h=(0,t.EW)(()=>L.value||_.value),g=(0,t.EW)(()=>!L.value),f=(0,i.KR)([]),B=(0,i.KR)(1),C=(0,i.KR)(10),G=(0,i.KR)(0),H=(0,i.KR)(!1),N=(0,t.EW)(()=>G.value>0?Math.ceil(G.value/C.value):1),O=(0,i.KR)(""),T=(0,i.KR)(""),Y=(0,i.KR)("latest"),Z=(0,t.EW)(()=>_.value?4:3),$={BA1:"요청",BA2:"승인",BA3:"반려",BB1:"긴급",BB2:"중점",BB3:"준비"};function ee(){B.value=1,re()}function ae(e){return e?$[e]||e:""}function le(e){switch(e){case"BB1":return"priority-chip-danger";case"BB2":return"priority-chip-warning";case"BB3":return"priority-chip-info";default:return"priority-chip-default"}}function te(e){switch(e){case"BA1":return"priority-badge-request";case"BA2":return"priority-badge-approve";case"BA3":return"priority-badge-reject";default:return"priority-badge-default"}}function ue(e){if(!e)return"";const a=String(e);return a.length>=10?a.slice(0,10):a}async function re(){H.value=!0;try{const e=await n.A.get("/api/approvals/support-plan",{params:{page:B.value,size:C.value,keyword:O.value,state:T.value,orderBy:Y.value,loginId:y.value,role:p.value}}),a=e.data?.data||{},l=Array.isArray(a.rows)?a.rows:[];f.value=l,G.value=a.totalCount??0}catch(e){console.error("[SupportPlanApproval] loadList error:",e),f.value=[],G.value=0}finally{H.value=!1}}function ie(e){e<1||e>N.value||e!==B.value&&(B.value=e,re())}function ne(e){a.push({name:"planDetail",params:{planCode:e.plan_code},query:{role:Z.value,submitCode:e.submit_code}})}return(0,t.sV)(()=>{if(!h.value)return alert("기관 관리자 및 시스템 관리자만 접근할 수 있습니다."),void a.push("/");re()}),(e,a)=>((0,t.uX)(),(0,t.CE)("div",v,[d,(0,t.Lk)("div",c,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>O.value=e),class:"priority-input",placeholder:"이름/보호자/기관 검색",onKeyup:(0,u.jR)(ee,["enter"])},null,40,k),[[u.Jo,O.value]]),(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>T.value=e),class:"priority-select",onChange:ee},b,544),[[u.u1,T.value]]),(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":a[2]||(a[2]=e=>Y.value=e),class:"priority-select",onChange:ee},A,544),[[u.u1,Y.value]])]),(0,t.Lk)("div",m,[H.value?((0,t.uX)(),(0,t.CE)("div",E,"불러오는 중...")):((0,t.uX)(),(0,t.CE)("table",w,[(0,t.Lk)("thead",null,[(0,t.Lk)("tr",null,[K,R,X,W,I,g.value?((0,t.uX)(),(0,t.CE)("th",Q,"기관")):(0,t.Q3)("",!0),V,j,S,U])]),(0,t.Lk)("tbody",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(f.value,e=>((0,t.uX)(),(0,t.CE)("tr",{key:e.approval_code,onClick:a=>ne(e),class:"priority-row"},[(0,t.Lk)("td",null,(0,r.v_)(e.approval_code),1),(0,t.Lk)("td",null,(0,r.v_)(e.child_name||"본인"),1),(0,t.Lk)("td",null,(0,r.v_)(e.disability_type),1),(0,t.Lk)("td",null,(0,r.v_)(e.parent_name),1),(0,t.Lk)("td",null,(0,r.v_)(e.manager_name),1),g.value?((0,t.uX)(),(0,t.CE)("td",P,(0,r.v_)(e.org_name),1)):(0,t.Q3)("",!0),(0,t.Lk)("td",null,(0,r.v_)(ue(e.written_at)),1),(0,t.Lk)("td",null,[(0,t.Lk)("span",{class:(0,r.C4)(["priority-chip",le(e.priority_level)])},(0,r.v_)(ae(e.priority_level)),3)]),(0,t.Lk)("td",null,[(0,t.Lk)("span",{class:(0,r.C4)(["priority-badge",te(e.state)])},(0,r.v_)(ae(e.state)),3)]),(0,t.Lk)("td",null,(0,r.v_)("BA1"!==e.state&&e.approval_date?ue(e.approval_date):"-"),1)],8,q))),128)),0===f.value.length?((0,t.uX)(),(0,t.CE)("tr",z,[(0,t.Lk)("td",{class:"priority-empty",colspan:g.value?10:9}," 데이터가 없습니다. ",8,D)])):(0,t.Q3)("",!0)])])),!H.value&&N.value>1?((0,t.uX)(),(0,t.CE)("div",F,[(0,t.Lk)("button",{class:"priority-page-btn",disabled:1===B.value,onClick:a[3]||(a[3]=e=>ie(B.value-1))}," 이전 ",8,J),(0,t.Lk)("span",M,(0,r.v_)(B.value)+" / "+(0,r.v_)(N.value)+" (총 "+(0,r.v_)(G.value)+"건) ",1),(0,t.Lk)("button",{class:"priority-page-btn",disabled:B.value===N.value,onClick:a[4]||(a[4]=e=>ie(B.value+1))}," 다음 ",8,x)])):(0,t.Q3)("",!0)])]))}},H=l(6262);const N=(0,H.A)(G,[["__scopeId","data-v-d95141e4"]]);var O=N}}]);
//# sourceMappingURL=529.3b142924.js.map