"use strict";(self["webpackChunkvue_material_dashboard_2"]=self["webpackChunkvue_material_dashboard_2"]||[]).push([[557],{5557:function(e,l,t){t.r(l),t.d(l,{default:function(){return ce}});t(8743),t(3725),t(5019);var a=t(641),s=t(9322),u=t(2644),n=t(9841),r=t(5220),i=t(4335),c=t(6698),o=t(6888),v=t(8896),d=t(5848);const f=e=>((0,a.Qi)("data-v-f36b8f40"),e=e(),(0,a.jt)(),e),k={class:"p-6 max-w-6xl mx-auto"},p={class:"page-inner"},m=f(()=>(0,a.Lk)("header",{class:"mb-2 header-row"},[(0,a.Lk)("div",{class:"header-title"},[(0,a.Lk)("h2",{class:"page-title text-2xl md:text-3xl font-bold tracking-tight whitespace-nowrap align-middle"}," 조사지 제출 목록 ")])],-1)),h={key:0,class:"snack-area"},C={class:"mb-3 flex justify-between items-center action-row"},_={class:"flex items-center gap-2"},b={key:1,class:"filter-row"},L=["onSubmit"],g={class:"filter-field filter-field--search"},y=["placeholder"],A={class:"filter-field filter-field--select select-wrapper"},E=f(()=>(0,a.Lk)("option",{value:"ALL"},"전체 상태",-1)),w=f(()=>(0,a.Lk)("option",{value:"CA1"},"미검토",-1)),x=f(()=>(0,a.Lk)("option",{value:"CA3"},"검토완료",-1)),X=[E,w,x],R={class:"filter-field filter-field--select select-wrapper"},K=f(()=>(0,a.Lk)("option",{value:"RECENT"},"최신순",-1)),S=f(()=>(0,a.Lk)("option",{value:"OLD"},"오래된순",-1)),Q=f(()=>(0,a.Lk)("option",{value:"NAME"},"이름순",-1)),N=[K,S,Q],W={class:"filter-field filter-field--button"},$={key:2,class:"text-gray-500"},D={key:3,class:"text-red-600"},I={key:4,class:"empty-card"},F={key:5,class:"table-card"},M={class:"nice-table"},T=f(()=>(0,a.Lk)("th",{class:"th-cell text-center w-14"},"No",-1)),z={key:0,class:"th-cell"},B=f(()=>(0,a.Lk)("th",{class:"th-cell"},"지원자 이름",-1)),O=f(()=>(0,a.Lk)("th",{class:"th-cell"},"보호자 이름",-1)),U=f(()=>(0,a.Lk)("th",{class:"th-cell"},"담당자 이름",-1)),V={key:1,class:"th-cell"},j=f(()=>(0,a.Lk)("th",{class:"th-cell text-center"},"제출일",-1)),J=f(()=>(0,a.Lk)("th",{class:"th-cell text-center"},"상태",-1)),P=["onClick"],q={class:"td-cell text-center"},G={key:0,class:"td-cell text-left mono"},H={class:"td-cell text-left"},Y={class:"td-cell text-left"},Z={class:"td-cell text-left"},ee={key:1,class:"td-cell text-left"},le={class:"td-cell text-center"},te={class:"td-cell text-center td-status"},ae={key:6,class:"mt-6 text-center"},se={key:7,class:"empty-state"},ue=10;var ne={__name:"SurveyList",setup(e){const l=(0,r.rd)(),t=(0,n.KR)(1),f=(0,n.KR)(null),E=(0,n.KR)(null),w=(0,n.KR)("AA1"),x=(0,n.KR)([]),K=(0,n.KR)(!1),S=(0,n.KR)(""),Q=(0,n.KR)(!1),ne=(0,n.KR)(null),re=(0,n.KR)(""),ie=(0,n.KR)(""),ce=(0,n.KR)("ALL"),oe=(0,n.KR)("RECENT"),ve=(0,a.EW)(()=>4===t.value?"지원자, 보호자, 담당자, 기관명 검색":"지원자, 보호자, 담당자 검색"),de=(0,n.KR)(1),fe=(0,a.EW)(()=>{let e=[...x.value];const l=ie.value;return l&&(e=e.filter(e=>{const a=[e.child_name,e.writer_name,e.assignee_name],s=4===t.value?[e.org_name,e.institution_name]:[],u=[...a,...s];return u.some(e=>String(e||"").toLowerCase().includes(l))})),"ALL"!==ce.value&&(e=e.filter(e=>e.status===ce.value)),"RECENT"===oe.value?e.sort((e,l)=>new Date(l.submit_at)-new Date(e.submit_at)):"OLD"===oe.value?e.sort((e,l)=>new Date(e.submit_at)-new Date(l.submit_at)):"NAME"===oe.value&&e.sort((e,l)=>{const t=e.child_name||"본인",a=l.child_name||"본인";return t.localeCompare(a,"ko")}),e}),ke=(0,a.EW)(()=>Math.max(1,Math.ceil(fe.value.length/ue)||1)),pe=(0,a.EW)(()=>{const e=(de.value-1)*ue;return fe.value.slice(e,e+ue)});function me(e){e<1||e>ke.value||(de.value=e)}function he(){ie.value=re.value.trim().toLowerCase(),de.value=1}function Ce(e){switch(e){case"AA1":return 1;case"AA2":return 2;case"AA3":return 3;case"AA4":return 4;default:return 1}}async function _e(){K.value=!0,S.value="";try{if(1===t.value&&!f.value)throw new Error("로그인 정보를 찾을 수 없습니다. (user_code 없음)");const{data:e}=await i.A.get("/api/survey/submissions",{params:{role:t.value,userId:f.value}}),l=Array.isArray(e)?e:Array.isArray(e?.result)?e.result:[];x.value=l,de.value=1}catch(e){S.value=e?.response?.data?.message||e.message||"목록을 불러오지 못했습니다.",x.value=[]}finally{K.value=!1}}function be(e){if(!e)return"-";const l=new Date(e);return isNaN(l)?String(e):l.toISOString().slice(0,10)}function Le(e){switch(e){case"CA1":return"미검토";case"CA3":return"검토완료";default:return e||"-"}}function ge(e){switch(e){case"CA1":return"status-pending";case"CA3":return"status-done";default:return"status-default"}}function ye(e){l.push({path:`/survey/submission/${e}`,query:{role:t.value,userId:f.value}})}function Ae(){if(!E.value)return ne.value&&(clearTimeout(ne.value),ne.value=null),Q.value=!0,void(ne.value=setTimeout(()=>{Q.value=!1,ne.value=null},2500));l.push("/survey/write")}function Ee(){Q.value=!1,ne.value&&(clearTimeout(ne.value),ne.value=null)}return(0,a.sV)(()=>{try{const e=localStorage.getItem("user");if(e){const l=JSON.parse(e),a=l.user_code??l.userCode??l.id,s=l.auth_code??l.authCode??l.role_code??l.role??"AA1",u=l.org_code??l.orgCode??null;f.value=a?Number(a):null,w.value=s,t.value=Ce(String(s).toUpperCase()),E.value=u}else f.value=null,w.value="AA1",t.value=1,E.value=null}catch(e){console.error("localStorage 파싱 오류:",e),f.value=null,w.value="AA1",t.value=1,E.value=null}_e()}),(e,l)=>((0,a.uX)(),(0,a.CE)("section",k,[(0,a.Lk)("div",p,[m,Q.value?((0,a.uX)(),(0,a.CE)("div",h,[(0,a.bF)(d.A,{simple:"",title:"기관을 먼저 등록하세요.",description:"",date:"",icon:{component:"notifications",color:"white"},color:"danger",closeHandler:Ee})])):(0,a.Q3)("",!0),(0,a.Lk)("div",C,[(0,a.Lk)("div",_,[1===t.value?((0,a.uX)(),(0,a.Wv)(c.A,{key:0,color:"dark",size:"sm",onClick:Ae},{default:(0,a.k6)(()=>[(0,a.eW)(" 조사지 작성하기 ")]),_:1})):(0,a.Q3)("",!0)])]),1!==t.value?((0,a.uX)(),(0,a.CE)("div",b,[(0,a.Lk)("form",{class:"filter-form",onSubmit:(0,s.D$)(he,["prevent"])},[(0,a.Lk)("div",g,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>re.value=e),type:"text",class:"search-input",placeholder:ve.value},null,8,y),[[s.Jo,re.value]])]),(0,a.Lk)("div",A,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>ce.value=e),class:"select-input"},X,512),[[s.u1,ce.value]])]),(0,a.Lk)("div",R,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":l[2]||(l[2]=e=>oe.value=e),class:"select-input"},N,512),[[s.u1,oe.value]])]),(0,a.Lk)("div",W,[(0,a.bF)(c.A,{type:"submit",color:"dark",size:"sm"},{default:(0,a.k6)(()=>[(0,a.eW)(" 검색 ")]),_:1})])],40,L)])):(0,a.Q3)("",!0),K.value?((0,a.uX)(),(0,a.CE)("div",$,"불러오는 중...")):S.value?((0,a.uX)(),(0,a.CE)("div",D,(0,u.v_)(S.value),1)):2===t.value&&0===x.value.length?((0,a.uX)(),(0,a.CE)("div",I," 아직 배정받지 않았습니다. ")):((0,a.uX)(),(0,a.CE)("div",F,[(0,a.Lk)("table",M,[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[T,4===t.value?((0,a.uX)(),(0,a.CE)("th",z,"세부버전")):(0,a.Q3)("",!0),B,O,U,4===t.value?((0,a.uX)(),(0,a.CE)("th",V,"기관명")):(0,a.Q3)("",!0),j,J])]),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(pe.value,(e,l)=>((0,a.uX)(),(0,a.CE)("tr",{key:e.submit_code,class:"table-row-item",onClick:l=>ye(e.submit_code)},[(0,a.Lk)("td",q,(0,u.v_)((de.value-1)*ue+l+1),1),4===t.value?((0,a.uX)(),(0,a.CE)("td",G,(0,u.v_)(e.version_detail_no),1)):(0,a.Q3)("",!0),(0,a.Lk)("td",H,(0,u.v_)(e.child_name||"본인"),1),(0,a.Lk)("td",Y,(0,u.v_)(e.writer_name||e.written_by),1),(0,a.Lk)("td",Z,(0,u.v_)(e.assignee_name||e.assi_by||"-"),1),4===t.value?((0,a.uX)(),(0,a.CE)("td",ee,(0,u.v_)(e.org_name||e.institution_name||"-"),1)):(0,a.Q3)("",!0),(0,a.Lk)("td",le,(0,u.v_)(be(e.submit_at)),1),(0,a.Lk)("td",te,[(0,a.Lk)("span",{class:(0,u.C4)(["status-pill",ge(e.status)])},(0,u.v_)(Le(e.status)),3)])],8,P))),128))])])])),!K.value&&!S.value&&ke.value>1?((0,a.uX)(),(0,a.CE)("div",ae,[(0,a.bF)(o.A,{color:"dark",size:"md",class:"pagination"},{default:(0,a.k6)(()=>[(0,a.bF)(v.A,{prev:"",disabled:1===de.value,onClick:l[3]||(l[3]=e=>me(de.value-1))},null,8,["disabled"]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(ke.value,e=>((0,a.uX)(),(0,a.Wv)(v.A,{key:e,label:String(e),active:e===de.value,onClick:l=>me(e)},null,8,["label","active","onClick"]))),128)),(0,a.bF)(v.A,{next:"",disabled:de.value===ke.value,onClick:l[4]||(l[4]=e=>me(de.value+1))},null,8,["disabled"])]),_:1})])):(0,a.Q3)("",!0),K.value||S.value||0!==x.value.length||2===t.value?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",se," 조회된 제출본이 없습니다. "))])]))}},re=t(6262);const ie=(0,re.A)(ne,[["__scopeId","data-v-f36b8f40"]]);var ce=ie},6888:function(e,l,t){t.d(l,{A:function(){return c}});var a=t(641),s=t(2644);function u(e,l,t,u,n,r){return(0,a.uX)(),(0,a.CE)("ul",{class:(0,s.C4)(["pagination",r.getClasses(t.color,t.size)])},[(0,a.RG)(e.$slots,"default")],2)}var n={name:"MaterialPagination",props:{color:{type:String,default:"success"},size:{type:String,default:"md"}},methods:{getClasses:(e,l)=>{let t,a;return t=e?`pagination-${e}`:null,a=l?`pagination-${l}`:null,`${t} ${a}`}}},r=t(6262);const i=(0,r.A)(n,[["render",u]]);var c=i},8896:function(e,l,t){t.d(l,{A:function(){return d}});var a=t(641),s=t(2644);const u={class:"page-link",href:"javascript:;"},n={key:0,class:"fa fa-angle-left"},r={key:1,class:"fa fa-angle-right"};function i(e,l,t,i,c,o){return(0,a.uX)(),(0,a.CE)("li",{class:(0,s.C4)(["page-item",o.getClasses(t.active,t.disabled)])},[(0,a.Lk)("a",u,[(0,a.eW)((0,s.v_)(t.prev||t.next?null:t.label)+" ",1),t.prev?((0,a.uX)(),(0,a.CE)("i",n)):(0,a.Q3)("",!0),t.next?((0,a.uX)(),(0,a.CE)("i",r)):(0,a.Q3)("",!0)])],2)}var c={name:"MaterialPaginationItem",props:{label:{type:String,default:""},active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},prev:{type:Boolean,default:!1},next:{type:Boolean,default:!1}},methods:{getClasses:(e,l)=>{let t,a;return t=e?"active":null,a=l?"disabled":null,`${t} ${a}`}}},o=t(6262);const v=(0,o.A)(c,[["render",i]]);var d=v}}]);
//# sourceMappingURL=557.a535debb.js.map