"use strict";(self["webpackChunkvue_material_dashboard_2"]=self["webpackChunkvue_material_dashboard_2"]||[]).push([[641],{3022:function(e,l,a){a.r(l),a.d(l,{default:function(){return pe}});a(8743),a(3725),a(2598);var t=a(641),r=a(9322),o=a(2644),u=a(9841),i=a(4335),n=a(5220),s=a(2798);const v=e=>((0,t.Qi)("data-v-4481bb52"),e=e(),(0,t.jt)(),e),p={class:"priority-page"},d=v(()=>(0,t.Lk)("h2",{class:"priority-title"},"우선순위 승인 요청 목록",-1)),c={class:"priority-filters"},k=["onKeyup"],y=v(()=>(0,t.Lk)("option",{value:""},"전체",-1)),L=v(()=>(0,t.Lk)("option",{value:"BA1"},"요청",-1)),_=v(()=>(0,t.Lk)("option",{value:"BA2"},"승인",-1)),b=v(()=>(0,t.Lk)("option",{value:"BA3"},"반려",-1)),h=[y,L,_,b],C=v(()=>(0,t.Lk)("option",{value:"latest"},"최신순",-1)),f=v(()=>(0,t.Lk)("option",{value:"oldest"},"오래된순",-1)),m=v(()=>(0,t.Lk)("option",{value:"name"},"이름순",-1)),g=v(()=>(0,t.Lk)("option",{value:"priority"},"우선순위순",-1)),A=[C,f,m,g],B={class:"priority-card"},E={key:0,class:"priority-loading"},w={key:1,class:"priority-table"},W=v(()=>(0,t.Lk)("th",null,"승인코드",-1)),K=v(()=>(0,t.Lk)("th",null,"이름",-1)),X=v(()=>(0,t.Lk)("th",null,"장애유형",-1)),R=v(()=>(0,t.Lk)("th",null,"보호자",-1)),I=v(()=>(0,t.Lk)("th",null,"담당자",-1)),Q={key:0},S=v(()=>(0,t.Lk)("th",null,"상담기록",-1)),F=v(()=>(0,t.Lk)("th",null,"우선순위",-1)),j=v(()=>(0,t.Lk)("th",null,"상태",-1)),V=v(()=>(0,t.Lk)("th",null,"처리일",-1)),q=["onClick"],U={key:0},P={key:0},x=["colspan"],z={key:2,class:"priority-pagination"},D=["disabled"],J={class:"priority-page-info"},M=["disabled"],$=["onClick"],G={class:"priority-modal"},H=v(()=>(0,t.Lk)("h3",{class:"priority-modal-title"},"이전 반려 사유",-1)),N={class:"priority-modal-section"},O=v(()=>(0,t.Lk)("div",{class:"priority-modal-label"},"반려 사유",-1)),T={class:"priority-modal-reason"},Y={class:"priority-modal-section"},Z=v(()=>(0,t.Lk)("div",{class:"priority-modal-label"},"최신 승인 상태",-1)),ee={class:"priority-modal-text"},le=v(()=>(0,t.Lk)("strong",null,"재승인 요청(대기)",-1)),ae=v(()=>(0,t.Lk)("br",null,null,-1)),te=v(()=>(0,t.Lk)("strong",null,"승인 완료된 건",-1)),re=v(()=>(0,t.Lk)("br",null,null,-1)),oe=v(()=>(0,t.Lk)("strong",null,"반려 상태",-1)),ue=v(()=>(0,t.Lk)("br",null,null,-1)),ie=v(()=>(0,t.Lk)("br",null,null,-1));var ne={__name:"PriorityApproval",setup(e){const l=(0,n.rd)(),a=(0,s.n)(),v=(0,u.KR)([]),y=(0,u.KR)(1),L=(0,u.KR)(10),_=(0,u.KR)(0),b=(0,u.KR)(!1),C=(0,t.EW)(()=>_.value>0?Math.ceil(_.value/L.value):1),f=(0,u.KR)(""),m=(0,u.KR)(""),g=(0,u.KR)("latest"),ne=(0,u.KR)(!1),se=(0,u.KR)({reason:"",newestApprovalCode:"",newestState:""}),ve=(0,t.EW)(()=>ke.value?4:3),pe=(0,t.EW)(()=>a.role||a.user&&a.user.roleCode||""),de=(0,t.EW)(()=>a.userId||a.loginId||a.id||a.user&&a.user.userId||""),ce=(0,t.EW)(()=>"AA3"===pe.value),ke=(0,t.EW)(()=>"AA4"===pe.value),ye=(0,t.EW)(()=>ce.value||ke.value),Le=(0,t.EW)(()=>!ce.value),_e={BA1:"요청",BA2:"승인",BA3:"반려",BB1:"긴급",BB2:"중점",BB3:"준비"};function be(){y.value=1,ge()}function he(e){return e?_e[e]||e:""}function Ce(e){switch(e){case"BB1":return"priority-chip-danger";case"BB2":return"priority-chip-warning";case"BB3":return"priority-chip-info";default:return"priority-chip-default"}}function fe(e){switch(e){case"BA1":return"priority-badge-request";case"BA2":return"priority-badge-approve";case"BA3":return"priority-badge-reject";default:return"priority-badge-default"}}function me(e){if(!e)return"";const l=String(e);return l.length>=10?l.slice(0,10):l}async function ge(){if(ye.value){b.value=!0;try{const e=await i.A.get("/api/approvals/priority",{params:{page:y.value,size:L.value,keyword:f.value,state:m.value,orderBy:g.value,loginId:de.value,role:pe.value}}),l=e.data?.data||{},a=Array.isArray(l.rows)?l.rows:[];v.value=a,_.value=l.totalCount??0}catch(e){console.error("[PriorityApproval] loadList error:",e),v.value=[],_.value=0}finally{b.value=!1}}}function Ae(e){e<1||e>C.value||e!==y.value&&(y.value=e,ge())}function Be(){ne.value=!1}function Ee(e){if("BA3"===e.state&&e.has_newer_request){const l=v.value.find(l=>l.approval_code===e.newest_approval_code),a=l?.state||"";return se.value={reason:e.rejection_reason||"(등록된 반려 사유가 없습니다.)",newestApprovalCode:e.newest_approval_code||"",newestState:a},void(ne.value=!0)}we(e)}function we(e){l.push({name:"counsel-detail",params:{submitCode:e.submit_code},query:{role:ve.value}})}return(0,t.sV)(()=>{if(!ye.value)return alert("기관 관리자 및 시스템 관리자만 접근 가능합니다."),void l.push("/");ge()}),(e,l)=>((0,t.uX)(),(0,t.CE)("div",p,[d,(0,t.Lk)("div",c,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>f.value=e),class:"priority-input",placeholder:"이름/보호자/기관 검색",onKeyup:(0,r.jR)(be,["enter"])},null,40,k),[[r.Jo,f.value]]),(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>m.value=e),class:"priority-select",onChange:be},h,544),[[r.u1,m.value]]),(0,t.bo)((0,t.Lk)("select",{"onUpdate:modelValue":l[2]||(l[2]=e=>g.value=e),class:"priority-select",onChange:be},A,544),[[r.u1,g.value]])]),(0,t.Lk)("div",B,[b.value?((0,t.uX)(),(0,t.CE)("div",E,"불러오는 중...")):((0,t.uX)(),(0,t.CE)("table",w,[(0,t.Lk)("thead",null,[(0,t.Lk)("tr",null,[W,K,X,R,I,Le.value?((0,t.uX)(),(0,t.CE)("th",Q,"기관")):(0,t.Q3)("",!0),S,F,j,V])]),(0,t.Lk)("tbody",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(v.value,e=>((0,t.uX)(),(0,t.CE)("tr",{key:e.approval_code,onClick:l=>Ee(e),class:"priority-row"},[(0,t.Lk)("td",null,(0,o.v_)(e.approval_code),1),(0,t.Lk)("td",null,(0,o.v_)(e.child_name),1),(0,t.Lk)("td",null,(0,o.v_)(e.disability_type),1),(0,t.Lk)("td",null,(0,o.v_)(e.parent_name),1),(0,t.Lk)("td",null,(0,o.v_)(e.manager_name),1),Le.value?((0,t.uX)(),(0,t.CE)("td",U,(0,o.v_)(e.org_name),1)):(0,t.Q3)("",!0),(0,t.Lk)("td",null,(0,o.v_)(me(e.counsel_date)),1),(0,t.Lk)("td",null,[(0,t.Lk)("span",{class:(0,o.C4)(["priority-chip",Ce(e.priority_level)])},(0,o.v_)(he(e.priority_level)),3)]),(0,t.Lk)("td",null,[(0,t.Lk)("span",{class:(0,o.C4)(["priority-badge",fe(e.state)])},(0,o.v_)(he(e.state)),3)]),(0,t.Lk)("td",null,(0,o.v_)("BA1"!==e.state&&e.approval_date?me(e.approval_date):"-"),1)],8,q))),128)),0===v.value.length?((0,t.uX)(),(0,t.CE)("tr",P,[(0,t.Lk)("td",{class:"priority-empty",colspan:Le.value?10:9}," 데이터가 없습니다. ",8,x)])):(0,t.Q3)("",!0)])])),!b.value&&C.value>1?((0,t.uX)(),(0,t.CE)("div",z,[(0,t.Lk)("button",{class:"priority-page-btn",disabled:1===y.value,onClick:l[3]||(l[3]=e=>Ae(y.value-1))}," 이전 ",8,D),(0,t.Lk)("span",J,(0,o.v_)(y.value)+" / "+(0,o.v_)(C.value)+" (총 "+(0,o.v_)(_.value)+"건) ",1),(0,t.Lk)("button",{class:"priority-page-btn",disabled:y.value===C.value,onClick:l[4]||(l[4]=e=>Ae(y.value+1))}," 다음 ",8,M)])):(0,t.Q3)("",!0),ne.value?((0,t.uX)(),(0,t.CE)("div",{key:3,class:"priority-modal-backdrop",onClick:(0,r.D$)(Be,["self"])},[(0,t.Lk)("div",G,[H,(0,t.Lk)("div",N,[O,(0,t.Lk)("div",T,(0,o.v_)(se.value.reason),1)]),(0,t.Lk)("div",Y,[Z,(0,t.Lk)("div",ee,["BA1"===se.value.newestState?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.eW)(" 이 건은 현재 "),le,(0,t.eW)(" 상태입니다."),ae,(0,t.eW)(" 재승인 승인코드: ")],64)):"BA2"===se.value.newestState?((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.eW)(" 이 건은 현재 "),te,(0,t.eW)(" 입니다."),re,(0,t.eW)(" 최종 승인코드: ")],64)):"BA3"===se.value.newestState?((0,t.uX)(),(0,t.CE)(t.FK,{key:2},[(0,t.eW)(" 이 건은 현재도 "),oe,(0,t.eW)(" 입니다."),ue,(0,t.eW)(" 최신 승인코드: ")],64)):((0,t.uX)(),(0,t.CE)(t.FK,{key:3},[(0,t.eW)(" 이 건에는 이후 승인 이력이 있습니다."),ie,(0,t.eW)(" 최신 승인코드: ")],64)),(0,t.Lk)("strong",null,(0,o.v_)(se.value.newestApprovalCode||"-"),1)])]),(0,t.Lk)("div",{class:"priority-modal-actions"},[(0,t.Lk)("button",{class:"priority-modal-btn",onClick:Be}," 닫기 ")])])],8,$)):(0,t.Q3)("",!0)])]))}},se=a(6262);const ve=(0,se.A)(ne,[["__scopeId","data-v-4481bb52"]]);var pe=ve}}]);
//# sourceMappingURL=641.cb7a4a00.js.map