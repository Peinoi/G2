"use strict";(self["webpackChunkvue_material_dashboard_2"]=self["webpackChunkvue_material_dashboard_2"]||[]).push([[66],{66:function(a,e,l){l.r(e),l.d(e,{default:function(){return Ea}});l(3725),l(5019),l(2598);var s=l(641),t=l(2644),i=l(9841),n=l(5220),c=l(4335),v=l(6698);const u=a=>((0,s.Qi)("data-v-593a991d"),a=a(),(0,s.jt)(),a),o={class:"p-6 max-w-5xl mx-auto space-y-6"},r={class:"form-action"},d={key:0,class:"detail-card"},k={class:"flex justify-between items-center detail-header"},p=u(()=>(0,s.Lk)("div",null,[(0,s.Lk)("h2",{class:"text-2xl font-semibold"},"이벤트 신청 상세 내역")],-1)),_={class:"event-main-image"},f=["src"],L={key:1,class:"no-image"},m={class:"meta-card improved-meta"},b=u(()=>(0,s.Lk)("h5",{class:"meta-card-title"},"메인 이벤트 정보",-1)),h={class:"info-grid"},y=u(()=>(0,s.Lk)("div",{class:"info-label"},"이벤트명",-1)),g={class:"info-value"},w=u(()=>(0,s.Lk)("div",{class:"info-label"},"기관명",-1)),C={class:"info-value"},E=u(()=>(0,s.Lk)("div",{class:"info-label"},"매니저",-1)),A={class:"info-value"},x=u(()=>(0,s.Lk)("div",{class:"info-label"},"장소",-1)),X={class:"info-value"},K=u(()=>(0,s.Lk)("div",{class:"info-label"},"최대 참여자",-1)),j={class:"info-value"},I=u(()=>(0,s.Lk)("div",{class:"info-label"},"모집 기간",-1)),R={class:"info-value"},D=u(()=>(0,s.Lk)("div",{class:"info-label"},"진행 기간",-1)),Q={class:"info-value"},S={class:"content-block"},F=u(()=>(0,s.Lk)("div",{class:"content-title"},"이벤트 내용",-1)),N={class:"content-box whitespace-pre-line"},$={key:0,class:"detail-card sub-event-card"},W=u(()=>(0,s.Lk)("h2",{class:"text-xl font-semibold mb-4"},"신청한 세부 이벤트 정보",-1)),z={class:"sub-event-table"},O=u(()=>(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"세부이벤트코드"),(0,s.Lk)("th",null,"세부이벤트명"),(0,s.Lk)("th",null,"시행기간"),(0,s.Lk)("th",null,"모집인원")])],-1)),J={class:"meta-card"},Y=u(()=>(0,s.Lk)("h5",null,"자녀 정보",-1)),q={class:"info-grid child-info-grid"},M=u(()=>(0,s.Lk)("div",{class:"info-label"},"자녀명",-1)),V={class:"info-value"},B=u(()=>(0,s.Lk)("div",{class:"info-label"},"성별",-1)),G={class:"info-value"},H=u(()=>(0,s.Lk)("div",{class:"info-label"},"주민번호",-1)),P={class:"info-value"},T={class:"meta-card"},U=u(()=>(0,s.Lk)("h5",null,"신청자 정보",-1)),Z={class:"info-grid applicant-info-grid"},aa=u(()=>(0,s.Lk)("div",{class:"info-label"},"신청자명",-1)),ea={class:"info-value"},la=u(()=>(0,s.Lk)("div",{class:"info-label"},"주소",-1)),sa={class:"info-value"},ta=u(()=>(0,s.Lk)("div",{class:"info-label"},"소속기관",-1)),ia={class:"info-value"},na=u(()=>(0,s.Lk)("div",{class:"info-label"},"주민번호",-1)),ca={class:"info-value"},va=u(()=>(0,s.Lk)("div",{class:"info-label"},"전화번호",-1)),ua={class:"info-value"},oa=u(()=>(0,s.Lk)("div",{class:"info-label"},"이메일",-1)),ra={class:"info-value"},da={class:"block-card"},ka={class:"field-block"},pa=u(()=>(0,s.Lk)("div",{class:"field-label"},"첨부파일",-1)),_a={key:0},fa={class:"file-list"},La=["onClick"],ma={key:1,class:"text-xs text-gray-400"},ba=["src"],ha={key:1,class:"pt-4 border-t mt-2 space-y-3"},ya={class:"approve-actions"};var ga={__name:"EventMyApplyInfo",setup(a){const e=(0,n.lq)(),l=(0,n.rd)(),u=()=>{const a=localStorage.getItem("user");if(!a)return null;try{const e=JSON.parse(a);return e.role||null}catch{return null}},ga=(0,i.KR)(u()),wa=(0,i.KR)({}),Ca=(0,s.EW)(()=>"AA2"===ga.value),Ea=Number(e.params.applyCode||0),Aa=Number(e.params.eventCode||0),xa=(0,i.KR)({sub_events:[],attachments:[]}),Xa=(0,i.KR)(""),Ka=(0,i.KR)(!1),ja=(0,i.KR)(""),Ia=a=>{const e=a.original_filename.split(".").pop().toLowerCase();["jpg","jpeg","png","gif","webp"].includes(e)?ja.value=a.file_path:"pdf"!==e?window.location.href=a.file_path:window.open(a.file_path,"_blank")},Ra=()=>{ja.value=""},Da=a=>a?new Date(a).toISOString().slice(0,10):"",Qa=()=>{const a=localStorage.getItem("user");if(!a)return null;try{const e=JSON.parse(a);return e.user_code||null}catch{return null}},Sa=async()=>{try{const a=Qa(),e=await c.A.get(`/api/event/${Aa}`,{params:{user_code:a}});xa.value=e.data.data||{},Ka.value=!!xa.value.alreadyApplied;const l=xa.value.attachments.find(a=>/\.(jpg|jpeg|png|gif)$/i.test(a.original_filename));Xa.value=l?l.file_path:"",await(0,s.dY)()}catch(a){console.error("fetchEvent error:",a)}},Fa=(0,i.KR)([]),Na=async()=>{try{const a=Qa();if(!a)return void(Fa.value=[]);const e=await c.A.get("/api/event/applyList",{params:{user_code:a}}),l=e.data.data||[];Fa.value=l.filter(a=>"DD2"===a.apply_type&&Number(a.event_code)===Aa),console.log("신청한 세부 이벤트:",Fa.value)}catch(a){console.error("신청한 세부 이벤트 조회 실패:",a),Fa.value=[]}},$a=a=>{switch(a){case"DE1":return"status-pill--before";case"DE2":return"status-pill--done";case"DE4":return"status-pill--rejected";default:return""}},Wa=async()=>{try{const a=await c.A.get(`/api/event/attendanceList/${Ea}`);wa.value=a.data.data||{},await(0,s.dY)()}catch(a){console.error("fetchApply error:",a)}},za=async()=>{try{const a=await c.A.post(`/api/event/myApply/approve/${Ea}`);a.data.success?(alert("승인되었습니다."),await Sa(),await Wa(),console.log("applyInfo after approve:",wa.value)):alert(a.data.message||"승인 실패")}catch(a){console.error(a),alert("서버 오류: "+(a.message||""))}},Oa=async()=>{try{const a=await c.A.post(`/api/event/myApply/reject/${Ea}`);a.data.success?(alert("취소 처리되었습니다."),await Sa(),await Wa()):alert(a.data.message||"취소 실패")}catch(a){console.error(a),alert("서버 오류: "+(a.message||""))}},Ja=()=>l.back();return(0,s.sV)(async()=>{await Sa(),await Wa(),await Na()}),(a,e)=>((0,s.uX)(),(0,s.CE)("section",o,[(0,s.Lk)("div",r,[(0,s.bF)(v.A,{color:"dark",size:"sm",variant:"outlined",onClick:Ja},{default:(0,s.k6)(()=>[(0,s.eW)(" ← 목록으로 ")]),_:1})]),wa.value?((0,s.uX)(),(0,s.CE)("div",d,[(0,s.Lk)("header",k,[p,Ca.value?((0,s.uX)(),(0,s.CE)("span",{key:0,class:(0,t.C4)(["status-pill",$a(wa.value.apply_status)])},(0,t.v_)(wa.value.apply_status_name),3)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",_,[Xa.value?((0,s.uX)(),(0,s.CE)("img",{key:0,src:Xa.value,alt:"대표 이미지"},null,8,f)):((0,s.uX)(),(0,s.CE)("div",L,"이미지 없음"))]),(0,s.Lk)("div",m,[b,(0,s.Lk)("div",h,[y,(0,s.Lk)("div",g,(0,t.v_)(xa.value.event_name),1),w,(0,s.Lk)("div",C,(0,t.v_)(xa.value.org_name),1),E,(0,s.Lk)("div",A,(0,t.v_)(xa.value.main_manager_name),1),x,(0,s.Lk)("div",X,(0,t.v_)(xa.value.event_location),1),K,(0,s.Lk)("div",j,(0,t.v_)(xa.value.max_participants),1),I,(0,s.Lk)("div",R,(0,t.v_)(Da(xa.value.recruit_start_date))+" ~ "+(0,t.v_)(Da(xa.value.recruit_end_date)),1),D,(0,s.Lk)("div",Q,(0,t.v_)(Da(xa.value.event_start_date))+" ~ "+(0,t.v_)(Da(xa.value.event_end_date)),1)])]),(0,s.Lk)("div",S,[F,(0,s.Lk)("div",N,(0,t.v_)(xa.value.event_content),1)]),Fa.value.length?((0,s.uX)(),(0,s.CE)("div",$,[W,(0,s.Lk)("table",z,[O,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Fa.value,a=>((0,s.uX)(),(0,s.CE)("tr",{key:a.sub_event_code},[(0,s.Lk)("td",null,(0,t.v_)(a.sub_event_code),1),(0,s.Lk)("td",null,(0,t.v_)(a.sub_event_name),1),(0,s.Lk)("td",null,(0,t.v_)(Da(a.sub_event_start_date))+" ~ "+(0,t.v_)(Da(a.sub_event_end_date)),1),(0,s.Lk)("td",null,(0,t.v_)(a.sub_recruit_count),1)]))),128))])])])):(0,s.Q3)("",!0),(0,s.Lk)("div",J,[Y,(0,s.Lk)("div",q,[M,(0,s.Lk)("div",V,(0,t.v_)(wa.value.child_name),1),B,(0,s.Lk)("div",G,(0,t.v_)(wa.value.child_gender_name),1),H,(0,s.Lk)("div",P,(0,t.v_)(wa.value.child_ssn),1)])]),(0,s.Lk)("div",T,[U,(0,s.Lk)("div",Z,[aa,(0,s.Lk)("div",ea,(0,t.v_)(wa.value.applicant_name),1),la,(0,s.Lk)("div",sa,(0,t.v_)(wa.value.applicant_address),1),ta,(0,s.Lk)("div",ia,(0,t.v_)(wa.value.applicant_org_name),1),na,(0,s.Lk)("div",ca,(0,t.v_)(wa.value.applicant_ssn),1),va,(0,s.Lk)("div",ua,(0,t.v_)(wa.value.applicant_phone),1),oa,(0,s.Lk)("div",ra,(0,t.v_)(wa.value.applicant_email),1)])]),(0,s.Lk)("div",da,[(0,s.Lk)("div",ka,[pa,xa.value.attachments?.length?((0,s.uX)(),(0,s.CE)("div",_a,[(0,s.Lk)("ul",fa,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(xa.value.attachments,a=>((0,s.uX)(),(0,s.CE)("li",{key:a.server_filename},[(0,s.Lk)("span",{class:"file-name",onClick:e=>Ia(a)},(0,t.v_)(a.original_filename),9,La)]))),128))])])):((0,s.uX)(),(0,s.CE)("div",ma," 첨부된 파일이 없습니다. "))]),ja.value?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"preview-modal",onClick:Ra},[(0,s.Lk)("img",{src:ja.value,class:"preview-img"},null,8,ba)])):(0,s.Q3)("",!0)])])):(0,s.Q3)("",!0),Ca.value?((0,s.uX)(),(0,s.CE)("div",ha,[(0,s.Lk)("div",ya,[(0,s.bF)(v.A,{color:"dark",size:"sm",class:"px-4",onClick:za},{default:(0,s.k6)(()=>[(0,s.eW)(" 승인 ")]),_:1}),(0,s.bF)(v.A,{color:"dark",size:"sm",class:"px-4",onClick:Oa},{default:(0,s.k6)(()=>[(0,s.eW)(" 취소 ")]),_:1})])])):(0,s.Q3)("",!0)]))}},wa=l(6262);const Ca=(0,wa.A)(ga,[["__scopeId","data-v-593a991d"]]);var Ea=Ca}}]);
//# sourceMappingURL=66.0c1f251c.js.map