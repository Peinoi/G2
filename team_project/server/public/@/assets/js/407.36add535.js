"use strict";(self["webpackChunkvue_material_dashboard_2"]=self["webpackChunkvue_material_dashboard_2"]||[]).push([[407],{407:function(e,a,l){l.r(a),l.d(a,{default:function(){return Qe}});l(8743),l(3725),l(1339);var t=l(641),s=l(2644),r=l(9841),i=l(5220),n=l(4335),u=l(6698),c=l(6571),o=l(2798);const d=e=>((0,t.Qi)("data-v-68795700"),e=e(),(0,t.jt)(),e),v={class:"p-6 max-w-5xl mx-auto"},m={class:"form-action"},k={class:"flex items-center gap-2"},p={class:"detail-card"},f={class:"flex justify-between items-start detail-header"},C=d(()=>(0,t.Lk)("div",null,[(0,t.Lk)("h2",{class:"text-2xl font-semibold"},"지원결과 상세")],-1)),b={key:0,class:"text-sm text-gray-500 py-6"},L={key:1,class:"text-sm text-red-500 py-6"},y={class:"meta-card"},g={class:"meta-grid"},h={class:"meta-item"},_=d(()=>(0,t.Lk)("span",{class:"meta-label"},"지원자",-1)),w={class:"meta-value"},E={class:"meta-item"},x=d(()=>(0,t.Lk)("span",{class:"meta-label"},"보호자",-1)),D={class:"meta-value"},X={class:"meta-item"},A=d(()=>(0,t.Lk)("span",{class:"meta-label"},"담당자",-1)),S={class:"meta-value"},W={class:"meta-item"},N=d(()=>(0,t.Lk)("span",{class:"meta-label"},"장애유형",-1)),F={class:"meta-value"},K={class:"meta-item"},R=d(()=>(0,t.Lk)("span",{class:"meta-label"},"우선순위",-1)),q={class:"meta-value"},$={class:"meta-item"},j=d(()=>(0,t.Lk)("span",{class:"meta-label"},"계획작성일",-1)),B={class:"meta-value"},z={class:"meta-item"},Q=d(()=>(0,t.Lk)("span",{class:"meta-label"},"실제 진행기간",-1)),I={class:"meta-value"},T=d(()=>(0,t.Lk)("span",{class:"mx-1"},"~",-1)),U={key:0,class:"info-card muted-info"},M=d(()=>(0,t.Lk)("strong",null,"임시 저장",-1)),O=d(()=>(0,t.Lk)("br",null,null,-1)),V=d(()=>(0,t.Lk)("strong",null,"작성 전",-1)),Y=d(()=>(0,t.Lk)("br",null,null,-1)),G={class:"block-card"},H=d(()=>(0,t.Lk)("h3",{class:"block-title"},"메인 결과",-1)),J={class:"field-block"},P=d(()=>(0,t.Lk)("div",{class:"field-label"},"계획했던 목표",-1)),Z={class:"field-value"},ee={class:"field-block"},ae=d(()=>(0,t.Lk)("div",{class:"field-label"},"결과 내용 (일반용)",-1)),le={class:"field-value whitespace-pre-line"},te={key:0,class:"field-block"},se=d(()=>(0,t.Lk)("div",{class:"field-label"},"결과 내용 (관리자용)",-1)),re={class:"field-value whitespace-pre-line"},ie={key:1,class:"field-block mt-3"},ne=d(()=>(0,t.Lk)("div",{class:"field-label"},"첨부 파일",-1)),ue={key:0},ce={class:"mt-1 text-xs text-gray-700 space-y-1"},oe=["href"],de={key:1,class:"text-xs text-gray-400"},ve={class:"space-y-4 mt-4"},me=d(()=>(0,t.Lk)("h3",{class:"font-semibold text-lg"},"추가 결과",-1)),ke={class:"flex justify-between items-center text-sm mb-2 border-b border-gray-200 pb-2"},pe={class:"font-medium"},fe={class:"field-block"},Ce=d(()=>(0,t.Lk)("div",{class:"field-label"},"계획했던 목표",-1)),be={class:"field-value"},Le={class:"field-block"},ye=d(()=>(0,t.Lk)("div",{class:"field-label"},"결과 내용 (일반용)",-1)),ge={class:"field-value whitespace-pre-line"},he={key:0,class:"field-block"},_e=d(()=>(0,t.Lk)("div",{class:"field-label"},"결과 내용 (관리자용)",-1)),we={class:"field-value whitespace-pre-line"},Ee={key:1,class:"text-sm text-gray-500"},xe={key:0,class:"pt-4 border-t mt-2 space-y-3"},De={key:0,class:"rejection-card"},Xe=d(()=>(0,t.Lk)("div",{class:"font-semibold mb-1 text-sm"},"반려 이력",-1)),Ae={class:"mb-1"},Se={class:"font-medium"},We=d(()=>(0,t.Lk)("div",{class:"font-medium"},"사유:",-1)),Ne={class:"whitespace-pre-line mt-1"},Fe={class:"approve-actions"},Ke={key:1,class:"modal-overlay"},Re={class:"modal-container"},qe=d(()=>(0,t.Lk)("h3",{class:"text-lg font-semibold mb-3"},"반려 사유 입력",-1)),$e={class:"modal-actions"};var je={__name:"ResultDetail",setup(e){const a=(0,i.lq)(),l=(0,i.rd)(),d=(0,o.n)();d.reload();const je=Number(a.params.resultCode||0),Be=Number(a.query.submitCode||0),ze=Number(a.query.planCode||0),Qe=(0,t.EW)(()=>Number(a.query.role||0)),Ie=(0,r.KR)(""),Te=(0,t.EW)(()=>"CD1"===Ie.value||"CD3"===Ie.value),Ue=(0,r.KR)({childName:"",guardianName:"",assigneeName:"",disabilityType:"",planSubmitAt:"",level:""}),Me=(0,t.EW)(()=>{const e=Ue.value.planSubmitAt;return e?String(e).slice(0,10):"-"}),Oe=(0,r.KR)({resultDate:"",actualStart:"",actualEnd:"",goal:"",publicContent:"",privateContent:""}),Ve=(0,r.KR)([]),Ye=(0,r.KR)([]),Ge=(0,r.KR)(!1),He=(0,r.KR)(""),Je=(0,r.KR)(!1),Pe=(0,r.KR)(""),Ze=(0,r.KR)({reason:"",date:""}),ea=(0,t.EW)(()=>{const e=Ze.value?.date;return e?String(e).slice(0,10):"-"});function aa(){const e=new Date;return e.toISOString().slice(0,10)}async function la(){if(!Be)return;const{data:e}=await n.A.get(`/api/result/${Be}`);if(!e?.success||!e.result)throw new Error(e?.message||"지원결과 기본 정보를 찾을 수 없습니다.");const a=e.result;Ue.value={childName:a.childName||"",guardianName:a.guardianName||"",assigneeName:a.assigneeName||"-",disabilityType:a.disabilityType||"-",planSubmitAt:a.planSubmitAt||"",level:a.level||""}}async function ta(){const{data:e}=await n.A.get(`/api/result/detail/${je}`);if(!e?.success||!e.result)throw new Error(e?.message||"지원결과 정보를 찾을 수 없습니다.");const a=e.result;Ie.value=a.status||"",Oe.value={resultDate:a.main?.resultDate?String(a.main.resultDate).slice(0,10):aa(),actualStart:a.main?.actualStart||"",actualEnd:a.main?.actualEnd||"",goal:a.main?.goal||"",publicContent:a.main?.publicContent||"",privateContent:a.main?.privateContent||""},Ve.value=(a.items||[]).map((e,a)=>({id:e.resultItemCode||Date.now()+a,goal:e.goal||"",publicContent:e.publicContent||"",privateContent:e.privateContent||""}))||[],Ye.value=(a.attachments||[]).map(e=>({attachCode:e.attachCode,originalFilename:e.originalFilename,url:e.url}))||[]}async function sa(){try{const{data:e}=await n.A.get(`/api/result/${je}/rejection-reason`);if(e?.success&&e.result){const a=e.result;Ze.value={reason:a.rejection_reason||"",date:a.rejection_date||a.approval_date||""}}else Ze.value={reason:"",date:""}}catch(e){console.error("[loadRejectionInfo]",e),Ze.value={reason:"",date:""}}}function ra(e){const a=(e||"").toUpperCase();switch(a){case"BB1":return"긴급";case"BB2":return"중점";case"BB3":return"계획";default:return"-"}}function ia(e){const a=(e||"").toString().toUpperCase();switch(a){case"CD1":return"임시저장";case"CD3":return"작성전";case"CD4":return"검토전";case"CD5":return"검토완료";case"CD6":return"재승인요청";case"CD7":return"반려";default:return e||"-"}}function na(e){const a=(e||"").toString().toUpperCase();switch(a){case"CD1":case"CD3":return"p-gray";case"CD4":return"p-yellow";case"CD5":return"p-green";case"CD6":return"p-orange";case"CD7":return"p-red";default:return"p-gray"}}function ua(){if(!ze)return;const e=Qe.value||"",a=`/plans/detail/${ze}?submitCode=${Be}${e?`&role=${e}`:""}`;window.open(a,"_blank")}function ca(){l.back()}function oa(){je&&l.push({name:"result-edit",params:{resultCode:je},query:Be?{submitCode:Be,role:Qe.value}:{role:Qe.value}})}function da(){Be&&l.push({name:"result-write",params:{submitcode:Be},query:{role:Qe.value}})}async function va(){try{const e=d.userCode;if(!e)return void alert("로그인 정보가 없어 승인자를 기록할 수 없습니다. 다시 로그인해주세요.");const{data:a}=await n.A.post(`/api/result/${je}/approve`,{processorCode:e});a?.success?(alert("지원결과가 승인되었습니다."),await ta()):alert(a.message||"승인 처리 실패")}catch(e){console.error(e),alert("서버 오류: "+(e.response?.data?.message||e.message))}}function ma(){Pe.value="",Je.value=!0}async function ka(){if(Pe.value.trim())try{const{data:e}=await n.A.post(`/api/result/${je}/reject`,{reason:Pe.value});e?.success?(alert("지원결과가 반려되었습니다."),Je.value=!1,await ta()):alert(e.message||"반려 처리 실패")}catch(e){console.error(e),alert("서버 오류: "+(e.response?.data?.message||e.message))}else alert("반려 사유를 입력해주세요.")}function pa(){Je.value=!1}return(0,t.sV)(async()=>{try{if(Ge.value=!0,!je)throw new Error("resultCode가 없습니다. (라우터 params 확인 필요)");await ta(),Be&&await la(),3===Qe.value&&await sa()}catch(e){console.error(e),He.value=e.message||"지원결과 조회 중 오류가 발생했습니다."}finally{Ge.value=!1}}),(e,a)=>((0,t.uX)(),(0,t.CE)("section",v,[(0,t.Lk)("div",m,[(0,t.bF)(u.A,{color:"dark",size:"sm",variant:"outlined",onClick:ca},{default:(0,t.k6)(()=>[(0,t.eW)(" ← 목록으로 ")]),_:1}),(0,t.Lk)("div",k,[2!==Qe.value||"CD1"!==Ie.value&&"CD3"!==Ie.value?2===Qe.value&&"CD4"===Ie.value?((0,t.uX)(),(0,t.Wv)(u.A,{key:1,color:"dark",size:"sm",onClick:oa},{default:(0,t.k6)(()=>[(0,t.eW)(" 수정하기 ")]),_:1})):2===Qe.value&&"CD7"===Ie.value?((0,t.uX)(),(0,t.Wv)(u.A,{key:2,color:"dark",size:"sm",onClick:oa},{default:(0,t.k6)(()=>[(0,t.eW)(" 재수정하기 ")]),_:1})):(0,t.Q3)("",!0):((0,t.uX)(),(0,t.Wv)(u.A,{key:0,color:"dark",size:"sm",onClick:da},{default:(0,t.k6)(()=>[(0,t.eW)(" 작성하기 ")]),_:1}))])]),(0,t.Lk)("div",p,[(0,t.Lk)("header",f,[C,(0,t.Lk)("span",{class:(0,s.C4)(["status-pill",na(Ie.value)])},(0,s.v_)(ia(Ie.value)),3)]),Ge.value?((0,t.uX)(),(0,t.CE)("div",b," 지원결과 정보를 불러오는 중입니다... ")):He.value?((0,t.uX)(),(0,t.CE)("div",L,(0,s.v_)(He.value),1)):((0,t.uX)(),(0,t.CE)(t.FK,{key:2},[(0,t.Lk)("div",y,[(0,t.Lk)("div",g,[(0,t.Lk)("div",h,[_,(0,t.Lk)("span",w,(0,s.v_)(Ue.value.childName||"본인"),1)]),(0,t.Lk)("div",E,[x,(0,t.Lk)("span",D,(0,s.v_)(Ue.value.guardianName||"-"),1)]),(0,t.Lk)("div",X,[A,(0,t.Lk)("span",S,(0,s.v_)(Ue.value.assigneeName||"-"),1)]),(0,t.Lk)("div",W,[N,(0,t.Lk)("span",F,(0,s.v_)(Ue.value.disabilityType||"-"),1)]),(0,t.Lk)("div",K,[R,(0,t.Lk)("span",q,(0,s.v_)(ra(Ue.value.level)||"-"),1)]),(0,t.Lk)("div",$,[j,(0,t.Lk)("span",B,[(0,t.bF)(u.A,{color:"dark",size:"sm",onClick:ua},{default:(0,t.k6)(()=>[(0,t.eW)((0,s.v_)(Me.value),1)]),_:1})])]),(0,t.Lk)("div",z,[Q,(0,t.Lk)("span",I,[(0,t.Lk)("span",null,(0,s.v_)(Oe.value.actualStart||"미지정"),1),T,(0,t.Lk)("span",null,(0,s.v_)(Oe.value.actualEnd||"미지정"),1)])])])]),Te.value?((0,t.uX)(),(0,t.CE)("div",U,["CD1"===Ie.value?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.eW)(" 이 지원결과는 "),M,(0,t.eW)(" 상태입니다."),O],64)):((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.eW)(" 이 지원결과는 아직 "),V,(0,t.eW)(" 상태입니다."),Y],64))])):((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.Lk)("div",G,[H,(0,t.Lk)("div",J,[P,(0,t.Lk)("div",Z,(0,s.v_)(Oe.value.goal||"-"),1)]),(0,t.Lk)("div",ee,[ae,(0,t.Lk)("div",le,(0,s.v_)(Oe.value.publicContent||"-"),1)]),1!==Qe.value?((0,t.uX)(),(0,t.CE)("div",te,[se,(0,t.Lk)("div",re,(0,s.v_)(Oe.value.privateContent||"-"),1)])):(0,t.Q3)("",!0),1!==Qe.value?((0,t.uX)(),(0,t.CE)("div",ie,[ne,Ye.value.length?((0,t.uX)(),(0,t.CE)("div",ue,[(0,t.Lk)("ul",ce,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(Ye.value,e=>((0,t.uX)(),(0,t.CE)("li",{key:e.attachCode,class:"file-row"},[(0,t.Lk)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",class:"file-link"},(0,s.v_)(e.originalFilename),9,oe)]))),128))])])):((0,t.uX)(),(0,t.CE)("div",de," 첨부된 파일이 없습니다. "))])):(0,t.Q3)("",!0)]),(0,t.Lk)("div",ve,[me,Ve.value.length?((0,t.uX)(!0),(0,t.CE)(t.FK,{key:0},(0,t.pI)(Ve.value,(e,a)=>((0,t.uX)(),(0,t.CE)("div",{key:e.id||a,class:"block-card"},[(0,t.Lk)("div",ke,[(0,t.Lk)("div",pe,"결과 #"+(0,s.v_)(a+1),1)]),(0,t.Lk)("div",fe,[Ce,(0,t.Lk)("div",be,(0,s.v_)(e.goal||"-"),1)]),(0,t.Lk)("div",Le,[ye,(0,t.Lk)("div",ge,(0,s.v_)(e.publicContent||"-"),1)]),1!==Qe.value?((0,t.uX)(),(0,t.CE)("div",he,[_e,(0,t.Lk)("div",we,(0,s.v_)(e.privateContent||"-"),1)])):(0,t.Q3)("",!0)]))),128)):((0,t.uX)(),(0,t.CE)("p",Ee,"추가 결과가 없습니다."))])],64))],64))]),3!==Qe.value||"CD4"!==Ie.value&&"CD6"!==Ie.value?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("div",xe,[Ze.value&&Ze.value.reason?((0,t.uX)(),(0,t.CE)("div",De,[Xe,(0,t.Lk)("div",Ae,[(0,t.eW)(" 반려일자: "),(0,t.Lk)("span",Se,(0,s.v_)(ea.value),1)]),(0,t.Lk)("div",null,[We,(0,t.Lk)("p",Ne,(0,s.v_)(Ze.value.reason),1)])])):(0,t.Q3)("",!0),(0,t.Lk)("div",Fe,[(0,t.bF)(u.A,{color:"dark",size:"sm",class:"px-4",onClick:va},{default:(0,t.k6)(()=>[(0,t.eW)(" 승인 ")]),_:1}),(0,t.bF)(u.A,{color:"dark",size:"sm",class:"px-4",onClick:ma},{default:(0,t.k6)(()=>[(0,t.eW)(" 반려 ")]),_:1})])])),Je.value?((0,t.uX)(),(0,t.CE)("div",Ke,[(0,t.Lk)("div",Re,[qe,(0,t.bF)(c.A,{id:"result-reject-reason",variant:"outline",rows:4,placeholder:"반려 사유를 입력하세요...",value:Pe.value,onInput:a[0]||(a[0]=e=>Pe.value=e.target.value)},null,8,["value"]),(0,t.Lk)("div",$e,[(0,t.bF)(u.A,{color:"dark",size:"sm",onClick:pa},{default:(0,t.k6)(()=>[(0,t.eW)(" 취소 ")]),_:1}),(0,t.bF)(u.A,{color:"dark",size:"sm",onClick:ka},{default:(0,t.k6)(()=>[(0,t.eW)(" 반려 ")]),_:1})])])])):(0,t.Q3)("",!0)]))}},Be=l(6262);const ze=(0,Be.A)(je,[["__scopeId","data-v-68795700"]]);var Qe=ze},6571:function(e,a,l){l.d(a,{A:function(){return d}});var t=l(641),s=l(2644);const r=["id","rows","name","value","placeholder","isRequired","disabled"];function i(e,a,l,i,n,u){return(0,t.uX)(),(0,t.CE)("div",{class:(0,s.C4)(["input-group",`input-group-${l.variant} ${u.getStatus(l.error,l.success)}`])},[(0,t.Lk)("textarea",{id:l.id,class:"form-control",rows:l.rows,name:l.name,value:l.value,placeholder:l.placeholder,isRequired:l.isRequired,disabled:l.disabled},null,8,r)],2)}var n=l(5685),u={name:"MaterialTextarea",props:{variant:{type:String,default:"outline"},id:{type:String,required:!0},name:{type:String,default:""},value:{type:String,default:""},placeholder:{type:String,default:"Your text here..."},isRequired:Boolean,disabled:{type:Boolean,default:!1},rows:{type:Number,default:5},success:{type:Boolean,default:!1},error:{type:Boolean,default:!1}},mounted(){(0,n.A)()},methods:{getStatus:(e,a)=>{let l;return l=a?"is-valid":e?"is-invalid":null,l}}},c=l(6262);const o=(0,c.A)(u,[["render",i]]);var d=o}}]);
//# sourceMappingURL=407.36add535.js.map