{"version":3,"file":"@/assets/js/614.2924d941.js","mappings":"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","sources":["webpack://vue-material-dashboard-2/./src/components/MaterialTextarea.vue","webpack://vue-material-dashboard-2/./src/components/MaterialTextarea.vue?6270","webpack://vue-material-dashboard-2/./src/views/CounselEdit.vue","webpack://vue-material-dashboard-2/./src/views/CounselEdit.vue?29b5"],"sourcesContent":["<template>\r\n  <div\r\n    class=\"input-group\"\r\n    :class=\"`input-group-${variant} ${getStatus(error, success)}`\"\r\n  >\r\n    <textarea\r\n      :id=\"id\"\r\n      class=\"form-control\"\r\n      :rows=\"rows\"\r\n      :name=\"name\"\r\n      :value=\"value\"\r\n      :placeholder=\"placeholder\"\r\n      :isRequired=\"isRequired\"\r\n      :disabled=\"disabled\"\r\n    ></textarea>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport setMaterialInput from \"@/assets/js/material-input.js\";\r\n\r\nexport default {\r\n  name: \"MaterialTextarea\",\r\n  props: {\r\n    variant: {\r\n      type: String,\r\n      default: \"outline\",\r\n    },\r\n    id: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n    name: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    value: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n    placeholder: {\r\n      type: String,\r\n      default: \"Your text here...\",\r\n    },\r\n    isRequired: Boolean,\r\n    disabled: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    rows: {\r\n      type: Number,\r\n      default: 5,\r\n    },\r\n    success: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    error: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n  mounted() {\r\n    setMaterialInput();\r\n  },\r\n  methods: {\r\n    getStatus: (error, success) => {\r\n      let isValidValue;\r\n\r\n      if (success) {\r\n        isValidValue = \"is-valid\";\r\n      } else if (error) {\r\n        isValidValue = \"is-invalid\";\r\n      } else {\r\n        isValidValue = null;\r\n      }\r\n\r\n      return isValidValue;\r\n    },\r\n  },\r\n};\r\n</script>\r\n","import { render } from \"./MaterialTextarea.vue?vue&type=template&id=204b2d53\"\nimport script from \"./MaterialTextarea.vue?vue&type=script&lang=js\"\nexport * from \"./MaterialTextarea.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n  <section class=\"p-6\">\r\n    <div class=\"page-shell space-y-6\">\r\n      <!-- ÏÉÅÎã® ÌÉÄÏù¥ÌãÄ -->\r\n      <header class=\"page-header\">\r\n        <div>\r\n          <h2 class=\"page-title text-2xl md:text-3xl font-bold tracking-tight\">\r\n            ÏÉÅÎã¥ÏÑú ÏàòÏ†ï\r\n          </h2>\r\n        </div>\r\n\r\n        <div class=\"header-actions\">\r\n          <MaterialButton color=\"dark\" size=\"sm\" @click=\"goBack\">\r\n            ‚Üê Î™©Î°ùÏúºÎ°ú\r\n          </MaterialButton>\r\n        </div>\r\n      </header>\r\n\r\n      <!-- Î°úÎî©/ÏóêÎü¨ -->\r\n      <div v-if=\"loading\" class=\"text-sm text-gray-500\">Î∂àÎü¨Ïò§Îäî Ï§ë...</div>\r\n      <div v-else-if=\"error\" class=\"text-sm text-red-600\">{{ error }}</div>\r\n\r\n      <!-- Î≥∏Î¨∏ -->\r\n      <template v-else>\r\n        <!-- Í∏∞Î≥∏Ï†ïÎ≥¥ Ïπ¥Îìú -->\r\n        <div class=\"meta-card\">\r\n          <div class=\"meta-grid\">\r\n            <!-- 1. ÏßÄÏõêÏûê -->\r\n            <div class=\"meta-item\">\r\n              <span class=\"meta-label\">ÏßÄÏõêÏûê</span>\r\n              <span class=\"meta-value\">\r\n                {{ submitInfo.childName || \"Î≥∏Ïù∏\" }}\r\n              </span>\r\n            </div>\r\n\r\n            <!-- 2. Î≥¥Ìò∏Ïûê -->\r\n            <div class=\"meta-item\">\r\n              <span class=\"meta-label\">Î≥¥Ìò∏Ïûê</span>\r\n              <span class=\"meta-value\">\r\n                {{ submitInfo.guardianName || \"-\" }}\r\n              </span>\r\n            </div>\r\n\r\n            <!-- 3. Îã¥ÎãπÏûê -->\r\n            <div class=\"meta-item\">\r\n              <span class=\"meta-label\">Îã¥ÎãπÏûê</span>\r\n              <span class=\"meta-value\">\r\n                {{ submitInfo.assigneeName || \"-\" }}\r\n              </span>\r\n            </div>\r\n\r\n            <!-- 4. Ïû•Ïï†Ïú†Ìòï -->\r\n            <div class=\"meta-item\">\r\n              <span class=\"meta-label\">Ïû•Ïï†Ïú†Ìòï</span>\r\n              <span class=\"meta-value\">\r\n                {{ submitInfo.disabilityType || \"-\" }}\r\n              </span>\r\n            </div>\r\n\r\n            <!-- 5. Ï°∞ÏÇ¨ÏßÄ Ï†úÏ∂úÏùº -->\r\n            <div class=\"meta-item\">\r\n              <span class=\"meta-label\">Ï°∞ÏÇ¨ÏßÄ Ï†úÏ∂úÏùº</span>\r\n              <span class=\"meta-value\">\r\n                <MaterialButton\r\n                  color=\"dark\"\r\n                  size=\"sm\"\r\n                  @click=\"openSubmissionDetail\"\r\n                >\r\n                  {{ formattedSubmitAt }}\r\n                </MaterialButton>\r\n              </span>\r\n            </div>\r\n\r\n            <!-- 6. ÏÉÅÎã¥Ïùº -->\r\n            <div class=\"meta-item\">\r\n              <span class=\"meta-label\">ÏÉÅÎã¥Ïùº</span>\r\n              <span class=\"meta-value\">\r\n                <input\r\n                  type=\"date\"\r\n                  v-model=\"mainForm.counselDate\"\r\n                  class=\"input\"\r\n                />\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Î©îÏù∏ ÏÉÅÎã¥ Ïπ¥Îìú (Ï†úÎ™© / ÎÇ¥Ïö© / Ï≤®Î∂Ä) -->\r\n        <div class=\"card-block space-y-4\">\r\n          <!-- ÏÉÅÎã¥ Ï†úÎ™© -->\r\n          <div>\r\n            <label class=\"block text-sm mb-1 font-medium\">ÏÉÅÎã¥ Ï†úÎ™©</label>\r\n            <MaterialInput\r\n              id=\"edit-title\"\r\n              variant=\"static\"\r\n              size=\"default\"\r\n              v-model=\"mainForm.title\"\r\n              placeholder=\"ÏÉÅÎã¥ Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî\"\r\n            />\r\n          </div>\r\n\r\n          <!-- ÏÉÅÎã¥ ÎÇ¥Ïö© -->\r\n          <div>\r\n            <label class=\"block text-sm mb-1 font-medium\">ÏÉÅÎã¥ ÎÇ¥Ïö©</label>\r\n            <MaterialTextarea\r\n              id=\"edit-content\"\r\n              variant=\"outline\"\r\n              :rows=\"5\"\r\n              placeholder=\"ÏÉÅÎã¥ ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî...\"\r\n              :value=\"mainForm.content\"\r\n              @input=\"(e) => (mainForm.content = e.target.value)\"\r\n            />\r\n          </div>\r\n\r\n          <!-- Í∏∞Ï°¥ Ï≤®Î∂Ä ÌååÏùº Î™©Î°ù -->\r\n          <div>\r\n            <span class=\"block text-sm font-medium mb-1\">Í∏∞Ï°¥ Ï≤®Î∂Ä ÌååÏùº</span>\r\n\r\n            <div v-if=\"attachments.length\">\r\n              <ul class=\"mt-1 text-xs text-gray-700 space-y-1\">\r\n                <li\r\n                  v-for=\"file in attachments\"\r\n                  :key=\"file.attachCode\"\r\n                  class=\"space-y-0.5\"\r\n                >\r\n                  <!-- ÌååÏùº Ïù¥Î¶Ñ + Î≤ÑÌäºÏùÑ Ìïú Ï§ÑÏóê -->\r\n                  <div class=\"flex items-center justify-between gap-2\">\r\n                    <a\r\n                      :href=\"file.url\"\r\n                      target=\"_blank\"\r\n                      class=\"flex-1 min-w-0 truncate underline\"\r\n                      :class=\"{\r\n                        'line-through text-gray-400':\r\n                          removedAttachmentCodes.includes(file.attachCode),\r\n                      }\"\r\n                    >\r\n                      {{ file.originalFilename }}\r\n                    </a>\r\n\r\n                    <button\r\n                      type=\"button\"\r\n                      class=\"shrink-0 px-2 py-0.5 border rounded text-[11px] text-gray-600 hover:bg-gray-100\"\r\n                      @click=\"toggleRemoveAttachment(file.attachCode)\"\r\n                    >\r\n                      {{\r\n                        removedAttachmentCodes.includes(file.attachCode)\r\n                          ? \"Ï∑®ÏÜå\"\r\n                          : \"ÏÇ≠Ï†ú\"\r\n                      }}\r\n                    </button>\r\n                  </div>\r\n\r\n                  <!-- ÏÇ≠Ï†ú ÏòàÏ†ï ÌëúÏãúÎßå ÏïÑÎûò Ï§ÑÏóê ÏûëÍ≤å -->\r\n                  <div\r\n                    v-if=\"removedAttachmentCodes.includes(file.attachCode)\"\r\n                    class=\"text-[11px] text-red-500 pl-1\"\r\n                  >\r\n                    ÏÇ≠Ï†ú ÏòàÏ†ï\r\n                  </div>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n\r\n            <div v-else class=\"text-xs text-gray-400\">\r\n              Í∏∞Ï°¥Ïóê Ï≤®Î∂ÄÎêú ÌååÏùºÏù¥ ÏóÜÏäµÎãàÎã§.\r\n            </div>\r\n          </div>\r\n\r\n          <!-- ÏÉàÎ°ú Ï∂îÍ∞ÄÌï† Ï≤®Î∂Ä ÌååÏùº -->\r\n          <div>\r\n            <label class=\"block text-sm mb-1 font-medium\">Ï≤®Î∂Ä ÌååÏùº Ï∂îÍ∞Ä</label>\r\n            <input\r\n              ref=\"fileInputRef\"\r\n              type=\"file\"\r\n              multiple\r\n              @change=\"onNewFilesChange\"\r\n              class=\"file-input\"\r\n            />\r\n            <p class=\"mt-1 text-xs text-gray-500\">\r\n              * Ïó¨Îü¨ Í∞ú ÌååÏùºÏùÑ Ìïú Î≤àÏóê ÏÑ†ÌÉùÌïòÍ±∞ÎÇò, ÎÇòÎà†ÏÑú Ïó¨Îü¨ Î≤à ÏÑ†ÌÉùÌï† Ïàò\r\n              ÏûàÏäµÎãàÎã§.\r\n            </p>\r\n\r\n            <!-- ÏÉàÎ°ú ÏÑ†ÌÉùÌïú ÌååÏùº Î™©Î°ù -->\r\n            <ul\r\n              v-if=\"newFiles.length\"\r\n              class=\"mt-2 text-xs text-gray-700 space-y-1\"\r\n            >\r\n              <li\r\n                v-for=\"(file, idx) in newFiles\"\r\n                :key=\"file.name + '_' + file.lastModified + '_' + idx\"\r\n                class=\"flex items-center justify-between gap-2\"\r\n              >\r\n                <span class=\"truncate\">\r\n                  ‚Ä¢ {{ file.name }} ({{ (file.size / 1024).toFixed(1) }} KB)\r\n                </span>\r\n                <button\r\n                  type=\"button\"\r\n                  class=\"shrink-0 px-2 py-0.5 border rounded text-[11px] text-gray-600 hover:bg-gray-100\"\r\n                  @click=\"removeNewFile(idx)\"\r\n                >\r\n                  ÏÇ≠Ï†ú\r\n                </button>\r\n              </li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ù Ïπ¥ÎìúÎì§ -->\r\n        <div\r\n          v-for=\"record in records\"\r\n          :key=\"record.id\"\r\n          class=\"record-card space-y-4\"\r\n        >\r\n          <div class=\"record-header\">\r\n            <h4 class=\"font-medium text-sm\">Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ù</h4>\r\n\r\n            <MaterialButton\r\n              color=\"dark\"\r\n              size=\"sm\"\r\n              variant=\"outlined\"\r\n              @click=\"removeRecord(record.id)\"\r\n            >\r\n              Ï†úÍ±∞\r\n            </MaterialButton>\r\n          </div>\r\n\r\n          <div>\r\n            <label class=\"block text-sm mb-1 font-medium\">ÏÉÅÎã¥Ïùº: </label>\r\n            <input type=\"date\" v-model=\"record.counselDate\" class=\"input\" />\r\n          </div>\r\n\r\n          <div>\r\n            <label class=\"block text-sm mb-1 font-medium\">ÏÉÅÎã¥ Ï†úÎ™©</label>\r\n            <MaterialInput\r\n              :id=\"`record-title-${record.id}`\"\r\n              variant=\"static\"\r\n              size=\"default\"\r\n              v-model=\"record.title\"\r\n              placeholder=\"ÏÉÅÎã¥ Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label class=\"block text-sm mb-1 font-medium\">ÏÉÅÎã¥ ÎÇ¥Ïö©</label>\r\n            <MaterialTextarea\r\n              :id=\"`record-content-${record.id}`\"\r\n              variant=\"outline\"\r\n              :rows=\"3\"\r\n              placeholder=\"ÏÉÅÎã¥ ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî...\"\r\n              :value=\"record.content\"\r\n              @input=\"(e) => (record.content = e.target.value)\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <!-- ÌïòÎã® Ïï°ÏÖò Î∞î -->\r\n        <div class=\"action-bar\">\r\n          <div class=\"left-actions\">\r\n            <MaterialButton color=\"dark\" size=\"sm\" @click=\"goBack\">\r\n              ÏàòÏ†ï Ï∑®ÏÜå\r\n            </MaterialButton>\r\n\r\n            <MaterialButton color=\"dark\" size=\"sm\" @click=\"addRecord\">\r\n              + ÏÉÅÎã¥ Í∏∞Î°ù Ï∂îÍ∞Ä\r\n            </MaterialButton>\r\n          </div>\r\n\r\n          <div class=\"right-actions\">\r\n            <!-- Ïö∞ÏÑ†ÏàúÏúÑ (ÏΩîÎìú BB1/BB2/BB3 ÏÇ¨Ïö©) -->\r\n            <select v-model=\"priority\" class=\"input priority-select\">\r\n              <option value=\"BB1\">Í∏¥Í∏â</option>\r\n              <option value=\"BB2\">Ï§ëÏ†ê</option>\r\n              <option value=\"BB3\">Í≥ÑÌöç</option>\r\n            </select>\r\n\r\n            <MaterialButton color=\"dark\" size=\"sm\" @click=\"submitAll\">\r\n              {{ isResubmit ? \"Ïû¨ÏûëÏÑ± ÏôÑÎ£å\" : \"ÏàòÏ†ï ÏôÑÎ£å\" }}\r\n            </MaterialButton>\r\n          </div>\r\n        </div>\r\n      </template>\r\n    </div>\r\n  </section>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from \"vue\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nimport axios from \"axios\";\r\n\r\nimport MaterialButton from \"@/components/MaterialButton.vue\";\r\nimport MaterialTextarea from \"@/components/MaterialTextarea.vue\";\r\nimport MaterialInput from \"@/components/MaterialInput.vue\";\r\n\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst submitCode = Number(route.params.submitCode);\r\n\r\nconst user = JSON.parse(localStorage.getItem(\"user\") || \"{}\");\r\nconst modifier = Number(user.user_code || 0);\r\n\r\nconst loading = ref(false);\r\nconst error = ref(\"\");\r\n\r\nconst status = ref(\"\"); // ÏÉÅÎã¥ ÏÉÅÌÉú (CB2/CB3/CB4/CB5 ...)\r\n\r\n// CB4(Î∞òÎ†§)Ïù∏ Í≤ΩÏö∞ Ïû¨ÏûëÏÑ± Î™®Îìú\r\nconst isResubmit = computed(() => status.value === \"CB4\");\r\n\r\n// Í∏∞Î≥∏ Ï†ïÎ≥¥ / Î©îÏù∏ Ìèº / Í∏∞Î°ù / Ïö∞ÏÑ†ÏàúÏúÑ\r\nconst submitInfo = ref({\r\n  name: \"\",\r\n  ssnFront: \"\",\r\n  submitAt: \"\",\r\n});\r\n\r\nconst formattedSubmitAt = computed(() => {\r\n  const v = submitInfo.value.submitAt;\r\n  return v ? v.slice(0, 10) : \"-\";\r\n});\r\n\r\nconst mainForm = ref({\r\n  counselDate: \"\",\r\n  title: \"\",\r\n  content: \"\",\r\n});\r\n\r\nconst records = ref([]);\r\n// üîπ Ïö∞ÏÑ†ÏàúÏúÑ: ÏΩîÎìú Í∞í ÏÇ¨Ïö© (BB1/BB2/BB3)\r\nconst priority = ref(\"BB3\");\r\n\r\n// Í∏∞Ï°¥ Ï≤®Î∂ÄÌååÏùº Î™©Î°ù\r\nconst attachments = ref([]);\r\n\r\n// ÏÇ≠Ï†ú ÎåÄÏÉÅ attach_code Î™©Î°ù\r\nconst removedAttachmentCodes = ref([]);\r\n\r\n// ÏÉàÎ°ú Ï∂îÍ∞ÄÌïòÎäî ÌååÏùºÎì§\r\nconst newFiles = ref([]);\r\nconst fileInputRef = ref(null);\r\n\r\n// ÏÉÅÎã¥ ÏÉÅÏÑ∏ Î∂àÎü¨Ïò§Í∏∞\r\nasync function loadData() {\r\n  loading.value = true;\r\n  error.value = \"\";\r\n  try {\r\n    const { data } = await axios.get(`/api/counsel/${submitCode}`);\r\n\r\n    if (!data?.success || !data.result) {\r\n      throw new Error(data?.message || \"ÏÉÅÎã¥ Ï†ïÎ≥¥Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.\");\r\n    }\r\n\r\n    const res = data.result;\r\n\r\n    submitInfo.value = res.submit_info || submitInfo.value;\r\n\r\n    mainForm.value = {\r\n      counselDate: res.main?.counsel_date || \"\",\r\n      title: res.main?.title || \"\",\r\n      content: res.main?.content || \"\",\r\n    };\r\n\r\n    // üîπ Î∞±ÏóîÎìúÏóêÏÑú ÎÇ¥Î†§Ï£ºÎäî priority ÏΩîÎìú Í∑∏ÎåÄÎ°ú ÏÇ¨Ïö© (ÏóÜÏúºÎ©¥ BB3: Í≥ÑÌöç)\r\n    priority.value = res.priority || \"BB3\";\r\n    status.value = res.status || \"\";\r\n\r\n    records.value =\r\n      (res.details || []).map((d, idx) => ({\r\n        id: Date.now() + idx,\r\n        counselDate: d.counsel_date || \"\",\r\n        title: d.title || \"\",\r\n        content: d.content || \"\",\r\n      })) || [];\r\n\r\n    attachments.value = res.attachments || [];\r\n  } catch (e) {\r\n    console.error(e);\r\n    error.value = e.message || \"ÏÉÅÎã¥ Ï†ïÎ≥¥ Ï°∞Ìöå Ï§ë Ïò§Î•ò\";\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n}\r\n\r\nfunction openSubmissionDetail() {\r\n  window.open(`/survey/submission/${submitCode}`, \"_blank\");\r\n}\r\nfunction goBack() {\r\n  router.push({ name: \"counselList\" });\r\n}\r\n\r\nfunction addRecord() {\r\n  records.value.push({\r\n    id: Date.now(),\r\n    counselDate: \"\",\r\n    title: \"\",\r\n    content: \"\",\r\n  });\r\n}\r\n\r\nfunction removeRecord(id) {\r\n  records.value = records.value.filter((r) => r.id !== id);\r\n}\r\n\r\n// Í∏∞Ï°¥ Ï≤®Î∂Ä ÏÇ≠Ï†ú ÌÜ†Í∏Ä\r\nfunction toggleRemoveAttachment(attachCode) {\r\n  const idx = removedAttachmentCodes.value.indexOf(attachCode);\r\n  if (idx === -1) {\r\n    removedAttachmentCodes.value.push(attachCode);\r\n  } else {\r\n    removedAttachmentCodes.value.splice(idx, 1);\r\n  }\r\n}\r\n\r\n// ÏÉà ÌååÏùº ÏÑ†ÌÉù (ÎàÑÏ†Å)\r\nfunction onNewFilesChange(e) {\r\n  const files = Array.from(e.target.files || []);\r\n\r\n  const newOnes = files.filter(\r\n    (f) =>\r\n      !newFiles.value.some(\r\n        (ex) =>\r\n          ex.name === f.name &&\r\n          ex.size === f.size &&\r\n          ex.lastModified === f.lastModified\r\n      )\r\n  );\r\n\r\n  newFiles.value = [...newFiles.value, ...newOnes];\r\n\r\n  if (e.target) {\r\n    e.target.value = \"\";\r\n  }\r\n}\r\n\r\n// ÏÉà ÌååÏùº Í∞úÎ≥Ñ ÏÇ≠Ï†ú\r\nfunction removeNewFile(index) {\r\n  newFiles.value.splice(index, 1);\r\n}\r\n\r\n// Ïú†Ìö®ÏÑ±\r\nfunction validate() {\r\n  // üîπ Î©îÏù∏ ÏÉÅÎã¥Ïùº ÌïÑÏàò\r\n  if (!mainForm.value.counselDate) return \"ÏÉÅÎã¥ÏùºÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.\";\r\n  if (!mainForm.value.title.trim()) return \"ÏÉÅÎã¥ Ï†úÎ™©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.\";\r\n  if (!mainForm.value.content.trim()) return \"ÏÉÅÎã¥ ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.\";\r\n\r\n  // üîπ Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ùÎì§ÎèÑ ÏÉÅÎã¥Ïùº/Ï†úÎ™©/ÎÇ¥Ïö© ÌïÑÏàò\r\n  for (const r of records.value) {\r\n    if (!r.counselDate) return \"Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ùÏùò ÏÉÅÎã¥ÏùºÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.\";\r\n    if (!r.title.trim()) return \"Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ùÏùò Ï†úÎ™©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.\";\r\n    if (!r.content.trim()) return \"Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ùÏùò ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.\";\r\n  }\r\n  return null;\r\n}\r\n\r\n// Ï†ÄÏû•(ÏàòÏ†ï ÏôÑÎ£å) ‚Üí multipartÎ°ú Ï†ÑÏÜ°\r\nasync function submitAll() {\r\n  const err = validate();\r\n  if (err) {\r\n    alert(err);\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const formJson = {\r\n      submitCode,\r\n      priority: priority.value, // üîπ ÏΩîÎìú Í∑∏ÎåÄÎ°ú Ï†ÑÏÜ° (BB1/BB2/BB3)\r\n      mainForm: mainForm.value,\r\n      records: records.value,\r\n      removeAttachmentCodes: removedAttachmentCodes.value,\r\n      modifier,\r\n      requesterCode: modifier,\r\n    };\r\n\r\n    const formData = new FormData();\r\n    formData.append(\"formJson\", JSON.stringify(formJson));\r\n\r\n    newFiles.value.forEach((file) => {\r\n      formData.append(\"mainFiles\", file);\r\n    });\r\n\r\n    const res = await axios.post(\"/api/counsel/new\", formData, {\r\n      headers: {\r\n        \"Content-Type\": \"multipart/form-data\",\r\n      },\r\n    });\r\n\r\n    if (res.data?.success) {\r\n      if (isResubmit.value) {\r\n        alert(\"Ïû¨ÏûëÏÑ±Ïù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§. ÏäπÏù∏ÏöîÏ≤≠Ïù¥ Îã§Ïãú Ïò¨ÎùºÍ∞îÏäµÎãàÎã§.\");\r\n      } else {\r\n        alert(\"ÏÉÅÎã¥ ÏàòÏ†ïÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.\");\r\n      }\r\n      router.push({ name: \"counselList\" });\r\n    } else {\r\n      alert(res.data.message || \"ÏàòÏ†ï Ïã§Ìå®\");\r\n    }\r\n  } catch (e) {\r\n    console.error(e);\r\n    alert(\"ÏÑúÎ≤Ñ Ïò§Î•ò: \" + (e.response?.data?.message || e.message));\r\n  }\r\n}\r\n\r\n// Ï≤´ Î°úÎî©Ïóê Îç∞Ïù¥ÌÑ∞ Î∂àÎü¨Ïò§Í∏∞\r\nloadData();\r\n</script>\r\n\r\n<style scoped>\r\nsection {\r\n  color: #111827;\r\n}\r\n\r\n/* ÌéòÏù¥ÏßÄ Ìè≠ ÌÜµÏùº */\r\n.page-shell {\r\n  max-width: 960px;\r\n  margin: 0 auto;\r\n}\r\n\r\n/* Ìó§Îçî */\r\n.page-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  gap: 1rem;\r\n  margin-bottom: 0.8em;\r\n}\r\n\r\n.page-title {\r\n  letter-spacing: -0.02em;\r\n}\r\n\r\n.header-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n/* Í∏∞Î≥∏Ï†ïÎ≥¥ Ïπ¥Îìú */\r\n.meta-card {\r\n  border-radius: 0.75rem;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #f9fafb;\r\n  padding: 0.9rem 1rem;\r\n  font-size: 0.85rem;\r\n}\r\n\r\n.meta-bottom {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 1.5rem;\r\n  margin-top: 0.25rem;\r\n}\r\n\r\n/* Î©îÏù∏ ÏÉÅÎã¥ Ïπ¥Îìú */\r\n.card-block {\r\n  border-radius: 0.9rem;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #ffffff;\r\n  box-shadow: 0 8px 18px rgba(15, 23, 42, 0.04);\r\n  padding: 1.25rem 1.1rem;\r\n}\r\n\r\n/* Í≥µÌÜµ Ïù∏Ìíã (date, select) */\r\n.input {\r\n  border-radius: 0.375rem;\r\n  border: 1px solid #d1d5db;\r\n  padding: 0.35rem 0.6rem;\r\n  font-size: 0.875rem;\r\n  outline: none;\r\n  min-width: 8rem;\r\n}\r\n\r\n.input:focus {\r\n  border-color: #111827;\r\n}\r\n\r\n/* ÌååÏùº Ïù∏Ìíã */\r\n.file-input {\r\n  display: block;\r\n  width: 100%;\r\n  font-size: 0.8rem;\r\n}\r\n\r\n/* ÌïòÎã® Ïï°ÏÖò Î∞î */\r\n.action-bar {\r\n  margin-top: 10px;\r\n  padding-top: 0.5rem;\r\n  border-top: 1px solid #e5e7eb;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  gap: 1rem;\r\n}\r\n\r\n.left-actions,\r\n.right-actions {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 0.5rem;\r\n}\r\n\r\n.priority-select {\r\n  min-width: 5.5rem;\r\n}\r\n\r\n/* Ï∂îÍ∞Ä ÏÉÅÎã¥ Í∏∞Î°ù Ïπ¥Îìú */\r\n.record-card {\r\n  border-radius: 0.8rem;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #ffffff;\r\n  padding: 1.1rem 1rem;\r\n  box-shadow: 0 6px 14px rgba(15, 23, 42, 0.04);\r\n  margin-top: 8px;\r\n}\r\n\r\n.record-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n/* ===== Í∏∞Î≥∏Ï†ïÎ≥¥ Í∑∏Î¶¨Îìú ===== */\r\n.meta-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\r\n  gap: 0.75rem 1rem;\r\n}\r\n\r\n.meta-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.meta-item .meta-label {\r\n  font-size: 0.78rem;\r\n  color: #6b7280;\r\n  margin-bottom: 0.15rem;\r\n}\r\n\r\n.meta-item .meta-value {\r\n  font-size: 0.9rem;\r\n  color: #111827;\r\n  font-weight: 500;\r\n}\r\n</style>\r\n","import script from \"./CounselEdit.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./CounselEdit.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./CounselEdit.vue?vue&type=style&index=0&id=0473b349&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0473b349\"]])\n\nexport default __exports__"],"names":["_createElementBlock","class","_normalizeClass","$props","variant","$options","getStatus","error","success","_createElementVNode","id","rows","name","value","placeholder","isRequired","disabled","props","type","String","default","required","Boolean","Number","mounted","setMaterialInput","methods","isValidValue","__exports__","render","route","useRoute","router","useRouter","submitCode","params","user","JSON","parse","localStorage","getItem","modifier","user_code","loading","ref","status","isResubmit","computed","submitInfo","ssnFront","submitAt","formattedSubmitAt","v","slice","mainForm","counselDate","title","content","records","priority","attachments","removedAttachmentCodes","newFiles","fileInputRef","async","loadData","data","axios","get","result","Error","message","res","submit_info","main","counsel_date","details","map","d","idx","Date","now","e","console","openSubmissionDetail","window","open","goBack","push","addRecord","removeRecord","filter","r","toggleRemoveAttachment","attachCode","indexOf","splice","onNewFilesChange","files","Array","from","target","newOnes","f","some","ex","size","lastModified","removeNewFile","index","validate","trim","submitAll","err","alert","formJson","removeAttachmentCodes","requesterCode","formData","FormData","append","stringify","forEach","file","post","headers","response"],"sourceRoot":""}