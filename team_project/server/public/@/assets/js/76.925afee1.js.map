{"version":3,"file":"@/assets/js/76.925afee1.js","mappings":"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","sources":["webpack://vue-material-dashboard-2/./src/views/SurveyEdit.vue","webpack://vue-material-dashboard-2/./src/views/SurveyEdit.vue?0f78"],"sourcesContent":["<template>\r\n  <section class=\"p-6 max-w-5xl mx-auto\">\r\n    <!-- Ìó§Îçî -->\r\n    <header class=\"mb-2 flex items-center justify-between header-row\">\r\n      <h2 class=\"text-2xl font-semibold\">Ï°∞ÏÇ¨ÏßÄ ÏàòÏ†ï</h2>\r\n\r\n      <MaterialButton color=\"dark\" size=\"sm\" variant=\"outlined\" @click=\"goBack\">\r\n        ‚Üê Î™©Î°ù\r\n      </MaterialButton>\r\n    </header>\r\n\r\n    <!-- ÏÉÅÌÉú -->\r\n    <div v-if=\"loading\">Î∂àÎü¨Ïò§Îäî Ï§ë...</div>\r\n    <div v-else-if=\"error\" class=\"text-red-600\">{{ error }}</div>\r\n\r\n    <!-- Îπà ÏÉÅÌÉú -->\r\n    <div v-else-if=\"sections.length === 0\" class=\"empty-state\">\r\n      <div class=\"text-gray-600 mb-2\">ÏïÑÏßÅ Î∂àÎü¨Ïò¨ Ìï≠Î™©Ïù¥ ÏóÜÏäµÎãàÎã§.</div>\r\n      <p class=\"text-xs text-gray-400\">\r\n        ÌÖúÌîåÎ¶ø Î≤ÑÏ†ÑÏùÑ Îã§Ïãú ÏÑ†ÌÉùÌï¥ÏÑú ÏßÑÏûÖÌï¥ Ï£ºÏÑ∏Ïöî.\r\n      </p>\r\n    </div>\r\n\r\n    <!-- ÏàòÏ†ï Ìèº -->\r\n    <div v-else class=\"space-y-6\">\r\n      <!-- ÏÑπÏÖò -->\r\n      <div v-for=\"(sec, sIndex) in sections\" :key=\"sec.id\" class=\"section-card\">\r\n        <!-- ÏÑπÏÖò Ìó§Îçî -->\r\n        <div class=\"section-header\">\r\n          <h3 class=\"section-title\">Ìï≠Î™© #{{ sIndex + 1 }}</h3>\r\n          <div class=\"space-x-2\">\r\n            <MaterialButton\r\n              color=\"dark\"\r\n              size=\"sm\"\r\n              variant=\"outlined\"\r\n              @click=\"addSubsection(sIndex)\"\r\n            >\r\n              ÏÑ∏Î∂ÄÌï≠Î™© Ï∂îÍ∞Ä\r\n            </MaterialButton>\r\n            <MaterialButton\r\n              color=\"dark\"\r\n              size=\"sm\"\r\n              variant=\"outlined\"\r\n              @click=\"removeSection(sIndex)\"\r\n            >\r\n              ÏÇ≠Ï†ú\r\n            </MaterialButton>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- ÏÑπÏÖò Í∏∞Î≥∏ Ï†ïÎ≥¥ -->\r\n        <div class=\"grid md:grid-cols-2 gap-3 mb-4\">\r\n          <div>\r\n            <MaterialInput\r\n              v-model=\"sec.title\"\r\n              id=\"sec-title-{{ sIndex }}\"\r\n              label=\"Ìï≠Î™© Ï†úÎ™©\"\r\n              variant=\"static\"\r\n            />\r\n          </div>\r\n          <div>\r\n            <MaterialInput\r\n              v-model=\"sec.desc\"\r\n              id=\"sec-desc-{{ sIndex }}\"\r\n              label=\"Ìï≠Î™© ÏÑ§Î™Ö\"\r\n              variant=\"static\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <!-- ÏÑ∏Î∂ÄÌï≠Î™©Îì§ -->\r\n        <div class=\"space-y-4\">\r\n          <div\r\n            v-for=\"(sub, subIndex) in sec.subsections\"\r\n            :key=\"sub.id\"\r\n            class=\"subsection-card\"\r\n          >\r\n            <!-- ÏÑúÎ∏å Ìó§Îçî -->\r\n            <div class=\"sub-header\">\r\n              <div class=\"font-medium text-sm\">\r\n                ÏÑ∏Î∂ÄÌï≠Î™© #{{ subIndex + 1 }}\r\n              </div>\r\n              <div class=\"space-x-2\">\r\n                <MaterialButton\r\n                  color=\"dark\"\r\n                  size=\"sm\"\r\n                  variant=\"outlined\"\r\n                  @click=\"addItem(sIndex, subIndex)\"\r\n                >\r\n                  ÏßàÎ¨∏ Ï∂îÍ∞Ä\r\n                </MaterialButton>\r\n                <MaterialButton\r\n                  color=\"dark\"\r\n                  size=\"sm\"\r\n                  variant=\"outlined\"\r\n                  @click=\"removeSubsection(sIndex, subIndex)\"\r\n                >\r\n                  ÏÇ≠Ï†ú\r\n                </MaterialButton>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- ÏÑúÎ∏å Í∏∞Î≥∏ Ï†ïÎ≥¥ -->\r\n            <div class=\"grid md:grid-cols-2 gap-3 mb-3\">\r\n              <div>\r\n                <MaterialInput\r\n                  v-model=\"sub.title\"\r\n                  :id=\"`sub-title-${sec.id}-${sub.id}`\"\r\n                  label=\"ÏÑ∏Î∂ÄÌï≠Î™© Ï†úÎ™©\"\r\n                  variant=\"static\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <MaterialInput\r\n                  v-model=\"sub.desc\"\r\n                  :id=\"`sub-desc-${sec.id}-${sub.id}`\"\r\n                  label=\"ÏÑ∏Î∂ÄÌï≠Î™© ÏÑ§Î™Ö\"\r\n                  variant=\"static\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <!-- ÏßàÎ¨∏Îì§ -->\r\n            <div class=\"space-y-3\">\r\n              <div\r\n                v-for=\"(it, iIndex) in sub.items\"\r\n                :key=\"it.id\"\r\n                class=\"question-card\"\r\n              >\r\n                <div class=\"question-header\">\r\n                  <div class=\"font-medium text-sm text-gray-800\">\r\n                    ÏßàÎ¨∏ #{{ iIndex + 1 }}\r\n                  </div>\r\n                  <MaterialButton\r\n                    color=\"dark\"\r\n                    size=\"sm\"\r\n                    variant=\"outlined\"\r\n                    @click=\"removeItem(sIndex, subIndex, iIndex)\"\r\n                  >\r\n                    ÏÇ≠Ï†ú\r\n                  </MaterialButton>\r\n                </div>\r\n\r\n                <div class=\"grid md:grid-cols-3 gap-3\">\r\n                  <div>\r\n                    <label class=\"block text-xs font-medium text-gray-500 mb-1\">\r\n                      ÏßàÎ¨∏ ÌÉÄÏûÖ\r\n                    </label>\r\n                    <select\r\n                      v-model=\"it.type\"\r\n                      class=\"w-full input-basic\"\r\n                      @change=\"onChangeType(it)\"\r\n                    >\r\n                      <option value=\"TEXT\">Îã®ÎãµÌòï</option>\r\n                      <option value=\"TEXTAREA\">ÏÑúÏà†Ìòï</option>\r\n                      <option value=\"RADIO\">Îã®Ïùº ÏÑ†ÌÉù</option>\r\n                      <option value=\"CHECKBOX\">Îã§Ï§ë ÏÑ†ÌÉù</option>\r\n                    </select>\r\n                  </div>\r\n\r\n                  <div class=\"md:col-span-2\">\r\n                    <MaterialInput\r\n                      v-model=\"it.text\"\r\n                      :id=\"`q-text-${it.id}`\"\r\n                      label=\"ÏßàÎ¨∏ ÎÇ¥Ïö©\"\r\n                      variant=\"static\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n                <!-- ÌïÑÏàò Ïó¨Î∂Ä: Ïä§ÏúÑÏπò -->\r\n                <div class=\"mt-2\">\r\n                  <MaterialSwitch\r\n                    :id=\"`required-${it.id}`\"\r\n                    name=\"required\"\r\n                    :checked=\"it.required\"\r\n                    labelClass=\"text-xs text-gray-700\"\r\n                    @change=\"toggleRequired(it, $event)\"\r\n                  >\r\n                    ÌïÑÏàò ÏßàÎ¨∏\r\n                  </MaterialSwitch>\r\n                </div>\r\n\r\n                <!-- ÏòµÏÖò (ÎùºÎ≤®Îßå ÏÇ¨Ïö©) -->\r\n                <div v-if=\"isChoiceType(it.type)\" class=\"mt-4 border-t pt-3\">\r\n                  <div class=\"flex items-center justify-between mb-2\">\r\n                    <div class=\"text-xs font-medium text-gray-700\">\r\n                      ÏòµÏÖò ({{ it.options.length }})\r\n                    </div>\r\n                    <MaterialButton\r\n                      color=\"dark\"\r\n                      size=\"sm\"\r\n                      variant=\"outlined\"\r\n                      @click=\"addOption(sIndex, subIndex, iIndex)\"\r\n                    >\r\n                      + ÏòµÏÖò Ï∂îÍ∞Ä\r\n                    </MaterialButton>\r\n                  </div>\r\n\r\n                  <div class=\"space-y-2\">\r\n                    <div\r\n                      v-for=\"(op, oIndex) in it.options\"\r\n                      :key=\"op.id\"\r\n                      class=\"option-row\"\r\n                    >\r\n                      <!-- Î≤àÌò∏ -->\r\n                      <div class=\"text-[11px] text-gray-500\">\r\n                        #{{ oIndex + 1 }}\r\n                      </div>\r\n\r\n                      <!-- ÎùºÎ≤® -->\r\n                      <div>\r\n                        <MaterialInput\r\n                          v-model=\"op.label\"\r\n                          :id=\"`op-label-${it.id}-${op.id}`\"\r\n                          label=\"ÎùºÎ≤®\"\r\n                          variant=\"static\"\r\n                        />\r\n                      </div>\r\n\r\n                      <!-- ÏÇ≠Ï†ú Î≤ÑÌäº -->\r\n                      <div class=\"text-right\">\r\n                        <MaterialButton\r\n                          color=\"dark\"\r\n                          size=\"sm\"\r\n                          variant=\"outlined\"\r\n                          @click=\"\r\n                            removeOption(sIndex, subIndex, iIndex, oIndex)\r\n                          \"\r\n                        >\r\n                          ÏÇ≠Ï†ú\r\n                        </MaterialButton>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <!-- /question-card -->\r\n            </div>\r\n          </div>\r\n          <!-- /subsection-card -->\r\n        </div>\r\n      </div>\r\n      <!-- /section-card -->\r\n\r\n      <!-- ÌïòÎã® Ïª®Ìä∏Î°§ -->\r\n      <div class=\"form-actions\">\r\n        <MaterialButton\r\n          color=\"dark\"\r\n          size=\"sm\"\r\n          variant=\"outlined\"\r\n          @click=\"addSection\"\r\n        >\r\n          + Ìï≠Î™© Ï∂îÍ∞Ä\r\n        </MaterialButton>\r\n\r\n        <MaterialButton\r\n          color=\"dark\"\r\n          size=\"sm\"\r\n          :disabled=\"saving\"\r\n          @click=\"saveEdit\"\r\n        >\r\n          {{ saving ? \"Ï†ÄÏû• Ï§ë...\" : \"ÏàòÏ†ï Ï†ÄÏû•\" }}\r\n        </MaterialButton>\r\n      </div>\r\n    </div>\r\n  </section>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, computed } from \"vue\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nimport axios from \"axios\";\r\nimport MaterialButton from \"@/components/MaterialButton.vue\";\r\nimport MaterialInput from \"@/components/MaterialInput.vue\";\r\nimport MaterialSwitch from \"@/components/MaterialSwitch.vue\";\r\n\r\nconst router = useRouter();\r\nconst route = useRoute();\r\n\r\n/** ÎùºÏö∞Ìä∏ ÌååÎùºÎØ∏ÌÑ∞: Ïã†Í∑ú (:templateVerCode) ÎòêÎäî Íµ¨(:id) Îëò Îã§ ÌóàÏö© */\r\nconst templateVerCode = computed(\r\n  () => route.params.templateVerCode ?? route.params.id\r\n);\r\n\r\nconst loading = ref(false);\r\nconst saving = ref(false);\r\nconst error = ref(null);\r\nconst sections = ref([]);\r\n\r\n/** Ï†ÄÏû• Ïãú ÏÇ¨Ïö©Ìï† Î©îÏù¥Ï†Ä ÌÖúÌîåÎ¶ø ÏΩîÎìú (Î∞±ÏóîÎìú ÏùëÎãµÏóêÏÑú ÌöçÎìù) */\r\nconst templateCodeForUpdate = ref(null);\r\n\r\n/* ----------------- Ïú†Ìã∏ ----------------- */\r\nconst newId = (() => {\r\n  let id = 1;\r\n  return () => id++;\r\n})();\r\n\r\nconst isChoiceType = (t) =>\r\n  [\"RADIO\", \"CHECKBOX\"].includes(String(t).toUpperCase());\r\n\r\n/* ----------------- UI Ï°∞Ïûë ----------------- */\r\nfunction addSection() {\r\n  sections.value.push({ id: newId(), title: \"\", desc: \"\", subsections: [] });\r\n}\r\n\r\nfunction removeSection(i) {\r\n  sections.value.splice(i, 1);\r\n}\r\n\r\nfunction addSubsection(sIdx) {\r\n  sections.value[sIdx].subsections.push({\r\n    id: newId(),\r\n    title: \"\",\r\n    desc: \"\",\r\n    items: [],\r\n  });\r\n}\r\n\r\nfunction removeSubsection(sIdx, subIdx) {\r\n  sections.value[sIdx].subsections.splice(subIdx, 1);\r\n}\r\n\r\nfunction addItem(sIdx, subIdx) {\r\n  sections.value[sIdx].subsections[subIdx].items.push({\r\n    id: newId(),\r\n    type: \"TEXT\",\r\n    text: \"\",\r\n    required: false,\r\n    options: [],\r\n  });\r\n}\r\n\r\nfunction removeItem(sIdx, subIdx, iIdx) {\r\n  sections.value[sIdx].subsections[subIdx].items.splice(iIdx, 1);\r\n}\r\n\r\nfunction onChangeType(item) {\r\n  if (isChoiceType(item.type)) {\r\n    if (!Array.isArray(item.options)) item.options = [];\r\n    if (item.options.length === 0)\r\n      item.options.push({ id: newId(), label: \"\" }); // üî• value Ï†úÍ±∞\r\n  } else {\r\n    item.options = [];\r\n  }\r\n}\r\n\r\nfunction addOption(sIdx, subIdx, iIdx) {\r\n  sections.value[sIdx].subsections[subIdx].items[iIdx].options.push({\r\n    id: newId(),\r\n    label: \"\",\r\n  });\r\n}\r\n\r\nfunction removeOption(sIdx, subIdx, iIdx, oIdx) {\r\n  sections.value[sIdx].subsections[subIdx].items[iIdx].options.splice(oIdx, 1);\r\n}\r\n\r\n// Ïä§ÏúÑÏπò ÌÜ†Í∏Ä (change Ïù¥Î≤§Ìä∏Îäî ÏïàÏ™Ω inputÏóêÏÑú Î≤ÑÎ∏îÎßÅÎê®)\r\nfunction toggleRequired(item, event) {\r\n  const checked = event?.target?.checked ?? !item.required;\r\n  item.required = checked;\r\n}\r\n\r\n/* ----------------- Îç∞Ïù¥ÌÑ∞ Î°úÎìú ----------------- */\r\nonMounted(async () => {\r\n  loading.value = true;\r\n  try {\r\n    if (!templateVerCode.value)\r\n      throw new Error(\"ÏÑ∏Î∂ÄÎ≤ÑÏ†Ñ ÏΩîÎìú(templateVerCode)Í∞Ä ÏóÜÏäµÎãàÎã§.\");\r\n\r\n    const url = `/api/survey/detail/ver/${templateVerCode.value}`;\r\n    const { data } = await axios.get(url);\r\n    const payload = data?.result ?? data;\r\n\r\n    // Ï†ÄÏû• Ïãú ÏÇ¨Ïö©Ìï† Î©îÏù¥Ï†Ä ÌÖúÌîåÎ¶ø ÏΩîÎìú ÌôïÎ≥¥\r\n    templateCodeForUpdate.value = payload?.template_code ?? null;\r\n\r\n    const srcSections = payload.sections || [];\r\n    sections.value = srcSections.map((s) => ({\r\n      id: newId(),\r\n      title: s.section_title ?? \"\",\r\n      desc: s.section_desc ?? \"\",\r\n      subsections: (s.subsections || []).map((sub) => ({\r\n        id: newId(),\r\n        title: sub.subsection_title ?? \"\",\r\n        desc: sub.subsection_desc ?? \"\",\r\n        items: (sub.items || []).map((it) => ({\r\n          id: newId(),\r\n          type: (it.question_type || \"TEXT\").toUpperCase(),\r\n          text: it.question_text ?? \"\",\r\n          required: it.is_required === \"Y\",\r\n          // üî• Í∏∞Ï°¥ option_valuesÏóêÏÑú labelÎßå Í∞ÄÏ†∏Ïò¥ (valueÎäî Î¨¥Ïãú)\r\n          options: (Array.isArray(it.option_values)\r\n            ? it.option_values\r\n            : []\r\n          ).map((op, idx) => ({\r\n            id: newId(),\r\n            label: op.label ?? op.value ?? \"\",\r\n            order: Number(op.order ?? idx + 1),\r\n          })),\r\n        })),\r\n      })),\r\n    }));\r\n  } catch (e) {\r\n    console.error(e);\r\n    error.value = e?.response?.data?.message || e.message || \"Ï°∞ÏÇ¨ÏßÄ Î°úÎìú Ïã§Ìå®\";\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n});\r\n\r\n/* ----------------- Ï†ÄÏû•(ÏÉà ÏÑ∏Î∂ÄÎ≤ÑÏ†Ñ) ----------------- */\r\nasync function saveEdit() {\r\n  if (saving.value) return;\r\n  if (!templateCodeForUpdate.value) {\r\n    alert(\"Î©îÏù¥Ï†Ä ÌÖúÌîåÎ¶ø ÏΩîÎìúÍ∞Ä ÏóÜÏäµÎãàÎã§. ÌôîÎ©¥ÏùÑ ÏÉàÎ°úÍ≥†Ïπ®Ìï¥ Ï£ºÏÑ∏Ïöî.\");\r\n    return;\r\n  }\r\n  saving.value = true;\r\n  try {\r\n    const payload = {\r\n      template: {\r\n        created_by: 1,\r\n        created_at: new Date().toISOString().slice(0, 10),\r\n      },\r\n      sections: sections.value.map((s, sIdx) => ({\r\n        order: sIdx + 1,\r\n        title: s.title,\r\n        desc: s.desc,\r\n        subsections: s.subsections.map((sub, subIdx) => ({\r\n          order: subIdx + 1,\r\n          title: sub.title,\r\n          desc: sub.desc,\r\n          items: sub.items.map((it, iIdx) => ({\r\n            order: iIdx + 1,\r\n            question_type: it.type,\r\n            question_text: it.text,\r\n            is_required: it.required ? \"Y\" : \"N\",\r\n            option_values: isChoiceType(it.type)\r\n              ? it.options.map((op, k) => {\r\n                  const base = op.label || \"\";\r\n                  return {\r\n                    label: base,\r\n                    value: base, // üî• valueÎäî labelÍ≥º ÎèôÏùºÌïòÍ≤å Ï†ÄÏû•\r\n                    order: k + 1,\r\n                  };\r\n                })\r\n              : null,\r\n          })),\r\n        })),\r\n      })),\r\n    };\r\n\r\n    const { data: res } = await axios.post(\r\n      `/api/survey/update/${templateCodeForUpdate.value}`,\r\n      payload\r\n    );\r\n\r\n    if (!res?.success) throw new Error(res?.message || \"Ï†ÄÏû• Ïã§Ìå®\");\r\n\r\n    alert(\"ÏÉà Î≤ÑÏ†ÑÏúºÎ°ú Ï†ÄÏû• ÏôÑÎ£å!\");\r\n    router.push({ name: \"surveyVersion\" });\r\n  } catch (e) {\r\n    console.error(\"save error:\", e);\r\n    alert(e?.response?.data?.message || e.message || \"Ï†ÄÏû• Ïã§Ìå®\");\r\n  } finally {\r\n    saving.value = false;\r\n  }\r\n}\r\n\r\nfunction goBack() {\r\n  router.push({ name: \"surveyVersion\" });\r\n}\r\n</script>\r\n\r\n<style scoped>\r\nsection {\r\n  color: #111;\r\n}\r\n\r\n/* Ìó§Îçî Ìïú Ï§Ñ Ïú†ÏßÄ */\r\n.header-row {\r\n  flex-wrap: nowrap;\r\n}\r\n\r\n/* Îπà ÏÉÅÌÉú */\r\n.empty-state {\r\n  text-align: center;\r\n  padding: 3rem 1rem;\r\n  border-radius: 0.75rem;\r\n  border: 1px dashed #d1d5db;\r\n  background: #f9fafb;\r\n  margin-bottom: 1.5rem;\r\n}\r\n\r\n/* Í≥µÌÜµ select (MaterialInputÏù¥ ÏïÑÎãå Ïï†Îì§) */\r\n.input-basic {\r\n  border-radius: 0.5rem;\r\n  border: 1px solid #e5e7eb;\r\n  padding: 0.5rem 0.75rem;\r\n  font-size: 0.875rem;\r\n  outline: none;\r\n  background-color: #ffffff;\r\n  width: 100%;\r\n}\r\n\r\n/* ÏÑπÏÖò Ïπ¥Îìú */\r\n.section-card {\r\n  border-radius: 0.9rem;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #ffffff;\r\n  padding: 1.25rem;\r\n  box-shadow: 0 10px 25px rgba(15, 23, 42, 0.05);\r\n}\r\n\r\n/* ÏÑπÏÖò Ìó§Îçî Ï§Ñ */\r\n.section-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding-bottom: 0.75rem;\r\n  margin-bottom: 1rem;\r\n  border-bottom: 1px solid #e5e7eb;\r\n}\r\n\r\n.section-title {\r\n  font-size: 0.95rem;\r\n  letter-spacing: 0.04em;\r\n  text-transform: uppercase;\r\n  color: #4b5563;\r\n}\r\n\r\n/* ÏÑ∏Î∂ÄÌï≠Î™© Ïπ¥Îìú */\r\n.subsection-card {\r\n  border-radius: 0.75rem;\r\n  border: 1px solid #e5e7eb;\r\n  background-color: #f9fafb;\r\n  padding: 0.9rem;\r\n}\r\n\r\n/* ÏÑ∏Î∂ÄÌï≠Î™© Ìó§Îçî */\r\n.sub-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  margin-bottom: 0.75rem;\r\n}\r\n\r\n/* ÏßàÎ¨∏ Ïπ¥Îìú */\r\n.question-card {\r\n  border-radius: 0.75rem;\r\n  border: 1px dashed #d1d5db;\r\n  padding: 0.9rem;\r\n  background-color: #ffffff;\r\n}\r\n\r\n.question-header {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  margin-bottom: 0.75rem;\r\n}\r\n\r\n/* ÏòµÏÖò Ìñâ: Î≤àÌò∏ + ÎùºÎ≤® + ÏÇ≠Ï†ú Î≤ÑÌäº */\r\n.option-row {\r\n  display: grid;\r\n  grid-template-columns: 40px minmax(0, 1.5fr) 80px;\r\n  gap: 0.5rem;\r\n  align-items: center;\r\n}\r\n\r\n.form-actions {\r\n  margin-top: 10px;\r\n  padding-top: 0.5rem;\r\n  border-top: 1px solid #d1d5db;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  gap: 0.5rem;\r\n}\r\n</style>\r\n","import script from \"./SurveyEdit.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./SurveyEdit.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./SurveyEdit.vue?vue&type=style&index=0&id=2a9b0cdf&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2a9b0cdf\"]])\n\nexport default __exports__"],"names":["router","useRouter","route","useRoute","templateVerCode","computed","params","id","loading","ref","saving","error","sections","templateCodeForUpdate","newId","isChoiceType","t","includes","String","toUpperCase","addSection","value","push","title","desc","subsections","removeSection","i","splice","addSubsection","sIdx","items","removeSubsection","subIdx","addItem","type","text","required","options","removeItem","iIdx","onChangeType","item","Array","isArray","length","label","addOption","removeOption","oIdx","toggleRequired","event","checked","target","async","saveEdit","payload","template","created_by","created_at","Date","toISOString","slice","map","s","order","sub","it","question_type","question_text","is_required","option_values","op","k","base","data","res","axios","post","success","Error","message","alert","name","e","console","response","goBack","onMounted","url","get","result","template_code","srcSections","section_title","section_desc","subsection_title","subsection_desc","idx","Number","__exports__"],"sourceRoot":""}